<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="機械設計工程系二甲" />
  <meta name="date" content="2014-04-23" />
  <title>2014 協同產品設計實習報告</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
</head>
<body>
<div id="header">
<h1 class="title">2014 協同產品設計實習報告</h1>
<h2 class="author">機械設計工程系二甲</h2>
<h3 class="date">April 23, 2014</h3>
</div>
<h1 id="前言">前言</h1>
<p>協同產品設計實習課程目標<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a></p>
<p>Here is an inline note.<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a></p>
<p>學習協同產品設計流程與環境的基本原理與架構.</p>
<p>學習如何在網際專案管理系統的協助下, 進行協同產品設計.</p>
<p>學習如何在協同設計流程中, 進行有效率的工程設計表達與產品資料管理.</p>
<p>延續程式語言與電腦輔助設計實習課程, 學習如何建構協同產品設計環境所需的工具.</p>
<h1 id="pandoc-手冊">Pandoc 手冊</h1>
<p>http://johnmacfarlane.net/pandoc/README.html</p>
<p>footnotes</p>
<p>tables</p>
<p>flexible ordered lists</p>
<p>definition lists</p>
<p>fenced code blocks</p>
<p>superscript</p>
<p>subscript</p>
<p>strikeout</p>
<p>title blocks</p>
<p>automatic tables of contents</p>
<p>embedded LaTeX math</p>
<p>citations</p>
<p>markdown inside HTML block elements</p>
<h1 id="協同產品設計實習專案2ag1">協同產品設計實習專案(2ag1)</h1>
<h2 id="組員">組員：</h2>
<p>40123101</p>
<p>40123102</p>
<p>40123132</p>
<p>OpenShift 網站: http://2014cdag1-cadp13ag6.rhcloud.com/</p>
<h2 id="w8考試">w8考試</h2>
<ol style="list-style-type: decimal">
<li>請寫一個執行時可以列出 9×9 乘法表的網際 Python 程式, 然後 Push 到個人 bitbucket 空間, 而且同步指到 OpenShift 個人帳號上執行.</li>
</ol>
<ul>
<li><p>程式碼:</p>
<pre class="sourceCode python"><code class="sourceCode python">    <span class="kw">for</span> x in <span class="dt">range</span>(<span class="dv">0</span>,<span class="dv">10</span>):
        <span class="kw">for</span> y in <span class="dt">range</span>(<span class="dv">0</span>,<span class="dv">10</span>):
            <span class="dt">print</span>(x,<span class="st">&#39;*&#39;</span>,y,<span class="st">&#39;=&#39;</span>,x*y)</code></pre></li>
<li><p>解題過程:</p>
<p>打完程式後，之後我把它上傳到bitbucket，git add .→ git commit -m &quot;99&quot;→ git push，之後為了要把99乘法表顯示在openshift CMSimply上，進去openshift CMSimply的資料夾→ wsgi資料夾→ application檔案，在裡面新增一個class 的格式，之後連線FileZilla , 把application檔案覆蓋到app-root/runtime/repo/wsgi的application檔案下，之後進去openshift CMSimply的網站，就顯示99乘法表了。</p></li>
<li><p>解題心得:</p>
<p>雖然要打一個99乘法表的程式很快，但要如何顯示在遠端的網頁上，思考了很久，在課堂後請教了TA，最後應用cherrypy的方式，在application檔案，新增一個class 的格式，就完成了。</p></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>請將上述執行過程錄為 flv 後, 上傳到個人的 Vemeo 空間中, 並將網址回報到各組網站 (dokuwiki 與 CMSimply)與報告中, 並且將相關心得與報告連結登錄到 wiki.mde.tw 第八週的分組頁面中.</li>
</ol>
<ul>
<li><p>Bitbucket 連結: https://bitbucket.org/40123102/40123102cmsimply/src</p></li>
<li><p>Vemeo 空間: https://vimeo.com/user26935042/videos</p></li>
<li>copy 空間: https://copy.com/XohJLdUBRJdk</li>
<li><p>dokuwiki網站: https://40123102cdg1dokuwiki-cadp13ag6.rhcloud.com/doku.php?id=start</p></li>
<li><p>CMSimply網址: http://40123102cdg1-cadp13ag6.rhcloud.com/w8test/</p></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>請在各組的雲端 dowiki 中,根據下列 40 個帳號與密碼, 新增對應的使用者帳號與密碼後, 將雲端網址登錄在 wiki.mde.tw 各組第八週頁面中, 並說明操作過程與心得後, 將心得整理成 pdf 後繳交到 course@mde.tw.</li>
</ol>
<ul>
<li><p>解題過程:</p>
<p>程式做不出來，只好一個一個建立。</p></li>
<li><p>解題心得:</p>
<p>想很久，還是無法想出程式，只好用最勤勞的方法，一個一個建立，唉!!!</p></li>
</ul>
<h2 id="w9考試">w9考試</h2>
<ol style="list-style-type: decimal">
<li>請寫一個執行時可以列出以十為底對數表的網際 Python 程式, 然後 Push 到個人 bitbucket 空間, 而且同步指到 OpenShift 個人帳號上執行.</li>
</ol>
<ul>
<li><p>程式碼:</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="ch">import</span> math
count = <span class="dv">0</span>
text=<span class="st">&#39;</span><span class="ot">%04d</span><span class="st">&#39;</span>
<span class="kw">for</span> i in <span class="dt">range</span>(<span class="dv">100</span>,<span class="dv">200+10</span>):
    <span class="dt">print</span>(text%<span class="dt">round</span>(math.log(i/<span class="dv">100</span>,<span class="dv">10</span>)*<span class="dv">10000</span>,<span class="dv">0</span>),end=<span class="st">&#39;-&#39;</span>)
    count += <span class="dv">1</span>
    <span class="kw">if</span>(count == <span class="dv">10</span>):
        <span class="dt">print</span>()
        count = <span class="dv">0</span></code></pre></li>
<li><p>解題過程:</p>
<p>打完程式後，有顯示出來，但無法顯示表單在CMSimply網址上，只能一個一個慢慢打。</p></li>
<li><p>解題心得:</p>
<p>想了很久，還是無法，只會打程式，只好把顯示出來的數字一個一個加上，慢慢打。</p></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>請在個人的 OpenShift 平台上建立一個能夠列印出與九九乘法表結果完全相同的網際程式, 接著在乘法表上端加上兩個輸入表單, 讓使用者輸入兩個整數, 按下送出鍵後, 程式會列出以此兩個整數為基底的乘法表, 例如: 若兩個欄位都輸入: 9, 則列出九九乘法表, 若輸入 9, 20, 則列出 9×20 的乘法表.</li>
</ol>
<ul>
<li><p>解題過程:</p>
<p>打完程式後，之後我把它上傳到bitbucket，git add .→ git commit -m &quot;w9_2&quot;→ git push，之後為了要把99乘法表顯示在openshift CMSimply上，進去openshift CMSimply的資料夾→ wsgi資料夾→ application檔案，在裡面新增一個class 的格式，之後連線FileZilla , 把application檔案覆蓋到app-root/runtime/repo/wsgi的application檔案下，之後進去openshift CMSimply的網站，輸入 9, 20, 則顯示 9×20 的乘法表.</p></li>
<li><p>解題心得:</p>
<p>這題跟上週小考差不多，只是還要再新增兩個輸入表單，所以還要在回想一下，但大致上ok，所以完成了。</p></li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>請在各組的雲端 dokuwiki 中, 新增帳號與密碼都是由 abc001 ~ abc399 字串所組成的 399 名用戶登入對應資料, 並將製作過程與驗證流程拍成 flv 後上傳到個人的 Vimeo 資料區, 並將連結放在個人第九週頁面.</li>
</ol>
<ul>
<li><p>程式碼:</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="ch">import</span> hashlib
<span class="co"># convert user_password into sha1 encoded string</span>
<span class="kw">def</span> gen_password(user_password):
    <span class="kw">return</span> hashlib.sha1(user_password.encode(<span class="st">&quot;utf-8&quot;</span>)).hexdigest()
text=<span class="st">&#39;abc</span><span class="ot">%03d</span><span class="st">&#39;</span>
<span class="kw">for</span> i in <span class="dt">range</span>(<span class="dv">1</span>,<span class="dv">399+1</span>):
    <span class="dt">print</span>(text%(i)+<span class="st">&#39;:&#39;</span>+gen_password(text%(i))+<span class="st">&#39;:&#39;</span>+text%(i)+<span class="st">&#39;@gmail.com:&#39;</span>+text%(i)+<span class="st">&#39;@gmail.com:&#39;</span>+<span class="st">&#39;user&#39;</span>)</code></pre></li>
<li><p>操作過程:</p>
<p>先寫一個程式使他能產生帳號與密碼都是由 abc001 ~ abc399 字串所組成的 399 名用戶登入對應資料，之後連線到openshift dokuwiki的FileZilla，把產生出來的程式碼貼到app-root/data/conf/users.auth.php下，之後開啟dokuwiki網站即可。</p></li>
<li><p>心得:</p>
<p>一開始這個程式需要思考一下，如何使帳號與密碼都是由 abc001 ~ abc399 字串所組成的 399 名用戶，打出來後還要去讓所產生的程式碼符合一開始的格式，如同users.auth.php，思考很久最後終於成功了。</p></li>
</ul>
<h2 id="w12">w12</h2>
<ul>
<li>第十二週任務:</li>
</ul>
<ol style="list-style-type: decimal">
<li>請各組將第八週與第九週考試的摘要報告放入 Github 協同專案中的分組報告區, 並將內容放入各組控管的同步 OpenShift 網站中. (佔期末成績 5分)</li>
<li>請各組設法利用 CherryPy 與 Pro/Web.Link 技術, 在 Github 協同專案中建立一個能夠透過連結或表單控制 Cube 零件, a, b, 或 c 零件尺寸的網際協同程式, 讓使用者可以藉以利用近端的 Creo 嵌入式瀏覽器控制 Cube 的尺寸後列出該零件的體積大小. (佔期末成績 5分)</li>
</ol>
<ul>
<li>心得:</li>
</ul>
<ol style="list-style-type: decimal">
<li>在URL直接更改參數:在對應的程式內，把迴圈改成可在URL後面輸入變數，EX:http://127.0.0.1:8080/cdag1/cube1?w=20&amp;h=20&amp;l=20</li>
<li>在更改FOR迴圈時切記{}! 在此DEF最下面還有一個括弧要刪除，否則會跑出CATCH</li>
</ol>
<ul>
<li><p>組員自評:</p>
<p>40123101：85分</p>
<p>40123102：95分</p>
<p>40123132：95分</p></li>
</ul>
<h1 id="網際鼓式煞車設計2ag2">網際鼓式煞車設計(2ag2)</h1>
<p>有關鼓式煞車</p>
<h1 id="程式設計架構">程式設計架構</h1>
<p>鼓式煞車</p>
<h1 id="結果與討論">結果與討論</h1>
<p>這裡是結果與討論</p>
<h1 id="w12任務2ag3">W12任務(2ag3)</h1>
<p>請各組將第九週考試的摘要報告放入 Github 協同專案中的分組報告區</p>
<h1 id="摘要報告">摘要報告</h1>
<pre><code>第一題：</code></pre>
<p>請寫一個執行時可以列出以十為底對數表的網際 Python 程式，然後 Push 到個人 bitbucket 空間，而且同步指到 OpenShift 個人帳號上執行。</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="ch">import</span> math
count = <span class="dv">0</span>
text=<span class="st">&#39;</span><span class="ot">%04d</span><span class="st">&#39;</span>
<span class="kw">for</span> i in <span class="dt">range</span>(<span class="dv">100</span>,<span class="dv">200+10</span>):
    <span class="dt">print</span>(text%<span class="dt">round</span>(math.log(i/<span class="dv">100</span>,<span class="dv">10</span>)*<span class="dv">10000</span>,<span class="dv">0</span>),end=<span class="st">&#39;-&#39;</span>)
    count += <span class="dv">1</span>
    <span class="kw">if</span>(count == <span class="dv">10</span>):
        <span class="dt">print</span>()
        count = <span class="dv">0</span></code></pre>
<pre><code>解題心得：</code></pre>
<p>可利用程式算出對數的值，就不需要一個一個按計算機。</p>
<pre><code>第二題：</code></pre>
<p>請在個人的 OpenShift 平台上建立一個能夠列印出與九九乘法表結果完全相同的網際程式，接著在乘法表上端加上兩個輸入表單，讓使用者輸入兩個整數，按下送出鍵後，程式會列出以此兩個整數為基底的乘法表，例如：若兩個欄位都輸入: 9，則列出九九乘法表，若輸入 9，20，則列出 9×20 的乘法表。</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="kw">class</span> Example(<span class="dt">object</span>):
_cp_config = {
<span class="co"># if there is no utf-8 encoding, no Chinese input available</span>
<span class="st">&#39;tools.encode.encoding&#39;</span>: <span class="st">&#39;utf-8&#39;</span>,
<span class="co">&#39;tools.sessions.on&#39;</span> : <span class="ot">True</span>,
<span class="co">&#39;tools.sessions.st\orage_type&#39;</span> : <span class="st">&#39;file&#39;</span>,
<span class="co">&#39;tools.sessions.locking&#39;</span> : <span class="st">&#39;explicit&#39;</span>,
<span class="co">&#39;tools.sessions.storage_path&#39;</span> : data_dir+<span class="st">&#39;/tmp&#39;</span>,
<span class="co"># session timeout is 60 minutes</span>
<span class="co">&#39;tools.sessions.timeout&#39;</span> : <span class="dv">60</span>
}

<span class="ot">@cherrypy.expose</span>
<span class="kw">def</span> index(<span class="ot">self</span>):
    output = <span class="st">&#39;&#39;</span>

    form = <span class="st">&#39;&#39;&#39;</span>
<span class="st">    &lt;form action=&#39;action&#39;&gt;</span>
<span class="st">    num1:&lt;INPUT type=&#39;text&#39; name=&#39;num1&#39;&gt;</span>
<span class="st">    num2:&lt;INPUT type=&#39;text&#39;  name=&#39;num2&#39;&gt;</span>
<span class="st">    &lt;input type=submit&gt;</span>
<span class="st">    &lt;input type=reset&gt;</span>
<span class="st">    &lt;/form&gt;</span>
<span class="st">    &#39;&#39;&#39;</span>
    output += form
    <span class="kw">return</span> output
<span class="ot">@cherrypy.expose</span>
<span class="kw">def</span> action(<span class="ot">self</span>, num1=<span class="dv">9</span>, num2=<span class="dv">9</span>):
    num1 = <span class="dt">int</span>(num1)
    num2 = <span class="dt">int</span>(num2)
    output = <span class="st">&#39;&#39;</span>
    <span class="kw">for</span> i in <span class="dt">range</span>(num1):
        <span class="kw">for</span> j in <span class="dt">range</span>(num2):
            output += <span class="dt">str</span>(i) + <span class="st">&#39;*&#39;</span> + <span class="dt">str</span>(j) + <span class="st">&#39;=&#39;</span> + <span class="dt">str</span>(i*j) + <span class="st">&#39;&lt;br /&gt;&#39;</span>
    <span class="kw">return</span> output</code></pre>
<p>解題心得：</p>
<p>利用網站輸入值並算出，並需要有兩個輸入表單。</p>
<pre><code>第三題：</code></pre>
<p>請在各組的雲端 dokuwiki 中，新增帳號與密碼都是由 abc001 ~ abc399 字串所組成的 399 名用戶登入對應資料，並將製作過程與驗證流程拍成 flv 後上傳到個人的 Vimeo 資料區，並將連結放在個人第九週頁面。</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="ch">import</span> hashlib
<span class="co">#convert user_password into sha1 encoded string</span>
<span class="kw">def</span> gen_password(user_password):
    <span class="kw">return</span> hashlib.sha1(user_password.encode(<span class="st">&quot;utf-8&quot;</span>)).hexdigest()
text=<span class="st">&#39;abc</span><span class="ot">%03d</span><span class="st">&#39;</span>
<span class="kw">for</span> i in <span class="dt">range</span>(<span class="dv">1</span>,<span class="dv">399+1</span>):
    <span class="dt">print</span>(text%(i)+<span class="st">&#39;:&#39;</span>+gen_password(text%(i))+<span class="st">&#39;:&#39;</span>+text%(i)+<span class="st">&#39;@gmail.com:&#39;</span>+text%(i)+<span class="st">&#39;@gmail.com:&#39;</span>+<span class="st">&#39;user&#39;</span>)</code></pre>
<p>解題心得：</p>
<p>可以利用程式創造多人帳密，一起管理網站，減少一個一個創建帳密，又會有被盜用的風險。</p>
<p>import math count = 0 text='%04d' for i in range(100,200+10): print(text%round(math.log(i/100,10)*10000,0),end='-') count += 1 if(count == 10): print() count = 0</p>
<p>class Example(object): <em>cp</em>config = { # if there is no utf-8 encoding, no Chinese input available 'tools.encode.encoding': 'utf-8', 'tools.sessions.on' : True, 'tools.sessions.storage_type' : 'file', 'tools.sessions.locking' : 'explicit', 'tools.sessions.storage_path' : data_dir+'/tmp', # session timeout is 60 minutes 'tools.sessions.timeout' : 60 }</p>
<p><span class="citation">@cherrypy.expose</span> def index(self): output = ''</p>
<pre><code>form = &#39;&#39;&#39;
&lt;form action=&#39;action&#39;&gt;
num1:&lt;INPUT type=&#39;text&#39; name=&#39;num1&#39;&gt;
num2:&lt;INPUT type=&#39;text&#39;  name=&#39;num2&#39;&gt;
&lt;input type=submit&gt;
&lt;input type=reset&gt;
&lt;/form&gt;
&#39;&#39;&#39;
output += form
return output</code></pre>
<p><span class="citation">@cherrypy.expose</span> def action(self, num1=9, num2=9): num1 = int(num1) num2 = int(num2) output = '' for i in range(num1): for j in range(num2): output += str(i) + '<em>' + str(j) + '=' + str(i</em>j) + '<br />' return output</p>
<p>import hashlib #convert user_password into sha1 encoded string def gen_password(user_password): return hashlib.sha1(user_password.encode(&quot;utf-8&quot;)).hexdigest() text='abc%03d' for i in range(1,399+1): print(text%(i)+':'+gen_password(text%(i))+':'+text%(i)+'<span class="citation">@gmail.com</span>:'+text%(i)+'<span class="citation">@gmail.com</span>:'+'user')</p>
<h1 id="網際鼓式煞車設計2ag4">網際鼓式煞車設計(2ag4)</h1>
<p>github連結 40123107: https://github.com/40123107 40123120: https://github.com/40123120 cdag4: https://github.com/2014cdag4/2014cdag4</p>
<p>cmsimply連結 40123107: https://github.com/40123107 40123120: https://github.com/40123120 40123150: http://cdg4-40123150.rhcloud.com/ ===</p>
<p>第九週 1.(第一題 30%) 請寫一個執行時可以列出以十為底對數表的網際 Python 程式, 然後 Push 到個人 bitbucket 空間, 而且同步指到 OpenShift 個人帳號上執行. http://cdg4-40123150.rhcloud.com/get_page?heading=%E7%AC%AC%E4%B8%80%E9%A1%8C 2.(第二題 40%) 請在個人的 OpenShift 平台上建立一個能夠列印出與九九乘法表結果完全相同的網際程式, 接著在乘法表上端加上兩個輸入表單, 讓使用者輸入兩個整數, 按下送出鍵後, 程式會列出以此兩個整數為基底的乘法表, 例如: 若兩個欄位都輸入: 9, 則列出九九乘法表, 若輸入 9, 20, 則列出 9×20 的乘法表. http://cdg4-40123150.rhcloud.com/example/ http://vimeo.com/92577008 3.(第三題 30%) 請在各組的雲端 dokuwiki 中, 新增帳號與密碼都是由 abc001 ~ abc399 字串所組成的 399 名用戶登入對應資料, 並將製作過程與驗證流程拍成 flv 後上傳到個人的 Vimeo 資料區, 並將連結放在個人第九週頁面. https://php-40123150.rhcloud.com/doku.php?id=start http://vimeo.com/92577072 === w12 請連結 https://github.com/2014cdag4/2014cdag4 ===</p>
<p>這裡是結果與討論</p>
<h1 id="網際四連桿機構設計2ag5">網際四連桿機構設計(2ag5)</h1>
<p>有關連桿設計</p>
<h1 id="程式設計架構-1">程式設計架構</h1>
<p>連桿計算</p>
<h1 id="結果與討論-1">結果與討論</h1>
<p>這裡是結果與討論</p>
<p>by 2014cdag5</p>
<h1 id="網際鼓式煞車設計2ag6">網際鼓式煞車設計(2ag6)</h1>
<p>有關鼓式煞車</p>
<h1 id="程式設計架構-2">程式設計架構</h1>
<p>鼓式煞車</p>
<h1 id="結果與討論-2">結果與討論</h1>
<p>這裡是結果與討論</p>
<h1 id="網際鼓式煞車設計2ag7">網際鼓式煞車設計(2ag7)</h1>
<p>有關鼓式煞車</p>
<h1 id="程式設計架構-3">程式設計架構</h1>
<p>鼓式煞車</p>
<h1 id="結果與討論-3">結果與討論</h1>
<p>這裡是結果與討論</p>
<h1 id="網際四連桿機構設計2ag8">網際四連桿機構設計(2ag8)</h1>
<p>有關連桿設計</p>
<h1 id="程式設計架構-4">程式設計架構</h1>
<p>連桿計算</p>
<h1 id="結果與討論-4">結果與討論</h1>
<p>這裡是結果與討論</p>
<p>by 2014cdag5</p>
<h1 id="網際鼓式煞車設計2ag9">網際鼓式煞車設計(2ag9)</h1>
<p>有關鼓式煞車</p>
<h1 id="程式設計架構-5">程式設計架構</h1>
<p>鼓式煞車</p>
<h1 id="結果與討論-5">結果與討論</h1>
<p>這裡是結果與討論</p>
<p>這是第九組</p>
<h1 id="分組工作日誌">分組工作日誌</h1>
<h1 id="分組評分">分組評分</h1>
<pre class="sourceCode python"><code class="sourceCode python"><span class="co">#coding: utf-8</span>
<span class="co">&#39;&#39;&#39;</span>
<span class="co">http://www.beyondmech.com/pro-e/cad-topic-27.html</span>
<span class="co">&quot;本程式的目的在輔助設計者選擇齒輪的尺寸大小，&quot;;</span>
<span class="co">&quot;由於相囓合的兩齒輪其徑節 (Diametral Pitch) 相同&quot;;</span>
<span class="co">&quot;，齒的大小也相同。因徑節為每單位直徑的齒數，因此徑節愈大，則其齒的尺寸愈小&quot;;</span>
<span class="co">&quot;；反之，徑節愈小，則齒的尺寸則愈大。&quot;;</span>
<span class="co">&quot;一般在設計齒輪對時，為避免使用過大的齒及過寬的齒面厚度，因此必須要就齒輪大小與強度與負載加以設計。&quot;;</span>
<span class="co">&quot;一般而言是希望齒輪面的寬度 (Face Width) 能大於3倍周節 (Circular Pitch)，以避免選用太大的齒尺寸。&quot;;</span>
<span class="co">&quot;並且希望齒輪面的寬度 (Face Width) 能小於5倍周節，以便齒面傳遞負載時能有較為均勻的分佈，因此&quot;;</span>
<span class="co">&quot;設 d 為齒輪的節圓直徑(Pitch Diameter)，單位為英吋&quot;;</span>
<span class="co">&quot;N 為齒數&quot;;</span>
<span class="co">&quot;P 為徑節， 即單位英吋的齒數&quot;;</span>
<span class="co">&quot;因此 d=N/P&quot;;</span>
<span class="co">&quot;設 V 為節線速度(Pitch Line Velocity)，單位為英呎/分鐘&quot;;</span>
<span class="co">&quot;因此 V=(PI) * d * n/12&quot;;</span>
<span class="co">&quot;其中 n 為齒輪轉速，單位為 rpm&quot;;</span>
<span class="co">&quot;設傳輸負載大小為 W，單位為 pounds&quot;;</span>
<span class="co">&quot;因此 W=33000H/V&quot;;</span>
<span class="co">&quot;其中 H 為傳輸功率，單位為 hourse power&quot;;</span>
<span class="co">&quot;若設 K 為速度因子(Velocity Factor)&quot;;</span>
<span class="co">&quot;因此 K=1200/(1200+V)&quot;;</span>
<span class="co">&quot;最後可求出齒輪的齒面寬度(Face Width) F ，單位為英吋&quot;;</span>
<span class="co">&quot;即 F=WP/KYS&quot;;</span>
<span class="co">&quot;其中 S 為齒面的材料彎曲應力強度&quot;;</span>
<span class="co">&quot;設計要求:控制所選齒的尺寸大小，在滿足強度與傳輸負載的要求下，讓齒面厚度介於3倍周節與5倍周節之間。&quot;;</span>
<span class="co">&quot;設計者可以選擇的參數:&quot;;</span>
<span class="co">&quot;安全係數(建議值為3以上)&quot;;</span>
<span class="co">&quot;齒輪減速比&quot;;</span>
<span class="co">&quot;馬達傳輸功率，單位為 horse power&quot;;</span>
<span class="co">&quot;馬達轉速，單位為 rpm&quot;;</span>
<span class="co">&quot;齒制(Gear System)&quot;;</span>
<span class="co">&quot;齒輪材料與強度&quot;;</span>
<span class="co">&#39;&#39;&#39;</span>
<span class="co"># 這個程式要計算正齒輪的齒面寬, 資料庫連結希望使用 pybean 與 SQLite</span>
<span class="co"># 導入 pybean 模組與所要使用的 Store 及 SQLiteWriter 方法</span>
<span class="ch">from</span> pybean <span class="ch">import</span> Store, SQLiteWriter
<span class="ch">import</span> math

<span class="kw">def</span> interpolation(小齒輪齒數, 齒形):
    <span class="kw">global</span> SQLite連結
    <span class="co"># 使用內插法求值</span>
    <span class="co"># 找出比目標齒數大的其中的最小的,就是最鄰近的大值</span>
    lewis_factor = SQLite連結.find_one(<span class="st">&quot;lewis&quot;</span>,<span class="st">&quot;gearno &gt; ?&quot;</span>,[小齒輪齒數])
    <span class="kw">if</span>(齒形 == <span class="dv">1</span>):
        larger_formfactor = lewis_factor.type1
    <span class="kw">elif</span>(齒形 == <span class="dv">2</span>):
        larger_formfactor = lewis_factor.type2
    <span class="kw">elif</span>(齒形 == <span class="dv">3</span>):
        larger_formfactor = lewis_factor.type3
    <span class="kw">else</span>:
        larger_formfactor = lewis_factor.type4
    larger_toothnumber = lewis_factor.gearno

    <span class="co"># 找出比目標齒數小的其中的最大的,就是最鄰近的小值</span>
    lewis_factor = SQLite連結.find_one(<span class="st">&quot;lewis&quot;</span>,<span class="st">&quot;gearno &lt; ? order by gearno DESC&quot;</span>,[小齒輪齒數])
    <span class="kw">if</span>(齒形 == <span class="dv">1</span>):
        smaller_formfactor = lewis_factor.type1
    <span class="kw">elif</span>(齒形 == <span class="dv">2</span>):
        smaller_formfactor = lewis_factor.type2
    <span class="kw">elif</span>(齒形 == <span class="dv">3</span>):
        smaller_formfactor = lewis_factor.type3
    <span class="kw">else</span>:
        smaller_formfactor = lewis_factor.type4
    smaller_toothnumber = lewis_factor.gearno
    calculated_factor = larger_formfactor + (小齒輪齒數 - larger_toothnumber) * (larger_formfactor - smaller_formfactor) / (larger_toothnumber - smaller_toothnumber)
    <span class="co"># 只傳回小數點後五位數</span>
    <span class="kw">return</span> <span class="dt">round</span>(calculated_factor, <span class="dv">5</span>)

<span class="co"># 取得設計參數</span>
馬力 = <span class="dv">100</span>
轉速 = <span class="dv">1120</span>
減速比 = <span class="dv">4</span>
齒形 = <span class="dv">4</span>
安全係數 = <span class="dv">3</span>
<span class="co">#unsno_treatment</span>
材料 = <span class="st">&quot;G10350_CD&quot;</span>
小齒輪齒數 = <span class="dv">18</span>

<span class="co"># 改寫為齒面寬的設計函式</span>
<span class="kw">def</span> gear_width(馬力, 轉速, 減速比, 齒形, 安全係數, 材料, 小齒輪齒數):
    <span class="co"># 根據所選用的齒形決定壓力角</span>
    <span class="kw">if</span>(齒形 == <span class="dv">1</span> or 齒形 == <span class="dv">2</span>):
        壓力角 = <span class="dv">20</span>
    <span class="kw">else</span>:
        壓力角 = <span class="dv">25</span>

    <span class="co"># 根據壓力角決定最小齒數</span>
    <span class="kw">if</span>(壓力角== <span class="dv">20</span>):
        最小齒數 = <span class="dv">18</span>
    <span class="kw">else</span>:
        最小齒數 = <span class="dv">12</span>

    <span class="co"># 直接設最小齒數</span>
    <span class="kw">if</span> 小齒輪齒數 &lt;= 最小齒數:
        小齒輪齒數 = 最小齒數
    <span class="co"># 大於400的齒數則視為齒條(Rack)</span>
    <span class="kw">if</span> 小齒輪齒數 &gt;= <span class="dv">400</span>:
        小齒輪齒數 = <span class="dv">400</span>

    <span class="co"># 根據所選用的材料查詢強度值</span>
    <span class="co"># 由 material之序號查 steel 表以得材料之降伏強度S單位為 kpsi 因此查得的值要成乘上1000</span>
    <span class="co"># 利用 Store  建立資料庫檔案對應物件, 並且設定 frozen=True 表示不要開放動態資料表的建立</span>
    SQLite連結 = Store(SQLiteWriter(<span class="st">&quot;lewis.db&quot;</span>, frozen=<span class="ot">True</span>))
    <span class="co"># 指定 steel 資料表</span>
    steel = SQLite連結.new(<span class="st">&quot;steel&quot;</span>)
    <span class="co"># 資料查詢</span>
    <span class="co"># 將 unsno 與 treatment 從材料字串中隔開</span>
    unsno, treatment = 材料.split(<span class="st">&quot;_&quot;</span>)
    <span class="co">#print(unsno, treatment)</span>

    material = SQLite連結.find_one(<span class="st">&quot;steel&quot;</span>,<span class="st">&quot;unsno=? and treatment=?&quot;</span>,[unsno, treatment])
    <span class="co"># 列出 steel 資料表中的資料筆數</span>
    <span class="co">#print(SQLite連結.count(&quot;steel&quot;))</span>
    <span class="dt">print</span> (material.yield_str)
    strengthstress = material.yield_str*<span class="dv">1000</span>
    <span class="co"># 由小齒輪的齒數與齒形類別,查詢lewis form factor</span>
    <span class="co"># 先查驗是否有直接對應值</span>
    on_table = SQLite連結.count(<span class="st">&quot;lewis&quot;</span>,<span class="st">&quot;gearno=?&quot;</span>,[小齒輪齒數])
    <span class="kw">if</span> on_table == <span class="dv">1</span>:
        <span class="co"># 直接進入設計運算</span>
        <span class="dt">print</span>(<span class="st">&quot;直接運算&quot;</span>)
        <span class="dt">print</span>(on_table)
        lewis_factor = SQLite連結.find_one(<span class="st">&quot;lewis&quot;</span>,<span class="st">&quot;gearno=?&quot;</span>,[小齒輪齒數])
        <span class="co">#print(lewis_factor.type1)</span>
        <span class="co"># 根據齒形查出 formfactor 值</span>
        <span class="kw">if</span>(齒形 == <span class="dv">1</span>):
            formfactor = lewis_factor.type1
        <span class="kw">elif</span>(齒形 == <span class="dv">2</span>):
            formfactor = lewis_factor.type2
        <span class="kw">elif</span>(齒形 == <span class="dv">3</span>):
            formfactor = lewis_factor.type3
        <span class="kw">else</span>:
            formfactor = lewis_factor.type4
    <span class="kw">else</span>:
        <span class="co"># 沒有直接對應值, 必須進行查表內插運算後, 再執行設計運算</span>
        <span class="dt">print</span>(<span class="st">&quot;必須內插&quot;</span>)
        <span class="co">#print(interpolation(小齒輪齒數, 齒形))</span>
        formfactor = interpolation(小齒輪齒數, 齒形)

    <span class="co"># 開始進行設計運算</span>

    ngear = 小齒輪齒數 * 減速比

    <span class="co"># 重要的最佳化設計---儘量用整數的diametralpitch</span>
    <span class="co"># 先嘗試用整數算若 diametralpitch 找到100 仍無所獲則改用 0.25 作為增量再不行則宣告 fail</span>
    counter = <span class="dv">0</span>
    i = <span class="fl">0.1</span>
    facewidth = <span class="dv">0</span>
    circularpitch = <span class="dv">0</span>
    <span class="kw">while</span> (facewidth &lt;= <span class="dv">3</span> * circularpitch or facewidth &gt;= <span class="dv">5</span> * circularpitch):
        diametralpitch = i
        <span class="co">#circularpitch = 3.14159/diametralpitch</span>
        circularpitch = math.pi/diametralpitch
        pitchdiameter = 小齒輪齒數/diametralpitch
        <span class="co">#pitchlinevelocity = 3.14159*pitchdiameter*轉速/12</span>
        pitchlinevelocity = math.pi * pitchdiameter * 轉速/<span class="dv">12</span>
        transmittedload = <span class="dv">33000</span> * 馬力/pitchlinevelocity
        velocityfactor = <span class="dv">1200</span>/(<span class="dv">1200</span> + pitchlinevelocity)
        <span class="co"># formfactor is Lewis form factor</span>
        <span class="co"># formfactor need to get from table 13-3 and determined ty teeth number and type of tooth</span>
        <span class="co"># formfactor = 0.293</span>
        <span class="co"># 90 is the value get from table corresponding to material type</span>
        facewidth = transmittedload * diametralpitch * 安全係數/velocityfactor/formfactor/strengthstress
        <span class="kw">if</span>(counter&gt;<span class="dv">5000</span>):
            <span class="dt">print</span>(<span class="st">&quot;超過5000次的設計運算,仍無法找到答案!&quot;</span>)
            <span class="dt">print</span>(<span class="st">&quot;可能所選用的傳遞功率過大,或無足夠強度的材料可以使用!&quot;</span>)
            <span class="co"># 離開while迴圈</span>
            <span class="kw">break</span>
        i += <span class="fl">0.1</span>
        counter += <span class="dv">1</span>
    facewidth = <span class="dt">round</span>(facewidth, <span class="dv">4</span>)
    <span class="kw">if</span>(counter&lt;<span class="dv">5000</span>):
        <span class="dt">print</span>(<span class="st">&quot;進行&quot;</span>+<span class="dt">str</span>(counter)+<span class="st">&quot;次重複運算後,得到合用的facewidth值為:&quot;</span>+<span class="dt">str</span>(facewidth))

gear_width(馬力, 轉速, 減速比, 齒形, 安全係數, 材料, 小齒輪齒數)</code></pre>
<pre class="sourceCode python"><code class="sourceCode python"><span class="co">#coding: utf-8</span>
<span class="co">&#39;&#39;&#39;</span>
<span class="co">&quot;本程式的目的在輔助設計者選擇齒輪的尺寸大小，&quot;;</span>
<span class="co">&quot;由於相囓合的兩齒輪其徑節 (Diametral Pitch) 相同&quot;;</span>
<span class="co">&quot;，齒的大小也相同。因徑節為每單位直徑的齒數，因此徑節愈大，則其齒的尺寸愈小&quot;;</span>
<span class="co">&quot;；反之，徑節愈小，則齒的尺寸則愈大。&quot;;</span>
<span class="co">&quot;一般在設計齒輪對時，為避免使用過大的齒及過寬的齒面厚度，因此必須要就齒輪大小與強度與負載加以設計。&quot;;</span>
<span class="co">&quot;一般而言是希望齒輪面的寬度 (Face Width) 能大於3倍周節 (Circular Pitch)，以避免選用太大的齒尺寸。&quot;;</span>
<span class="co">&quot;並且希望齒輪面的寬度 (Face Width) 能小於5倍周節，以便齒面傳遞負載時能有較為均勻的分佈，因此&quot;;</span>
<span class="co">&quot;設 d 為齒輪的節圓直徑(Pitch Diameter)，單位為英吋&quot;;</span>
<span class="co">&quot;N 為齒數&quot;;</span>
<span class="co">&quot;P 為徑節， 即單位英吋的齒數&quot;;</span>
<span class="co">&quot;因此 d=N/P&quot;;</span>
<span class="co">&quot;設 V 為節線速度(Pitch Line Velocity)，單位為英呎/分鐘&quot;;</span>
<span class="co">&quot;因此 V=(PI) * d * n/12&quot;;</span>
<span class="co">&quot;其中 n 為齒輪轉速，單位為 rpm&quot;;</span>
<span class="co">&quot;設傳輸負載大小為 W，單位為 pounds&quot;;</span>
<span class="co">&quot;因此 W=33000H/V&quot;;</span>
<span class="co">&quot;其中 H 為傳輸功率，單位為 hourse power&quot;;</span>
<span class="co">&quot;若設 K 為速度因子(Velocity Factor)&quot;;</span>
<span class="co">&quot;因此 K=1200/(1200+V)&quot;;</span>
<span class="co">&quot;最後可求出齒輪的齒面寬度(Face Width) F ，單位為英吋&quot;;</span>
<span class="co">&quot;即 F=WP/KYS&quot;;</span>
<span class="co">&quot;其中 S 為齒面的材料彎曲應力強度&quot;;</span>
<span class="co">&quot;設計要求:控制所選齒的尺寸大小，在滿足強度與傳輸負載的要求下，讓齒面厚度介於3倍周節與5倍周節之間。&quot;;</span>
<span class="co">&quot;設計者可以選擇的參數:&quot;;</span>
<span class="co">&quot;安全係數(建議值為3以上)&quot;;</span>
<span class="co">&quot;齒輪減速比&quot;;</span>
<span class="co">&quot;馬達傳輸功率，單位為 horse power&quot;;</span>
<span class="co">&quot;馬達轉速，單位為 rpm&quot;;</span>
<span class="co">&quot;齒制(Gear System)&quot;;</span>
<span class="co">&quot;齒輪材料與強度&quot;;</span>
<span class="co">&#39;&#39;&#39;</span>
<span class="co"># 這個程式要計算正齒輪的齒面寬, 資料庫連結希望使用 pybean 與 SQLite</span>
<span class="co"># 導入 pybean 模組與所要使用的 Store 及 SQLiteWriter 方法</span>
<span class="ch">from</span> pybean <span class="ch">import</span> Store, SQLiteWriter
<span class="ch">import</span> math

SQLite連結 = Store(SQLiteWriter(<span class="st">&quot;lewis.db&quot;</span>, frozen=<span class="ot">True</span>))
overall_counter = <span class="dv">0</span>
查表次數 = <span class="dv">0</span>
材料計數 = <span class="dv">0</span>

<span class="co"># 執行 formfactor 內插運算的函式</span>
<span class="kw">def</span> interpolation(小齒輪齒數, 齒形):
    <span class="kw">global</span> SQLite連結
    <span class="co"># 使用內插法求值</span>
    <span class="co"># 找出比目標齒數大的其中的最小的,就是最鄰近的大值</span>
    lewis_factor = SQLite連結.find_one(<span class="st">&quot;lewis&quot;</span>,<span class="st">&quot;gearno &gt; ?&quot;</span>,[小齒輪齒數])
    <span class="kw">if</span>(齒形 == <span class="dv">1</span>):
        larger_formfactor = lewis_factor.type1
    <span class="kw">elif</span>(齒形 == <span class="dv">2</span>):
        larger_formfactor = lewis_factor.type2
    <span class="kw">elif</span>(齒形 == <span class="dv">3</span>):
        larger_formfactor = lewis_factor.type3
    <span class="kw">else</span>:
        larger_formfactor = lewis_factor.type4
    larger_toothnumber = lewis_factor.gearno

    <span class="co"># 找出比目標齒數小的其中的最大的,就是最鄰近的小值</span>
    lewis_factor = SQLite連結.find_one(<span class="st">&quot;lewis&quot;</span>,<span class="st">&quot;gearno &lt; ? order by gearno DESC&quot;</span>,[小齒輪齒數])
    <span class="kw">if</span>(齒形 == <span class="dv">1</span>):
        smaller_formfactor = lewis_factor.type1
    <span class="kw">elif</span>(齒形 == <span class="dv">2</span>):
        smaller_formfactor = lewis_factor.type2
    <span class="kw">elif</span>(齒形 == <span class="dv">3</span>):
        smaller_formfactor = lewis_factor.type3
    <span class="kw">else</span>:
        smaller_formfactor = lewis_factor.type4
    smaller_toothnumber = lewis_factor.gearno
    calculated_factor = larger_formfactor + (小齒輪齒數 - larger_toothnumber) * (larger_formfactor - smaller_formfactor) / (larger_toothnumber - smaller_toothnumber)
    <span class="co"># 只傳回小數點後五位數</span>
    <span class="dt">print</span>(<span class="st">&quot;小齒輪齒數:&quot;</span>+<span class="dt">str</span>(小齒輪齒數)+<span class="st">&quot;, 齒形&quot;</span>+<span class="dt">str</span>(齒形)+<span class="st">&quot;, formfactor:&quot;</span>+<span class="dt">str</span>(<span class="dt">round</span>(calculated_factor, <span class="dv">5</span>)))
    <span class="kw">return</span> <span class="dt">round</span>(calculated_factor, <span class="dv">5</span>)

<span class="co"># 取得設計參數</span>
<span class="co">&#39;&#39;&#39;</span>
<span class="co">馬力 = 100</span>
<span class="co">轉速 = 1120</span>
<span class="co">減速比 = 4</span>
<span class="co">齒形 = 4</span>
<span class="co">安全係數 = 3</span>
<span class="co">#unsno_treatment</span>
<span class="co">材料 = &quot;G10350_CD&quot;</span>
<span class="co">小齒輪齒數 = 18</span>
<span class="co">&#39;&#39;&#39;</span>

<span class="co"># 改寫為齒面寬的設計函式</span>
<span class="kw">def</span> gear_width(馬力, 轉速, 減速比, 齒形, 安全係數, 材料, 小齒輪齒數):
    <span class="kw">global</span> SQLite連結
    <span class="kw">global</span> overall_counter
    <span class="kw">global</span> 查表次數
    <span class="kw">global</span> 材料計數
    <span class="co"># 根據所選用的齒形決定壓力角</span>
    <span class="kw">if</span>(齒形 == <span class="dv">1</span> or 齒形 == <span class="dv">2</span>):
        壓力角 = <span class="dv">20</span>
    <span class="kw">else</span>:
        壓力角 = <span class="dv">25</span>

    <span class="co"># 根據壓力角決定最小齒數</span>
    <span class="kw">if</span>(壓力角== <span class="dv">20</span>):
        最小齒數 = <span class="dv">18</span>
    <span class="kw">else</span>:
        最小齒數 = <span class="dv">12</span>

    <span class="co"># 直接設最小齒數</span>
    <span class="kw">if</span> 小齒輪齒數 &lt;= 最小齒數:
        小齒輪齒數 = 最小齒數
    <span class="co"># 大於400的齒數則視為齒條(Rack)</span>
    <span class="kw">if</span> 小齒輪齒數 &gt;= <span class="dv">400</span>:
        小齒輪齒數 = <span class="dv">400</span>

    <span class="co"># 根據所選用的材料查詢強度值</span>
    <span class="co"># 由 material之序號查 steel 表以得材料之降伏強度S單位為 kpsi 因此查得的值要成乘上1000</span>
    <span class="co"># 利用 Store  建立資料庫檔案對應物件, 並且設定 frozen=True 表示不要開放動態資料表的建立</span>
    <span class="co">#SQLite連結 = Store(SQLiteWriter(&quot;lewis.db&quot;, frozen=True))</span>
    <span class="co"># 指定 steel 資料表</span>
    steel = SQLite連結.new(<span class="st">&quot;steel&quot;</span>)
    <span class="co"># 資料查詢</span>
    <span class="co"># 將 unsno 與 treatment 從材料字串中隔開</span>
    unsno, treatment = 材料.split(<span class="st">&quot;_&quot;</span>, <span class="dv">1</span>)
    <span class="co">#print(unsno, treatment)</span>
    treatment = treatment.replace(<span class="st">&quot;_&quot;</span>, <span class="st">&quot; &quot;</span>)
    <span class="co">#print(treatment)</span>
    material = SQLite連結.find_one(<span class="st">&quot;steel&quot;</span>,<span class="st">&quot;unsno=? and treatment=?&quot;</span>,[unsno, treatment])
    <span class="co"># 列出 steel 資料表中的資料筆數</span>
    <span class="co">#print(SQLite連結.count(&quot;steel&quot;))</span>
    <span class="co">#print (material.yield_str)</span>
    <span class="kw">if</span> material.yield_str &gt; <span class="dv">100</span>:
        材料計數 += <span class="dv">1</span>
    strengthstress = material.yield_str*<span class="dv">1000</span>
    <span class="co"># 由小齒輪的齒數與齒形類別,查詢lewis form factor</span>
    <span class="co"># 先查驗是否有直接對應值</span>
    on_table = SQLite連結.count(<span class="st">&quot;lewis&quot;</span>,<span class="st">&quot;gearno=?&quot;</span>,[小齒輪齒數])
    <span class="kw">if</span> on_table == <span class="dv">1</span>:
        <span class="co"># 直接進入設計運算</span>
        <span class="co">#print(&quot;直接運算&quot;)</span>
        <span class="co">#print(on_table)</span>
        lewis_factor = SQLite連結.find_one(<span class="st">&quot;lewis&quot;</span>,<span class="st">&quot;gearno=?&quot;</span>,[小齒輪齒數])
        <span class="co">#print(lewis_factor.type1)</span>
        <span class="co"># 根據齒形查出 formfactor 值</span>
        <span class="kw">if</span>(齒形 == <span class="dv">1</span>):
            formfactor = lewis_factor.type1
        <span class="kw">elif</span>(齒形 == <span class="dv">2</span>):
            formfactor = lewis_factor.type2
        <span class="kw">elif</span>(齒形 == <span class="dv">3</span>):
            formfactor = lewis_factor.type3
        <span class="kw">else</span>:
            formfactor = lewis_factor.type4
    <span class="kw">else</span>:
        <span class="co"># 沒有直接對應值, 必須進行查表內插運算後, 再執行設計運算</span>
        <span class="co">#print(&quot;必須內插&quot;)</span>
        <span class="co">#print(interpolation(小齒輪齒數, 齒形))</span>
        查表次數 += <span class="dv">1</span>
        <span class="dt">print</span>(<span class="st">&quot;第&quot;</span>+<span class="dt">str</span>(查表次數)+<span class="st">&quot;次查表&quot;</span>)
        formfactor = interpolation(小齒輪齒數, 齒形)

    <span class="co"># 開始進行設計運算</span>

    ngear = 小齒輪齒數 * 減速比

    <span class="co"># 重要的最佳化設計---儘量用整數的diametralpitch</span>
    <span class="co"># 先嘗試用整數算若 diametralpitch 找到100 仍無所獲則改用 0.25 作為增量再不行則宣告 fail</span>
    counter = <span class="dv">0</span>
    i = <span class="fl">0.1</span>
    facewidth = <span class="dv">0</span>
    circularpitch = <span class="dv">0</span>
    <span class="kw">while</span> (facewidth &lt;= <span class="dv">3</span> * circularpitch or facewidth &gt;= <span class="dv">5</span> * circularpitch):
        diametralpitch = i
        <span class="co">#circularpitch = 3.14159/diametralpitch</span>
        circularpitch = math.pi/diametralpitch
        pitchdiameter = 小齒輪齒數/diametralpitch
        <span class="co">#pitchlinevelocity = 3.14159*pitchdiameter*轉速/12</span>
        pitchlinevelocity = math.pi * pitchdiameter * 轉速/<span class="dv">12</span>
        transmittedload = <span class="dv">33000</span> * 馬力/pitchlinevelocity
        velocityfactor = <span class="dv">1200</span>/(<span class="dv">1200</span> + pitchlinevelocity)
        <span class="co"># formfactor is Lewis form factor</span>
        <span class="co"># formfactor need to get from table 13-3 and determined ty teeth number and type of tooth</span>
        <span class="co"># formfactor = 0.293</span>
        <span class="co"># 90 is the value get from table corresponding to material type</span>
        facewidth = transmittedload * diametralpitch * 安全係數/velocityfactor/formfactor/strengthstress
        <span class="kw">if</span>(counter&gt;<span class="dv">5000</span>):
            <span class="dt">print</span>(<span class="st">&quot;超過5000次的設計運算,仍無法找到答案!&quot;</span>)
            <span class="dt">print</span>(<span class="st">&quot;可能所選用的傳遞功率過大,或無足夠強度的材料可以使用!&quot;</span>)
            <span class="co"># 離開while迴圈</span>
            <span class="kw">break</span>
        i += <span class="fl">0.1</span>
        counter += <span class="dv">1</span>
    facewidth = <span class="dt">round</span>(facewidth, <span class="dv">4</span>)
    <span class="kw">if</span>(counter&lt;<span class="dv">5000</span>):
        <span class="dt">print</span>(<span class="st">&quot;進行&quot;</span>+<span class="dt">str</span>(counter)+<span class="st">&quot;次重複運算後,得到合用的facewidth值為:&quot;</span>+<span class="dt">str</span>(facewidth))
    overall_counter += counter

<span class="co"># 執行正齒輪齒面寬的設計運算</span>
<span class="co">#gear_width(馬力, 轉速, 減速比, 齒形, 安全係數, 材料, 小齒輪齒數)</span>

<span class="co"># 執行輸入檔案的解讀</span>
輸入檔案 = <span class="dt">open</span>(<span class="st">&#39;design_input.txt&#39;</span>, encoding=<span class="st">&quot;UTF-8&quot;</span>) <span class="co"># 開檔案的內建模式為 read</span>
<span class="co"># 先將數字檔案中各行資料打包成為 list</span>
<span class="co"># 先讀第一行的標題資料行</span>
各行資料 = 輸入檔案.readline()
design_count = <span class="dv">0</span>
輸入= []
<span class="kw">while</span> <span class="ot">True</span>:
    <span class="co"># readline() 讀取單行</span>
    <span class="co"># readlines() 讀取多行, 並放入串列資料格式中</span>
    各行資料 = 輸入檔案.readline()
    design_count += <span class="dv">1</span>
    <span class="dt">print</span>(<span class="st">&quot;design#:&quot;</span>+<span class="dt">str</span>(design_count))
    <span class="co">#print(各行資料,end=&quot;&quot;)</span>
    <span class="co"># 以下兩行判斷式在確定檔案讀到最後一行後就會跳出 while 迴圈, 不會無限執行</span>
    <span class="kw">if</span> <span class="dt">len</span>(各行資料) == <span class="dv">0</span>: <span class="co"># 若該行的字數為 0, 表示已經到底</span>
        <span class="kw">break</span>
    <span class="co"># 去掉各行最後面的跳行符號</span>
    各行資料 = 各行資料.rstrip()
    <span class="co">#print(各行資料,end=&quot;&quot;)</span>
    <span class="co"># 依照資料的區隔符號 &quot;\t&quot; 將各行資料拆開, 並且存為 list, 到這裡各行資料為 list</span>
    各行資料 = 各行資料.split(<span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)
    <span class="co">&#39;&#39;&#39;</span>
<span class="co">    # 取得設計參數</span>
<span class="co">    馬力 = 100</span>
<span class="co">    轉速 = 1120</span>
<span class="co">    減速比 = 4</span>
<span class="co">    齒形 = 4</span>
<span class="co">    安全係數 = 3</span>
<span class="co">    #unsno_treatment</span>
<span class="co">    材料 = &quot;G10350_CD&quot;</span>
<span class="co">    小齒輪齒數 = 18</span>
<span class="co">    &#39;&#39;&#39;</span>
    馬力 = <span class="dt">int</span>(各行資料[<span class="dv">0</span>])
    轉速 = <span class="dt">int</span>(各行資料[<span class="dv">1</span>])
    減速比 = <span class="dt">float</span>(各行資料[<span class="dv">2</span>])
    齒形 = <span class="dt">int</span>(各行資料[<span class="dv">3</span>])
    安全係數 = <span class="dt">float</span>(各行資料[<span class="dv">4</span>])
    材料 = 各行資料[<span class="dv">5</span>]
    小齒輪齒數 = <span class="dt">int</span>(各行資料[<span class="dv">6</span>])
    gear_width(馬力, 轉速, 減速比, 齒形, 安全係數, 材料, 小齒輪齒數)
<span class="dt">print</span>(<span class="st">&quot;總運算次數:&quot;</span>+<span class="dt">str</span>(overall_counter))
    <span class="co"># 可以將各行資料印出檢查</span>
    <span class="co">#print(各行資料)</span>
    <span class="co"># 將各行資料數列再疊成 數字 list</span>
    <span class="co">#輸入.append(各行資料)</span>
<span class="co">#print(輸入)</span>
<span class="co"># 取得各行輸入值後, 再呼叫 gear_width 執行齒面寬的設計運算</span>
輸入檔案.close()
<span class="dt">print</span>(<span class="st">&quot;查表次數:&quot;</span>+<span class="dt">str</span>(查表次數))
<span class="dt">print</span>(<span class="st">&quot;材料計數:&quot;</span>+<span class="dt">str</span>(材料計數))</code></pre>
<p>Welcome to the 2014cdb wiki!</p>
<h1 id="注意事項">注意事項</h1>
<ul>
<li>Python 版次必須使用 3.3 版</li>
<li>Leo Editor 必須使用 4.11 版</li>
<li>Creo 必須使用 64 位元教育版本</li>
<li>IE 建議使用 11 版</li>
<li>建立 pdf 與 html 文件則需要 pandoc 與 portableLatex 可攜應用程式(位於 apps 目錄下)</li>
<li>Git 則使用可攜版本(位於 apps 目錄下)</li>
</ul>
<h1 id="各組-push-資料確認事項">各組 push 資料確認事項</h1>
<ul>
<li>git config –list 中的 user.name 是否為各組代號 (代號錯誤將無法取分)</li>
<li>application 網站是否可以正確執行</li>
<li>.leo 檔案是否可以被 Leo Editor 正確開啟</li>
<li>專案是否可以正確產生協同報告 pdf 與 html 檔案</li>
<li>與 .leo 專案對應的外部目錄與檔案是否正確設定</li>
</ul>
<h1 id="同步雲端網站">同步雲端網站</h1>
<p>http://2014cda-mdenfu.rhcloud.com/</p>
<h1 id="scda-分組日誌">2014scda 分組日誌</h1>
<p>[<a href="#scda-分組日誌">2014scda 分組日誌</a>]</p>
<p>2014cdag1 分組網站: http://2014cdag1-cadp13ag6.rhcloud.com/</p>
<p>2014cdag1 分組 Github: https://github.com/2014cdag1</p>
<table>
<col width="9%" />
<tbody>
<tr class="odd">
<td align="left">2014cdag2 分組網站:https://2014cdag2-40123103.rhcloud.com/get_page?heading=</td>
</tr>
<tr class="even">
<td align="left">2014cdag2 分組 Github:https://github.com/2014cdag2</td>
</tr>
</tbody>
</table>
<p>2014cdag3 分組網站：http://2014cdag3-cadp13ag10.rhcloud.com/</p>
<p>2014cdag3 分組 Github：https://github.com/2014cdag3/cdg3</p>
<hr />
<p>2014cdag4 分組網站:http://cdg4-40123150.rhcloud.com/</p>
<p>2014cdag4 分組 Github:https://github.com/2014cdag4</p>
<table>
<col width="9%" />
<tbody>
<tr class="odd">
<td align="left">2014cdag5 分組網站：http://2014cdag5-yimin40123157.rhcloud.com/</td>
</tr>
<tr class="even">
<td align="left">2014cdag5 分組 Github：https://github.com/2014cdag5</td>
</tr>
</tbody>
</table>
<p>2014cdag6 分組網站：http://2014cdag6-40123109cd2014.rhcloud.com/</p>
<p>2014cdag6 分組 Github：https://github.com/2014cdag6/2014cdag6</p>
<table>
<col width="9%" />
<tbody>
<tr class="odd">
<td align="left">2014cdag7 分組網站:http://python-49823207.rhcloud.com/</td>
</tr>
<tr class="even">
<td align="left">2014cdag7 分組 Github:https://github.com/2014cdag7/2014cdag7</td>
</tr>
</tbody>
</table>
<p>2014cdag8 分組網站:http://2014cdag8-40123141.rhcloud.com/</p>
<p>2014cdag8 分組 Github:https://github.com/2014cdag8</p>
<hr />
<p>2014cdag9 分組網站：http://2014cadg9-40123114.rhcloud.com/</p>
<p>2014cdag9 分組 Github：https://github.com/2014cdag9</p>
<table>
<col width="9%" />
<tbody>
<tr class="odd">
<td align="left">2014cdag10 分組網站：http://cdag10-40123153.rhcloud.com/</td>
</tr>
<tr class="even">
<td align="left">2014cdag10 分組 Github：https://github.com/2014cdag10/2014cdag10</td>
</tr>
</tbody>
</table>
<p>2014cdag12 分組網站：http://cadpa1-40123123.rhcloud.com/</p>
<p>2014cdag12 分組 Github：https://github.com/2014cdag12</p>
<table>
<col width="9%" />
<tbody>
<tr class="odd">
<td align="left">2014cdag13 分組網站：http://python-40123124.rhcloud.com/</td>
</tr>
<tr class="even">
<td align="left">2014cdag13 分組 Github：https://github.com/2014cdag13</td>
</tr>
</tbody>
</table>
<p>2014cdag14 分組網站：https://github-cadpag5.rhcloud.com/</p>
<p>2014cdag14 分組 Github：https://github.com/2014cdag14</p>
<table>
<col width="9%" />
<tbody>
<tr class="odd">
<td align="left">2014cdag15 分組網站：http://2014cdag15-40123146.rhcloud.com/</td>
</tr>
<tr class="even">
<td align="left">2014cdag15 分組 Github：https://github.com/2014cdag15</td>
</tr>
</tbody>
</table>
<p>2014cdag16 分組網站：http://github-cda2014g16.rhcloud.com/</p>
<p>2014cdag16 分組 Github：https://github.com/2014cdag16/2014cdag16</p>
<table>
<col width="9%" />
<tbody>
<tr class="odd">
<td align="left">2014cdag17 分組網站：http://2014cd17-ccwei.rhcloud.com/</td>
</tr>
<tr class="even">
<td align="left">2014cdag17 分組 Github：https://github.com/2014cdag17/CDAG17</td>
</tr>
</tbody>
</table>
<p>2014cdag18 分組網站：http://2014cdag18-40123126.rhcloud.com/</p>
<p>2014cdag18 分組 Github：https://github.com/2014cdag18</p>
<table>
<col width="9%" />
<tbody>
<tr class="odd">
<td align="left">2014cdag21 分組網站：https://cmsimply-40123156.rhcloud.com/</td>
</tr>
<tr class="even">
<td align="left">2014cdag21 分組 Github：https://github.com/2014cdag21/c21</td>
</tr>
</tbody>
</table>
<h1 id="各週課後註記">各週課後註記</h1>
<p>自 W11 使用 pandoc_auto 產生協同報告文件, 不再使用手動增加分組報告, 只要在 doc/分組代號/ 中加入 doc.txt, 並且使用正確的 pandoc markdown 格式就可以從 pandoc_auto 按鈕產生對應的 html 與 pdf 檔案.</p>
<p>自 W12 起各組必須在分組 doc/分組代號/doc.txt 中加入第八週與第九週考試內容與心得.</p>
<h1 id="creo-討論區">Creo 討論區</h1>
<p>http://www.mcadcentral.com/creo-user-forum-topics/</p>
<p>var drwmodels = drawing.ListModels(); newWin.document.writeln (&quot;&lt;br&gt;&quot; + &quot;Drawing: &quot; + drawing.FileName + &quot; ( &quot; + drwmodels.Count + &quot; drw models )&quot;);</p>
<p>var modelitemtype = pfcCreate(&quot;pfcModelItemType&quot;);</p>
<p>/<em>--Retrieve the symbol definition from the system--</em>/</p>
<p>var symDef = drawing.RetrieveSymbolDefinition (&quot;sym_name&quot;, void null, void null, true);</p>
<p>for (var i = 0; i &lt; drwmodels.Count; i++) {</p>
<p>drwmodel = drwmodels.Item(i); var showndims = drawing.ListShownDimensions(drwmodel, modelitemtype.ITEM_DIMENSION); newWin.document.writeln (&quot;&lt;br&gt;&quot; + &quot;   Model &quot; + (i+1) + &quot;: &quot; + drwmodel.FileName + &quot; ( &quot; + showndims.Count + &quot; shown dims )&quot;);</p>
<p>for (var j = 0; j &lt; showndims.Count; j++) {</p>
<p>var pnt3d = void null; var showndim = showndims.Item(j); var symbol = showndim.Symbol; var value = showndim.DimValue; pnt3d = showndim.Location;</p>
<p>newWin.document.writeln (&quot;&lt;br&gt;&quot; + &quot;     Dim &quot; + (j+1) + &quot;: &quot; + symbol + &quot; = &quot; + value + &quot; ( &quot; + pnt3d.Item(0) + &quot; , &quot; + pnt3d.Item(1) + &quot; , &quot; + pnt3d.Item(2) + &quot; )&quot;);</p>
<p>var position = void null; var instrs = pfcCreate (&quot;pfcDetailSymbolInstInstructions&quot;).Create (symDef); position = pfcCreate (&quot;pfcFreeAttachment&quot;).Create (pnt3d); var allAttachments = pfcCreate (&quot;pfcDetailLeaders&quot;).Create ();</p>
<p>position.AttachmentPoint = pnt3d; allAttachments.ItemAttachment = position; instrs.InstAttachment = allAttachments;</p>
<p>/<em>--Set the VariantTexts (for var text)--</em>/</p>
<p>var vtpp = pfcCreate (&quot;pfcDetailVariantText&quot;).Create (&quot;vartext&quot;, j+1); var vtpp2 = pfcCreate (&quot;pfcDetailVariantTexts&quot;); vtpp2.append(vtpp); instrs.TextValues = vtpp2;</p>
<p>/<em>--Create and display the symbol--</em>/</p>
<p>var symInst = drawing.CreateDetailItem (instrs); symInst.Show(); } }</p>
<p>pfcWindow.Window.ExportRasterImage to save graphics</p>
<p>ProWindowPanZoomMatrixSet</p>
<p>ComponentConstraintType—Using the TYPE options, you can specify the placement constraint types. They are as follows:</p>
<p>ASM_CONSTRAINT_MATE—Use this option to make two surfaces touch one another, that is coincident and facing each other.</p>
<p>ASM_CONSTRAINT_MATE_OFF—Use this option to make two planar surfaces parallel and facing each other.</p>
<p>ASM_CONSTRAINT_ALIGN—Use this option to make two planes coplanar, two axes coaxial and two points coincident. You can also align revolved surfaces or edges. ○ ASM_CONSTRAINT_ALIGN_OFF—Use this option to align two planar surfaces at an offset.</p>
<p>ASM_CONSTRAINT_INSERT—Use this option to insert a &quot;male&quot; revolved surface into a ``female'' revolved surface, making their respective axes coaxial.</p>
<p>ASM_CONSTRAINT_ORIENT—Use this option to make two planar surfaces to be parallel in the same direction.</p>
<p>ASM_CONSTRAINT_CSYS—Use this option to place a component in an assembly by aligning the coordinate system of the component with the coordinate system of the assembly.</p>
<p>ASM_CONSTRAINT_TANGENT—Use this option to control the contact of two surfaces at their tangents.</p>
<p>ASM_CONSTRAINT_PNT_ON_SRF—Use this option to control the contact of a surface with a point.</p>
<p>ASM_CONSTRAINT_EDGE_ON_SRF—Use this option to control the contact of a surface with a straight edge.</p>
<p>ASM_CONSTRAINT_DEF_PLACEMENT—Use this option to align the default coordinate system of the component tothe default coordinate system of the assembly.</p>
<p>ASM_CONSTRAINT_SUBSTITUTE—Use this option in simplified representations when a component has been substituted with some other model</p>
<p>ASM_CONSTRAINT_PNT_ON_LINE—Use this option to control the contact of a line with a point.</p>
<p>ASM_CONSTRAINT_FIX—Use this option to force the component to remain in its current packaged position.</p>
<p>ASM_CONSTRAINT_AUTO—Use this option in the user interface to allow an automatic choice of constraint type based upon the references.</p>
<p>getBodyDiagonalInfo: function() { try { var cModel = this.getCurrentModel();<br /> var mitems = cModel.ListItems(pfcCreate(&quot;pfcModelItemType&quot;).ITEM_COORD_SYS); var cor = mitems.Item(0); var trans3 = cor.CoordSys;</p>
<pre><code>var modtyp = pfcCreate(&quot;pfcModelItemTypes&quot;);
var item1 = pfcCreate(&quot;pfcModelItemType&quot;).ITEM_AXIS;
var item2 = pfcCreate(&quot;pfcModelItemType&quot;).ITEM_POINT;
var item3 = pfcCreate(&quot;pfcModelItemType&quot;).ITEM_COORD_SYS;

modtyp.Insert(0,item1);
modtyp.Insert(1,item2);
modtyp.Insert(2,item3);
var outline = cModel.EvalOutline(trans3,modtyp);
var point2 = outline.Item(0);
var x = point2.Item(0);
var y = point2.Item(1);
var z = point2.Item(2);
var point3 = outline.Item(1);
var p = point3.Item(0);
var q = point3.Item(1);
var r = point3.Item(2);
var sum = Math.pow(p - x, 2) + Math.pow(q - y, 2) + Math.pow(r - z, 2);
var diagonal = Math.sqrt(sum);
return diagonal;</code></pre>
<p>} catch (e) { throw e; } }</p>
<p>建立元件的約束物件</p>
<p>pfcComponentConstraint.Create()</p>
<p>ComponentConstraintType Using the TYPE options, you can specify the placement constraint types. They are as follows:</p>
<p>兩平面進行面接約束 (ASM_CONSTRAINT_MATE)</p>
<p>○ ASM_CONSTRAINT_MATE Use this option to make two surfaces touch one another, that is coincident and facing each other.</p>
<p>兩平面進行面接約束, 且相隔一段距離 (ASM_CONSTRAINT_MATE_OFF)</p>
<p>○ ASM_CONSTRAINT_MATE_OFF Use this option to make two planar surfaces parallel and facing each other.</p>
<p>兩平面或兩軸對齊 (ASM_CONSTRAINT_ALIGN)</p>
<p>○ ASM_CONSTRAINT_ALIGN Use this option to make two planes coplanar, two axes coaxial and two points coincident. You can also align revolved surfaces or edges.</p>
<p>兩平面或兩軸對齊, 且維持一特定距離 (ASM_CONSTRAINT_ALIGN_OFF)</p>
<p>○ ASM_CONSTRAINT_ALIGN_OFF Use this option to align two planar surfaces at an offset.</p>
<p>插入約束 (ASM_CONSTRAINT_INSERT)</p>
<p>○ ASM_CONSTRAINT_INSERT Use this option to insert a &quot;male&quot; revolved surface into a ``female'' revolved surface, making their respective axes coaxial.</p>
<p>同方位約束 (ASM_CONSTRAINT_ORIENT)</p>
<p>○ ASM_CONSTRAINT_ORIENT Use this option to make two planar surfaces to be parallel in the same direction.</p>
<p>座標系統定位約束 (ASM_CONSTRAINT_CSYS)</p>
<p>○ ASM_CONSTRAINT_CSYS Use this option to place a component in an assembly by aligning the coordinate system of the component with the coordinate system of the assembly.</p>
<p>垂直約束 (ASM_CONSTRAINT_TANGENT)</p>
<p>○ ASM_CONSTRAINT_TANGENT Use this option to control the contact of two surfaces at their tangents.</p>
<p>控制與某曲面上一點接觸約束 (ASM_CONSTRAINT_PNT_ON_SRF)</p>
<p>○ ASM_CONSTRAINT_PNT_ON_SRF Use this option to control the contact of a surface with a point.</p>
<p>控制與某曲面上一線接觸約束 (ASM_CONSTRAINT_EDGE_ON_SRF)</p>
<p>○ ASM_CONSTRAINT_EDGE_ON_SRF Use this option to control the contact of a surface with a straight edge.</p>
<p>與組立中的特定座標系統對齊 (ASM_CONSTRAINT_DEF_PLACEMENT)</p>
<p>○ ASM_CONSTRAINT_DEF_PLACEMENT Use this option to align the default coordinate system of the component to the default coordinate system of the assembly.</p>
<p>取代約束 (ASM_CONSTRAINT_SUBSTITUTE)</p>
<p>○ ASM_CONSTRAINT_SUBSTITUTE Use this option in simplified representations when a component has been substituted with some other model</p>
<p>線與點進行接觸約束 (ASM_CONSTRAINT_PNT_ON_LINE)</p>
<p>○ ASM_CONSTRAINT_PNT_ON_LINE Use this option to control the contact of a line with a point.</p>
<p>固定約束 (ASM_CONSTRAINT_FIX)</p>
<p>○ ASM_CONSTRAINT_FIX Use this option to force the component to remain in its current packaged position.</p>
<p>○ ASM_CONSTRAINT_AUTO Use this option in the user interface to allow an automatic choice of constraint type based upon the references.AssemblyDatumSide Orientation of the assembly. This can have the following values:</p>
<p>進行正面方向約束</p>
<p>○ Yellow The primary side of the datum plane which is the default direction of the arrow.</p>
<p>進行反面方向約束</p>
<p>○ Red The secondary side of the datum plane which is the direction opposite to that of the arrow.</p>
<p>ComponentReference A reference on the placed component.</p>
<p>ComponentDatumSide Orientation of the assembly component. This can have the following values:</p>
<p>正面約束</p>
<p>○ Yellow The primary side of the datum plane which is the default direction of the arrow.</p>
<p>反面約束 ○ Red The secondary side of the datum plane which is the direction opposite to that of the arrow.</p>
<p>Offset The mate or align offset value from the reference.</p>
<p>In Pro/ENGINEER, a component's constraints are defined to restrict its movement with respect to other components. Under certain conditions, a component's definition dialog box shows an option to &quot;Allow assumptions&quot; on the component.</p>
<p>When you select this option, Pro/ENGINEER adds more constraints to completely constrain the component's motion with respect to its connected, neighboring components.</p>
<p>Because these extra constraints are hidden, the exporter cannot accurately determine the DoF restrictions between a component and its connected, neighboring components.</p>
<p>To Allow Constraint Orientation Assumptions</p>
<p>The Allow Assumptions check box, located in the Placement Status area of the Component Placement dialog box, allows you to switch system constraint orientation assumptions on and off. The Allow Assumptions check box is available whenever assumptions are made or could be made; when a component is fully constrained, the check box disappears. The setting of Allow Assumptions is component specific, and the setting is saved with the component.</p>
<p>Allow assumptions - will allow Pro/E to make assumptions as to what you think something to be fully constrained, like a bushing in a cylinder after you use the insert and align will be listed as fully constrained even though a rotational degree of freedom still exist.</p>
<p>Typically, three placement constraints are required to fully constrain a component. Fewer constraints may be applied if the system is able to position the component by making assumptions regarding orientation.</p>
<p>In reality, there is still a rotational degree of freedom open for this component, but that may not be critical in our design, so we can allow the system to fix this rotational degree of freedom for us. If we were to uncheck the “Allow Assumptions” box, we would have to define additional placement constraints to fix this rotational degree of freedom.</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="co">#coding: utf-8</span>
<span class="ch">import</span> sqlite3
<span class="ch">from</span> pkg_resources <span class="ch">import</span> parse_version

__version__ = <span class="st">&quot;0.2.1&quot;</span>
__author__ = <span class="st">&quot;Mickael Desfrenes&quot;</span>
__email__ = <span class="st">&quot;desfrenes@gmail.com&quot;</span>

<span class="co"># Yen 2013.04.08, 將 Python2 的 .next() 改為 next(), 以便在 Python 3 中使用</span>

<span class="kw">class</span> SQLiteWriter(<span class="dt">object</span>):

    <span class="co">&quot;&quot;&quot;</span>
<span class="co">    In frozen mode (the default), the writer will not alter db schema.</span>
<span class="co">    Just add frozen=False to enable column creation (or just add False</span>
<span class="co">    as second parameter):</span>

<span class="co">    query_writer = SQLiteWriter(&quot;:memory:&quot;, False)</span>
<span class="co">    &quot;&quot;&quot;</span>
    <span class="kw">def</span> <span class="ot">__init__</span>(<span class="ot">self</span>, db_path=<span class="st">&quot;:memory:&quot;</span>, frozen=<span class="ot">True</span>):
        <span class="ot">self</span>.db = sqlite3.<span class="ot">connect</span>(db_path)
        <span class="ot">self</span>.db.isolation_level = <span class="ot">None</span>
        <span class="ot">self</span>.db.row_factory = sqlite3.Row
        <span class="ot">self</span>.frozen = frozen
        <span class="ot">self</span>.cursor = <span class="ot">self</span>.db.cursor()
        <span class="ot">self</span>.cursor.execute(<span class="st">&quot;PRAGMA foreign_keys=ON;&quot;</span>)
        <span class="ot">self</span>.cursor.execute(<span class="st">&#39;PRAGMA encoding = &quot;UTF-8&quot;;&#39;</span>)
        <span class="ot">self</span>.cursor.execute(<span class="st">&#39;BEGIN;&#39;</span>)
    <span class="kw">def</span> <span class="ot">__del__</span>(<span class="ot">self</span>):
        <span class="ot">self</span>.db.close()

    <span class="kw">def</span> replace(<span class="ot">self</span>, bean):
        keys = []
        values = []
        write_operation = <span class="st">&quot;replace&quot;</span>
        <span class="kw">if</span> <span class="st">&quot;id&quot;</span> not in bean.__dict__:
            write_operation = <span class="st">&quot;insert&quot;</span>
            keys.append(<span class="st">&quot;id&quot;</span>)
            values.append(<span class="ot">None</span>)
        <span class="ot">self</span>.__create_table(bean.__class__.<span class="ot">__name__</span>)
        columns = <span class="ot">self</span>.__get_columns(bean.__class__.<span class="ot">__name__</span>)
        <span class="kw">for</span> key in bean.__dict__:
            keys.append(key)
            <span class="kw">if</span> key not in columns:
                <span class="ot">self</span>.__create_column(bean.__class__.<span class="ot">__name__</span>, key,
                        <span class="dt">type</span>(bean.__dict__[key]))
            values.append(bean.__dict__[key])
        sql  = write_operation + <span class="st">&quot; into &quot;</span> + bean.__class__.<span class="ot">__name__</span> + <span class="st">&quot;(&quot;</span>
        sql += <span class="st">&quot;,&quot;</span>.join(keys) + <span class="st">&quot;) values (&quot;</span> 
        sql += <span class="st">&quot;,&quot;</span>.join([<span class="st">&quot;?&quot;</span> <span class="kw">for</span> i in keys])  +  <span class="st">&quot;)&quot;</span>
        <span class="ot">self</span>.cursor.execute(sql, values)
        <span class="kw">if</span> write_operation == <span class="st">&quot;insert&quot;</span>:
            bean.<span class="dt">id</span> = <span class="ot">self</span>.cursor.lastrowid
        <span class="kw">return</span> bean.<span class="dt">id</span>

    <span class="kw">def</span> __create_column(<span class="ot">self</span>, table, column, sqltype):
        <span class="kw">if</span> <span class="ot">self</span>.frozen:
            <span class="kw">return</span>
        <span class="kw">if</span> sqltype in [<span class="dt">float</span>, <span class="dt">int</span>, <span class="dt">bool</span>]:
            sqltype = <span class="st">&quot;NUMERIC&quot;</span>
        <span class="kw">else</span>:
            sqltype = <span class="st">&quot;TEXT&quot;</span>
        sql = <span class="st">&quot;alter table &quot;</span> + table + <span class="st">&quot; add &quot;</span> + column + <span class="st">&quot; &quot;</span> + sqltype    
        <span class="ot">self</span>.cursor.execute(sql)

    <span class="kw">def</span> __get_columns(<span class="ot">self</span>, table):
        columns = []
        <span class="kw">if</span> <span class="ot">self</span>.frozen:
            <span class="kw">return</span> columns
        <span class="ot">self</span>.cursor.execute(<span class="st">&quot;PRAGMA table_info(&quot;</span> + table  + <span class="st">&quot;)&quot;</span>)
        <span class="kw">for</span> row in <span class="ot">self</span>.cursor:
            columns.append(row[<span class="st">&quot;name&quot;</span>])
        <span class="kw">return</span> columns

    <span class="kw">def</span> __create_table(<span class="ot">self</span>, table):
        <span class="kw">if</span> <span class="ot">self</span>.frozen:
            <span class="kw">return</span>
        sql = <span class="st">&quot;create table if not exists &quot;</span> + table + <span class="st">&quot;(id INTEGER PRIMARY KEY AUTOINCREMENT)&quot;</span>
        <span class="ot">self</span>.cursor.execute(sql)

    <span class="kw">def</span> get_rows(<span class="ot">self</span>, table_name, sql = <span class="st">&quot;1&quot;</span>, replace = <span class="ot">None</span>):
        <span class="kw">if</span> replace is <span class="ot">None</span> : replace = []
        <span class="ot">self</span>.__create_table(table_name)
        sql = <span class="st">&quot;SELECT * FROM &quot;</span> + table_name + <span class="st">&quot; WHERE &quot;</span> + sql
        <span class="kw">try</span>:
            <span class="ot">self</span>.cursor.execute(sql, replace)
            <span class="kw">for</span> row in <span class="ot">self</span>.cursor:
                <span class="kw">yield</span> row
        <span class="kw">except</span> sqlite3.OperationalError:
            <span class="kw">return</span>
   
    <span class="kw">def</span> get_count(<span class="ot">self</span>, table_name, sql=<span class="st">&quot;1&quot;</span>, replace = <span class="ot">None</span>):
        <span class="kw">if</span> replace is <span class="ot">None</span> : replace = []
        <span class="ot">self</span>.__create_table(table_name)
        sql = <span class="st">&quot;SELECT count(*) AS cnt FROM &quot;</span> + table_name + <span class="st">&quot; WHERE &quot;</span> + sql
        <span class="kw">try</span>:
            <span class="ot">self</span>.cursor.execute(sql, replace)
        <span class="kw">except</span> sqlite3.OperationalError:
            <span class="kw">return</span> <span class="dv">0</span>
        <span class="kw">for</span> row in <span class="ot">self</span>.cursor:
            <span class="kw">return</span> row[<span class="st">&quot;cnt&quot;</span>]

    <span class="kw">def</span> delete(<span class="ot">self</span>, bean):
        <span class="ot">self</span>.__create_table(bean.__class__.<span class="ot">__name__</span>)
        sql = <span class="st">&quot;delete from &quot;</span> + bean.__class__.<span class="ot">__name__</span> + <span class="st">&quot; where id=?&quot;</span>
        <span class="ot">self</span>.cursor.execute(sql,[bean.<span class="dt">id</span>])
    
    <span class="kw">def</span> link(<span class="ot">self</span>, bean_a, bean_b):
        <span class="ot">self</span>.replace(bean_a)
        <span class="ot">self</span>.replace(bean_b)
        table_a = bean_a.__class__.<span class="ot">__name__</span>
        table_b = bean_b.__class__.<span class="ot">__name__</span>
        assoc_table = <span class="ot">self</span>.__create_assoc_table(table_a, table_b)
        sql = <span class="st">&quot;replace into &quot;</span> + assoc_table + <span class="st">&quot;(&quot;</span> + table_a + <span class="st">&quot;_id,&quot;</span> + table_b
        sql += <span class="st">&quot;_id) values(?,?)&quot;</span>
        <span class="ot">self</span>.cursor.execute(sql,
                [bean_a.<span class="dt">id</span>, bean_b.<span class="dt">id</span>])
    
    <span class="kw">def</span> unlink(<span class="ot">self</span>, bean_a, bean_b):
        table_a = bean_a.__class__.<span class="ot">__name__</span>
        table_b = bean_b.__class__.<span class="ot">__name__</span>
        assoc_table = <span class="ot">self</span>.__create_assoc_table(table_a, table_b)
        sql = <span class="st">&quot;delete from &quot;</span> + assoc_table + <span class="st">&quot; where &quot;</span> + table_a
        sql += <span class="st">&quot;_id=? and &quot;</span> + table_b + <span class="st">&quot;_id=?&quot;</span>
        <span class="ot">self</span>.cursor.execute(sql,
                [bean_a.<span class="dt">id</span>, bean_b.<span class="dt">id</span>])
    
    <span class="kw">def</span> get_linked_rows(<span class="ot">self</span>, bean, table_name):
        bean_table = bean.__class__.<span class="ot">__name__</span>
        assoc_table = <span class="ot">self</span>.__create_assoc_table(bean_table, table_name)
        sql = <span class="st">&quot;select t.* from &quot;</span> + table_name + <span class="st">&quot; t inner join &quot;</span> + assoc_table 
        sql += <span class="st">&quot; a on a.&quot;</span> + table_name + <span class="st">&quot;_id = t.id where a.&quot;</span>
        sql += bean_table + <span class="st">&quot;_id=?&quot;</span>
        <span class="ot">self</span>.cursor.execute(sql,[bean.<span class="dt">id</span>])
        <span class="kw">for</span> row in <span class="ot">self</span>.cursor:
            <span class="kw">yield</span> row

    <span class="kw">def</span> __create_assoc_table(<span class="ot">self</span>, table_a, table_b):
        assoc_table = <span class="st">&quot;_&quot;</span>.join(<span class="dt">sorted</span>([table_a, table_b]))
        <span class="kw">if</span> not <span class="ot">self</span>.frozen:
            sql = <span class="st">&quot;create table if not exists &quot;</span> + assoc_table + <span class="st">&quot;(&quot;</span>
            sql+= table_a + <span class="st">&quot;_id NOT NULL REFERENCES &quot;</span> + table_a + <span class="st">&quot;(id) ON DELETE cascade,&quot;</span>
            sql+= table_b + <span class="st">&quot;_id NOT NULL REFERENCES &quot;</span> + table_b + <span class="st">&quot;(id) ON DELETE cascade,&quot;</span>
            sql+= <span class="st">&quot; PRIMARY KEY (&quot;</span> + table_a + <span class="st">&quot;_id,&quot;</span> + table_b + <span class="st">&quot;_id));&quot;</span>
            <span class="ot">self</span>.cursor.execute(sql)
            <span class="co"># no real support for foreign keys until sqlite3 v3.6.19</span>
            <span class="co"># so here&#39;s the hack</span>
            <span class="kw">if</span> <span class="dt">cmp</span>(parse_version(sqlite3.sqlite_version),parse_version(<span class="st">&quot;3.6.19&quot;</span>)) &lt; <span class="dv">0</span>:
                sql = <span class="st">&quot;create trigger if not exists fk_&quot;</span> + table_a + <span class="st">&quot;_&quot;</span> + assoc_table
                sql+= <span class="st">&quot; before delete on &quot;</span> + table_a
                sql+= <span class="st">&quot; for each row begin delete from &quot;</span> + assoc_table + <span class="st">&quot; where &quot;</span> + table_a + <span class="st">&quot;_id = OLD.id;end;&quot;</span>
                <span class="ot">self</span>.cursor.execute(sql)
                sql = <span class="st">&quot;create trigger if not exists fk_&quot;</span> + table_b + <span class="st">&quot;_&quot;</span> + assoc_table
                sql+= <span class="st">&quot; before delete on &quot;</span> + table_b
                sql+= <span class="st">&quot; for each row begin delete from &quot;</span> + assoc_table + <span class="st">&quot; where &quot;</span> + table_b + <span class="st">&quot;_id = OLD.id;end;&quot;</span>
                <span class="ot">self</span>.cursor.execute(sql)
        <span class="kw">return</span> assoc_table

    <span class="kw">def</span> delete_all(<span class="ot">self</span>, table_name, sql = <span class="st">&quot;1&quot;</span>, replace = <span class="ot">None</span>):
        <span class="kw">if</span> replace is <span class="ot">None</span> : replace = []
        <span class="ot">self</span>.__create_table(table_name)
        sql = <span class="st">&quot;DELETE FROM &quot;</span> + table_name + <span class="st">&quot; WHERE &quot;</span> + sql
        <span class="kw">try</span>:
            <span class="ot">self</span>.cursor.execute(sql, replace)
            <span class="kw">return</span> <span class="ot">True</span>
        <span class="kw">except</span> sqlite3.OperationalError:
            <span class="kw">return</span> <span class="ot">False</span>

    <span class="kw">def</span> commit(<span class="ot">self</span>):
        <span class="ot">self</span>.db.commit()



<span class="kw">class</span> Store(<span class="dt">object</span>):
    <span class="co">&quot;&quot;&quot;</span>
<span class="co">    A SQL writer should be passed to the constructor:</span>

<span class="co">    beans_save = Store(SQLiteWriter(&quot;:memory&quot;), frozen=False)</span>
<span class="co">    &quot;&quot;&quot;</span>
    <span class="kw">def</span> <span class="ot">__init__</span>(<span class="ot">self</span>, SQLWriter):
        <span class="ot">self</span>.writer = SQLWriter 
    
    <span class="kw">def</span> new(<span class="ot">self</span>, table_name):
        new_object = <span class="dt">type</span>(table_name,(<span class="dt">object</span>,),{})()
        <span class="kw">return</span> new_object

    <span class="kw">def</span> save(<span class="ot">self</span>, bean):
        <span class="ot">self</span>.writer.replace(bean)
    
    <span class="kw">def</span> load(<span class="ot">self</span>, table_name, <span class="dt">id</span>):
        <span class="kw">for</span> row in <span class="ot">self</span>.writer.get_rows(table_name, <span class="st">&quot;id=?&quot;</span>, [<span class="dt">id</span>]):
            <span class="kw">return</span> <span class="ot">self</span>.row_to_object(table_name, row)

    <span class="kw">def</span> count(<span class="ot">self</span>, table_name, sql = <span class="st">&quot;1&quot;</span>, replace=<span class="ot">None</span>):
        <span class="kw">return</span> <span class="ot">self</span>.writer.get_count(table_name, sql, replace <span class="kw">if</span> replace is not <span class="ot">None</span> <span class="kw">else</span> [])

    <span class="kw">def</span> find(<span class="ot">self</span>, table_name, sql = <span class="st">&quot;1&quot;</span>, replace=<span class="ot">None</span>):
        <span class="kw">for</span> row in <span class="ot">self</span>.writer.get_rows(table_name, sql, replace <span class="kw">if</span> replace is not <span class="ot">None</span> <span class="kw">else</span> []):
            <span class="kw">yield</span> <span class="ot">self</span>.row_to_object(table_name, row)

    <span class="kw">def</span> find_one(<span class="ot">self</span>, table_name, sql = <span class="st">&quot;1&quot;</span>, replace=<span class="ot">None</span>):
        <span class="kw">try</span>:
            <span class="kw">return</span> <span class="dt">next</span>(<span class="ot">self</span>.find(table_name, sql, replace))
        <span class="kw">except</span> <span class="ot">StopIteration</span>:
            <span class="kw">return</span> <span class="ot">None</span>

    <span class="kw">def</span> delete(<span class="ot">self</span>, bean):
        <span class="ot">self</span>.writer.delete(bean)
    
    <span class="kw">def</span> link(<span class="ot">self</span>, bean_a, bean_b):
        <span class="ot">self</span>.writer.link(bean_a, bean_b)
    
    <span class="kw">def</span> unlink(<span class="ot">self</span>, bean_a, bean_b):
        <span class="ot">self</span>.writer.unlink(bean_a, bean_b)
    
    <span class="kw">def</span> get_linked(<span class="ot">self</span>, bean, table_name):
        <span class="kw">for</span> row in <span class="ot">self</span>.writer.get_linked_rows(bean, table_name):
            <span class="kw">yield</span> <span class="ot">self</span>.row_to_object(table_name, row)

    <span class="kw">def</span> delete_all(<span class="ot">self</span>, table_name, sql = <span class="st">&quot;1&quot;</span>, replace=<span class="ot">None</span>):
        <span class="kw">return</span> <span class="ot">self</span>.writer.delete_all(table_name, sql, replace <span class="kw">if</span> replace is not <span class="ot">None</span> <span class="kw">else</span> [])

    <span class="kw">def</span> row_to_object(<span class="ot">self</span>, table_name, row):
        new_object = <span class="dt">type</span>(table_name,(<span class="dt">object</span>,),{})()
        <span class="kw">for</span> key in row.keys():
            new_object.__dict__[key] = row[key]
        <span class="kw">return</span> new_object

    <span class="kw">def</span> commit(<span class="ot">self</span>):
        <span class="ot">self</span>.writer.commit()</code></pre>
<p>http://inversionconsulting.blogspot.in/2008/06/proe-vb-api-not-just-for-visual-basic.html</p>
<p>'Code for Auto Assembly Program Imports pfcls Imports System Imports System.IO</p>
<p>Public Class Form1 Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs_ )Handles Button1.Click Dim conn As IpfcAsyncConnection = Nothing Dim session As IpfcBaseSession Dim pat, pat1 As String Dim model As IpfcModel Dim modelDesc As IpfcModelDescriptor Dim modelDesc1 As IpfcModelDescriptor Dim i, k As Integer Dim win As IpfcWindow Dim loc As String Dim modelnames As String() = Nothing Dim asmModels As Cstringseq Dim drawingPath As String Dim drawingName, drawingName1 As String Dim drawingName2() As String Dim errMsg As String = &quot;&quot;</p>
<p>'For Assembly constraints Dim components As IpfcFeatures Dim component As IpfcComponentFeat Dim compConstraints As IpfcComponentConstraints Dim compConstraint As IpfcComponentConstraint Dim Constraint1 As IpfcComponentConstraint Dim Constraints1 As ipfcComponentConstraints Dim assembly As IpfcAssembly Dim assemblyDatums(2) As String Dim componentDatums(2) As String Dim asmReference As IpfcSelection Dim compReference As IpfcSelection Dim constraintType As String Dim componentModel As IpfcSolid Dim asmcomp As IpfcComponentFeat</p>
<p>If Not System.Diagnostics.Process.GetProcessesByName(&quot;nmsd&quot;).Length &gt; 0 Then errMsg =_ &quot;Name service is not running on the system.&quot; End If</p>
<p>If System.Environment.GetEnvironmentVariable(&quot;PRO_COMM_MSG_EXE&quot;) = &quot;&quot; Then If errMsg = &quot;&quot; Then errMsg = &quot;Environment variable 'PRO_COMM_MSG_EXE' has not been_ set.&quot; Else</p>
<p>errMsg = errMsg + Chr(13).ToString + &quot;Environment variable_ 'PRO_COMM_MSG_EXE' has not been set.&quot;</p>
<p>End If End If</p>
<p>If System.Environment.GetEnvironmentVariable(&quot;PRO_DIRECTORY&quot;) Is Nothing Then</p>
<p>If errMsg = &quot;&quot; Then errMsg = &quot;Environment variable 'PRO_DIRECTORY' has not been set.&quot; Else</p>
<p>errMsg = errMsg + Chr(13).ToString + &quot;Environment variable 'PRO_DIRECTORY' has not been set.&quot;</p>
<p>End If</p>
<p>End If 'If Services are not running Exit Application</p>
<p>If Not errMsg = &quot;&quot; Then errMsg = errMsg + Chr(13).ToString + &quot;These may lead to errors in running the application.&quot; MsgBox(errMsg, MsgBoxStyle.Critical)</p>
<p>Else 'Connect to Pro/Engineer</p>
<p>If conn Is Nothing OrElse Not conn.IsRunning Then conn = (New CCpfcAsyncConnection).Connect(Nothing, Nothing, Nothing, Nothing) session = conn.Session</p>
<p>If session Is Nothing Then Throw New Exception(&quot;Session does not exist&quot;) Else session.EraseUndisplayedModels()</p>
<p>'Directory for Pro/E Models</p>
<p>loc = &quot;d:&quot;.ToLower asmModels = session.ListFiles(&quot;*.asm&quot;, EpfcFileListOpt.EpfcFILE_LIST_LATEST, loc)</p>
<p>If asmModels.Count &lt;&gt; 0 Then</p>
<p>k = 0</p>
<p>For k = 0 To asmModels.Count - 1 drawingPath = asmModels.Item(k) drawingName = drawingPath.Substring(loc.Length) drawingName1 = drawingName.Substring(0, drawingName.Length - 4) drawingName2 = drawingName1.Split(&quot;-&quot;) pat1 = drawingName.Substring(0, 1).ToUpper &amp; &quot;SAMPLE&quot; &amp; drawingName2(1).ToUpper &amp; &quot;.prt&quot; drawingName1 = drawingName1.Substring(drawingName1.Length - 7, 7).ToUpper</p>
<p>modelDesc1 = (New CCpfcModelDescriptor).Create(0, drawingName, Nothing) session.RetrieveModel(modelDesc1) session.OpenFile(modelDesc1).Activate() model = session.CurrentModel assembly = CType(model, IpfcAssembly) modelDesc = (New CCpfcModelDescriptor).Create(1, pat1, Nothing) componentModel = session.RetrieveModel(modelDesc) pat1 = pat1.Substring(0, pat1.Length - 4) components = assembly.ListFeaturesByType(False, EpfcFeatureType.EpfcFEATTYPE_COMPONENT)</p>
<p>'Search through the models in the current assembly</p>
<p>For i = 0 To components.Count - 1 component = components.Item(i) modelDesc = component.ModelDescr</p>
<p>If modelDesc.InstanceName = pat1 Then compConstraints = component.GetConstraints() Constraints1 = New CpfcComponentConstraints asmcomp = assembly.AssembleComponent(componentModel, Nothing)</p>
<p>For j = 0 To compConstraints.Count - 1 compConstraint = compConstraints.Item(j) constraintType = constraintTypeToString(compConstraint.Type) asmReference = compConstraint.AssemblyReference compReference = compConstraint.ComponentReference</p>
<p>Select Case (constraintType)</p>
<p>Case &quot;Mate&quot; Constraint1 = (New CCpfcComponentConstraint).Create_(EpfcComponentConstraintType.EpfcASM_CONSTRAINT_MATE) Constraint1.AssemblyReference = asmReference Constraint1.ComponentReference = compReference Constraints1.Insert(Constraints1.Count, Constraint1)</p>
<p>Case &quot;Align&quot; Constraint1 = (New CCpfcComponentConstraint).Create_(EpfcComponentConstraintType.EpfcASM_CONSTRAINT_ALIGN_OFF) Constraint1.AssemblyReference = asmReference Constraint1.ComponentReference = compReference Constraints1.Insert(Constraints1.Count, Constraint1)</p>
<p>Case &quot;Align Offset&quot; Constraint1 = (New CCpfcComponentConstraint).Create_(EpfcComponentConstraintType.EpfcASM_CONSTRAINT_ALIGN) Constraint1.AssemblyReference = asmReference Constraint1.ComponentReference = compReference Constraint1.Offset = 10 Constraints1.Insert(Constraints1.Count, Constraint1)</p>
<p>End Select</p>
<p>Next</p>
<p>asmcomp.SetConstraints(Constraints1, Nothing) assembly.Regenerate(Nothing) session.GetModelWindow(assembly).Repaint() model.Save()</p>
<p>End If</p>
<p>Next</p>
<p>session.CurrentWindow.Activate() win = session.CurrentWindow Next conn.Disconnect(2)</p>
<p>End If</p>
<p>End If</p>
<p>End If</p>
<p>End If</p>
<p>End Sub</p>
<p>Private Function constraintTypeToString(ByVal type As Integer) As String</p>
<p>Select Case (type)</p>
<p>Case EpfcComponentConstraintType.EpfcASM_CONSTRAINT_MATE Return (&quot;Mate&quot;)</p>
<p>Case EpfcComponentConstraintType.EpfcASM_CONSTRAINT_MATE_OFF Return (&quot;Mate Offset&quot;)</p>
<p>Case EpfcComponentConstraintType.EpfcASM_CONSTRAINT_ALIGN Return (&quot;Align&quot;)</p>
<p>Case EpfcComponentConstraintType.EpfcASM_CONSTRAINT_ALIGN_OFF Return (&quot;Align Offset&quot;)</p>
<p>Case EpfcComponentConstraintType.EpfcASM_CONSTRAINT_INSERT Return (&quot;Insert&quot;)</p>
<p>Case EpfcComponentConstraintType.EpfcASM_CONSTRAINT_ORIENT Return (&quot;Orient&quot;)</p>
<p>Case EpfcComponentConstraintType.EpfcASM_CONSTRAINT_CSYS Return (&quot;Csys&quot;)</p>
<p>Case EpfcComponentConstraintType.EpfcASM_CONSTRAINT_TANGENT Return (&quot;Tangent&quot;)</p>
<p>Case EpfcComponentConstraintType.EpfcASM_CONSTRAINT_PNT_ON_SRF Return (&quot;Point on Surf&quot;)</p>
<p>Case EpfcComponentConstraintType.EpfcASM_CONSTRAINT_EDGE_ON_SRF Return (&quot;Edge on Surf&quot;)</p>
<p>Case EpfcComponentConstraintType.EpfcASM_CONSTRAINT_DEF_PLACEMENT Return (&quot;Default&quot;)</p>
<p>Case EpfcComponentConstraintType.EpfcASM_CONSTRAINT_SUBSTITUTE Return (&quot;Substitute&quot;)</p>
<p>Case EpfcComponentConstraintType.EpfcASM_CONSTRAINT_PNT_ON_LINE Return (&quot;Point on Line&quot;)</p>
<p>Case EpfcComponentConstraintType.EpfcASM_CONSTRAINT_FIX Return (&quot;Fix&quot;)</p>
<p>Case EpfcComponentConstraintType.EpfcASM_CONSTRAINT_AUTO Return (&quot;Auto&quot;)</p>
<p>End Select</p>
<p>Return (&quot;Unrecognized Type&quot;) End Function End Class</p>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">/*</span>
<span class="co">   HISTORY</span>
<span class="co">   </span>
<span class="co">14-NOV-02   J-03-38   $$1   JCN      Adapted from J-Link examples.</span>
<span class="co">07-MAR-03   K-01-03   $$2   JCN      UNIX support</span>

<span class="co">*/</span>

<span class="kw">function</span> <span class="fu">replaceBoltsInAssembly</span> ()
{
  <span class="kw">var</span> oldInstance = <span class="st">&quot;PHILLIPS7_8&quot;</span>;
  <span class="kw">var</span> newInstance = <span class="st">&quot;SLOT7_8&quot;</span>;
  
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);

 <span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">   Get the current assembly </span>
<span class="co"> \*--------------------------------------------------------------------*/</span>  
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  <span class="kw">var</span> assembly = <span class="ot">session</span>.<span class="fu">CurrentModel</span>;
  
  <span class="kw">if</span> (<span class="ot">assembly</span>.<span class="fu">Type</span> != <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelType&quot;</span>).<span class="fu">MDL_ASSEMBLY</span>)
    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, <span class="st">&quot;Current model is not an assembly&quot;</span>);
  
 <span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">   Get the new instance model for use in replacement</span>
<span class="co"> \*--------------------------------------------------------------------*/</span>  
  <span class="kw">var</span> bolt = <span class="ot">session</span>.<span class="fu">GetModel</span> (<span class="st">&quot;BOLT&quot;</span>, <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelType&quot;</span>).<span class="fu">MDL_PART</span>);
  
  <span class="kw">var</span> row = <span class="ot">bolt</span>.<span class="fu">GetRow</span> (newInstance);  
  
  <span class="kw">var</span> newBolt = <span class="ot">row</span>.<span class="fu">CreateInstance</span>();
  
  <span class="kw">var</span> replaceOps = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcFeatureOperations&quot;</span>);
 
 <span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">   Visit the assembly components</span>
<span class="co"> \*--------------------------------------------------------------------*/</span>               
  <span class="kw">var</span> components = <span class="ot">assembly</span>.<span class="fu">ListFeaturesByType</span> (<span class="kw">false</span>,
                        <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcFeatureType&quot;</span>).<span class="fu">FEATTYPE_COMPONENT</span>);
  
  <span class="kw">for</span> (ii = <span class="dv">0</span>; ii &lt; <span class="ot">components</span>.<span class="fu">Count</span>; ii++)
    {
      <span class="kw">var</span> component = <span class="ot">components</span>.<span class="fu">Item</span>(ii);
      
      <span class="kw">var</span> desc = <span class="ot">component</span>.<span class="fu">ModelDescr</span>;
      
      <span class="kw">if</span> (<span class="ot">desc</span>.<span class="fu">InstanceName</span> == oldInstance)
    {
      <span class="kw">var</span> replace = <span class="ot">component</span>.<span class="fu">CreateReplaceOp</span> (newBolt);
      
      <span class="ot">replaceOps</span>.<span class="fu">Append</span> (replace);
    }
    }
  
 <span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">   Carry out the replacements</span>
<span class="co"> \*--------------------------------------------------------------------*/</span>  
  <span class="ot">assembly</span>.<span class="fu">ExecuteFeatureOps</span> (replaceOps, <span class="kw">null</span>);
  
  <span class="kw">return</span>;
}


<span class="co">/*=====================================================================*\</span>
 This <span class="kw">function</span> displays each constraint of the component visually on 
 the screen, and includes a text explanation <span class="kw">for</span> each <span class="ot">constraint</span>.
\*=====================================================================*<span class="ot">/</span>

<span class="co">/*=====================================================================*\</span>
FUNCTION: highlightConstraints
PURPOSE:  Highlights and labels a component<span class="st">&#39;s constraints</span>
\*=====================================================================*<span class="ot">/</span>
<span class="kw">function</span> <span class="fu">highlightConstraints</span> ()
{
  
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);   
<span class="co">/*---------------------------------------------------------------------*\</span>
  Get the constraints <span class="kw">for</span> the <span class="ot">component</span>.
\*---------------------------------------------------------------------*<span class="ot">/</span>
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  
  <span class="ot">session</span>.<span class="ot">CurrentWindow</span>.<span class="fu">SetBrowserSize</span> (<span class="fl">0.0</span>);
  
  <span class="kw">var</span> options = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcSelectionOptions&quot;</span>).<span class="fu">Create</span> (<span class="st">&quot;membfeat&quot;</span>);
  <span class="ot">options</span>.<span class="fu">MaxNumSels</span>  = <span class="dv">1</span>;
  <span class="kw">var</span> selections = <span class="ot">session</span>.<span class="fu">Select</span> (options, <span class="kw">void</span> <span class="kw">null</span>);
  <span class="kw">if</span> (selections == <span class="kw">void</span> <span class="kw">null</span> || <span class="ot">selections</span>.<span class="fu">Count</span> == <span class="dv">0</span>)
    <span class="kw">return</span>;
  
  <span class="ot">selections</span>.<span class="fu">Item</span>(<span class="dv">0</span>).<span class="fu">UnHighlight</span>();
  
  <span class="kw">var</span> feature = <span class="ot">selections</span>.<span class="fu">Item</span> (<span class="dv">0</span>).<span class="fu">SelItem</span>;
  
  <span class="kw">if</span> (<span class="ot">feature</span>.<span class="fu">FeatType</span> != <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcFeatureType&quot;</span>).<span class="fu">FEATTYPE_COMPONENT</span>)
    <span class="kw">return</span>;
  
  <span class="kw">var</span> asmcomp = feature;
  
  <span class="kw">var</span> constrs = <span class="ot">asmcomp</span>.<span class="fu">GetConstraints</span> ();
  
  <span class="kw">if</span> (constrs == <span class="kw">void</span> <span class="kw">null</span> || <span class="ot">constrs</span>.<span class="fu">Count</span> == <span class="dv">0</span>)
    <span class="kw">return</span>;
  
  <span class="kw">for</span> (<span class="kw">var</span> i = <span class="dv">0</span>; i &lt; <span class="ot">constrs</span>.<span class="fu">Count</span>; i++)
    {
<span class="co">/*---------------------------------------------------------------------*\</span>
  Highlight the assembly reference geometry
\*---------------------------------------------------------------------*<span class="ot">/</span>
      <span class="kw">var</span> c = <span class="ot">constrs</span>.<span class="fu">Item</span> (i);
      
      <span class="kw">var</span> asmRef = <span class="ot">c</span>.<span class="fu">AssemblyReference</span>;
      
      <span class="kw">if</span> (asmRef != <span class="kw">void</span> <span class="kw">null</span>)
    <span class="ot">asmRef</span>.<span class="fu">Highlight</span> (<span class="fu">pfcCreate</span> (<span class="st">&quot;pfcStdColor&quot;</span>).<span class="fu">COLOR_ERROR</span>);

<span class="co">/*---------------------------------------------------------------------*\</span>
  Highlight the component reference geometry
\*---------------------------------------------------------------------*<span class="ot">/</span>
      <span class="kw">var</span> compRef = <span class="ot">c</span>.<span class="fu">ComponentReference</span>;
      
      <span class="kw">if</span> (compRef != <span class="kw">void</span> <span class="kw">null</span>)
    <span class="ot">compRef</span>.<span class="fu">Highlight</span> (<span class="fu">pfcCreate</span> (<span class="st">&quot;pfcStdColor&quot;</span>).<span class="fu">COLOR_WARNING</span>);
      
<span class="co">/*---------------------------------------------------------------------*\</span>
  Prepare and display the message <span class="ot">text</span>.
\*---------------------------------------------------------------------*<span class="ot">/</span>
      <span class="kw">var</span> offset = <span class="ot">c</span>.<span class="fu">Offset</span>;
      <span class="kw">var</span> offsetString = <span class="st">&quot;&quot;</span>;
      <span class="kw">if</span> (offset != <span class="kw">void</span> <span class="kw">null</span>)
    offsetString = <span class="st">&quot;, offset of &quot;</span>+offset;
      
      <span class="kw">var</span> cType  = <span class="ot">c</span>.<span class="fu">Type</span>;
      <span class="kw">var</span> cTypeString = <span class="fu">constraintTypeToString</span> (cType);
      
      <span class="fu">alert</span>  (<span class="st">&quot;Showing constraint &quot;</span> + (i<span class="dv">+1</span>) +<span class="st">&quot; of &quot;</span> + <span class="ot">constrs</span>.<span class="fu">Count</span> + <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span> + 
          cTypeString + offsetString + <span class="st">&quot;.&quot;</span>);
    
<span class="co">/*---------------------------------------------------------------------*\</span>
  Clean up the UI <span class="kw">for</span> the next constraint
\*---------------------------------------------------------------------*<span class="ot">/</span>
      <span class="kw">if</span> (asmRef != <span class="kw">void</span> <span class="kw">null</span>)
    {
      <span class="ot">asmRef</span>.<span class="fu">UnHighlight</span> ();
    }
      
      <span class="kw">if</span> (compRef != <span class="kw">void</span> <span class="kw">null</span>)
    {
      <span class="ot">compRef</span>.<span class="fu">UnHighlight</span> ();
    }
    }
}
    
<span class="co">/*=====================================================================*\</span>
FUNCTION: constraintTypeToString
PURPOSE:  Utility: convert the constraint type to a string <span class="kw">for</span> printing
\*=====================================================================*<span class="ot">/</span>
<span class="kw">function</span> <span class="fu">constraintTypeToString</span> (type <span class="co">/* pfcComponentConstraintType */</span>)
{   
  <span class="kw">var</span> constrTypeClass = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcComponentConstraintType&quot;</span>);
  <span class="kw">switch</span> (type)
    {
    <span class="kw">case</span> <span class="ot">constrTypeClass</span>.<span class="fu">ASM_CONSTRAINT_MATE</span>:
      <span class="kw">return</span> (<span class="st">&quot;(Mate)&quot;</span>);        
    <span class="kw">case</span> <span class="ot">constrTypeClass</span>.<span class="fu">ASM_CONSTRAINT_MATE_OFF</span>:
      <span class="kw">return</span> (<span class="st">&quot;(Mate Offset)&quot;</span>);     
    <span class="kw">case</span> <span class="ot">constrTypeClass</span>.<span class="fu">ASM_CONSTRAINT_ALIGN</span>:
      <span class="kw">return</span> (<span class="st">&quot;(Align)&quot;</span>);       
    <span class="kw">case</span> <span class="ot">constrTypeClass</span>.<span class="fu">ASM_CONSTRAINT_ALIGN_OFF</span>:
      <span class="kw">return</span> (<span class="st">&quot;(Align Offset)&quot;</span>);        
    <span class="kw">case</span> <span class="ot">constrTypeClass</span>.<span class="fu">ASM_CONSTRAINT_INSERT</span>:
      <span class="kw">return</span> (<span class="st">&quot;(Insert)&quot;</span>);      
    <span class="kw">case</span> <span class="ot">constrTypeClass</span>.<span class="fu">ASM_CONSTRAINT_ORIENT</span>:
      <span class="kw">return</span> (<span class="st">&quot;(Orient)&quot;</span>);      
    <span class="kw">case</span> <span class="ot">constrTypeClass</span>.<span class="fu">ASM_CONSTRAINT_CSYS</span>:
      <span class="kw">return</span> (<span class="st">&quot;(Csys)&quot;</span>);        
    <span class="kw">case</span> <span class="ot">constrTypeClass</span>.<span class="fu">ASM_CONSTRAINT_TANGENT</span>:
      <span class="kw">return</span> (<span class="st">&quot;(Tangent)&quot;</span>);     
    <span class="kw">case</span> <span class="ot">constrTypeClass</span>.<span class="fu">ASM_CONSTRAINT_PNT_ON_SRF</span>:
      <span class="kw">return</span> (<span class="st">&quot;(Point on Surf)&quot;</span>);       
    <span class="kw">case</span> <span class="ot">constrTypeClass</span>.<span class="fu">ASM_CONSTRAINT_EDGE_ON_SRF</span>:
      <span class="kw">return</span> (<span class="st">&quot;(Edge on Surf)&quot;</span>);        
    <span class="kw">case</span> <span class="ot">constrTypeClass</span>.<span class="fu">ASM_CONSTRAINT_DEF_PLACEMENT</span>:
      <span class="kw">return</span> (<span class="st">&quot;(Default)&quot;</span>);     
    <span class="kw">case</span> <span class="ot">constrTypeClass</span>.<span class="fu">ASM_CONSTRAINT_SUBSTITUTE</span>:
      <span class="kw">return</span> (<span class="st">&quot;(Substitute)&quot;</span>);      
    <span class="kw">case</span> <span class="ot">constrTypeClass</span>.<span class="fu">ASM_CONSTRAINT_PNT_ON_LINE</span>:
      <span class="kw">return</span> (<span class="st">&quot;(Point on Line)&quot;</span>);       
    <span class="kw">case</span> <span class="ot">constrTypeClass</span>.<span class="fu">ASM_CONSTRAINT_FIX</span>:
      <span class="kw">return</span> (<span class="st">&quot;(Fix)&quot;</span>);     
    <span class="kw">case</span> <span class="ot">constrTypeClass</span>.<span class="fu">ASM_CONSTRAINT_AUTO</span>:
      <span class="kw">return</span> (<span class="st">&quot;(Auto)&quot;</span>);        
    <span class="kw">default</span>:
      <span class="kw">return</span> (<span class="st">&quot;(Unrecognized Type)&quot;</span>);       
    }
}

<span class="co">/* </span>
<span class="co">   The following example demonstrates how to assemble a component into an</span>
<span class="co">   assembly, and how to constrain the component by aligning datum planes.</span>
<span class="co">   If the complete set of datum planes is not found, the function will show</span>
<span class="co">   the component constraint dialog to the user to allow them to adjust the</span>
<span class="co">   placement as they wish.</span>
<span class="co">*/</span>

<span class="co">/*=====================================================================*\</span>
FUNCTION: UserAssembleByDatums
PURPOSE:  Assemble a component by aligning named <span class="ot">datums</span>.         
\*=====================================================================*<span class="ot">/</span>
<span class="kw">function</span> <span class="fu">assembleByDatums</span> (componentFilename <span class="co">/* string as ?????.??? */</span>)
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);
  <span class="kw">var</span> interactFlag = <span class="kw">false</span>;
  <span class="kw">var</span> identityMatrix = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcMatrix3D&quot;</span>);
  <span class="kw">for</span> (<span class="kw">var</span> x = <span class="dv">0</span>; x &lt; <span class="dv">4</span>; x++)
    <span class="kw">for</span> (<span class="kw">var</span> y = <span class="dv">0</span>; y &lt; <span class="dv">4</span>; y++)
      {
    <span class="kw">if</span> (x == y)
      <span class="ot">identityMatrix</span>.<span class="fu">Set</span> (x, y, <span class="fl">1.0</span>);
    <span class="kw">else</span>
      <span class="ot">identityMatrix</span>.<span class="fu">Set</span> (x, y, <span class="fl">0.0</span>);
      }
  <span class="kw">var</span> transf = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcTransform3D&quot;</span>).<span class="fu">Create</span> (identityMatrix);
<span class="co">/*-----------------------------------------------------------------*\</span>
  Get the current assembly
\*-----------------------------------------------------------------*<span class="ot">/  </span>
<span class="ot">  var session = pfcGetProESession </span><span class="fl">()</span><span class="ot">;</span>
<span class="ot">  var model = session.CurrentModel;</span>
<span class="ot">  if </span><span class="fl">(</span><span class="ot">model == void null </span><span class="fl">||</span><span class="ot"> model.Type != pfcCreate </span><span class="fl">(</span><span class="ot">&quot;pfcModelType&quot;</span><span class="fl">)</span><span class="ot">.MDL_ASSEMBLY</span><span class="fl">)</span>
<span class="ot">    throw new Error </span><span class="fl">(</span><span class="ot">0, &quot;Current model is not an assembly.&quot;</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">  </span>
<span class="ot">  var assembly = model;</span>
<span class="ot">  </span>
<span class="ot">  var descr = </span>
<span class="ot">    pfcCreate </span><span class="fl">(</span><span class="ot">&quot;pfcModelDescriptor&quot;</span><span class="fl">)</span><span class="ot">.CreateFromFileName </span><span class="fl">(</span><span class="ot">componentFilename</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">  var componentModel = session.GetModelFromDescr </span><span class="fl">(</span><span class="ot">descr</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">  </span>
<span class="ot">  if </span><span class="fl">(</span><span class="ot">componentModel == void null</span><span class="fl">)</span>
<span class="ot">    {</span>
<span class="ot">      componentModel = session.RetrieveModel </span><span class="fl">(</span><span class="ot">descr</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">    }</span>
<span class="ot">  </span>
<span class="ot">/</span>*-----------------------------------------------------------------*\
  Set up the arrays of datum names
\*-----------------------------------------------------------------*<span class="ot">/</span>
  <span class="kw">var</span> asmDatums = <span class="kw">new</span> <span class="fu">Array</span> (<span class="st">&quot;ASM_D_FRONT&quot;</span>, <span class="st">&quot;ASM_D_TOP&quot;</span>, <span class="st">&quot;ASM_D_RIGHT&quot;</span>);
  <span class="kw">var</span> compDatums = <span class="kw">new</span> <span class="fu">Array</span> (<span class="st">&quot;COMP_D_FRONT&quot;</span>, 
                  <span class="st">&quot;COMP_D_TOP&quot;</span>, 
                  <span class="st">&quot;COMP_D_RIGHT&quot;</span>);
      
<span class="co">/*-----------------------------------------------------------------*\</span>
  Package the component initially
\*-----------------------------------------------------------------*<span class="ot">/</span>
  <span class="kw">var</span> asmcomp = <span class="ot">assembly</span>.<span class="fu">AssembleComponent</span> (componentModel,
                        transf);
  
<span class="co">/*-----------------------------------------------------------------*\</span>
  Prepare the constraints array
\*-----------------------------------------------------------------*<span class="ot">/</span>
  <span class="kw">var</span> constrs = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcComponentConstraints&quot;</span>);
  
  <span class="kw">for</span> (<span class="kw">var</span> i = <span class="dv">0</span>; i &lt; <span class="dv">3</span>; i++)
    {
<span class="co">/*-----------------------------------------------------------------*\</span>
  Find the assembly datum 
\*-----------------------------------------------------------------*<span class="ot">/</span>
      <span class="kw">var</span> asmItem = 
    <span class="ot">assembly</span>.<span class="fu">GetItemByName</span> (<span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelItemType&quot;</span>).<span class="fu">ITEM_SURFACE</span>, 
                asmDatums [i]);
      
      <span class="kw">if</span> (asmItem == <span class="kw">void</span> <span class="kw">null</span>) 
    {
      interactFlag = <span class="kw">true</span>;
      <span class="kw">continue</span>;
    }
      
<span class="co">/*-----------------------------------------------------------------*\</span>
  Find the component datum
\*-----------------------------------------------------------------*<span class="ot">/</span>
      <span class="kw">var</span> compItem = 
    <span class="ot">componentModel</span>.<span class="fu">GetItemByName</span> (<span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelItemType&quot;</span>).<span class="fu">ITEM_SURFACE</span>, 
                      compDatums [i]);
      
      <span class="kw">if</span> (compItem == <span class="kw">void</span> <span class="kw">null</span>) 
    {
      interactFlag = <span class="kw">true</span>;
      <span class="kw">continue</span>;
    }

<span class="co">/*-----------------------------------------------------------------*\</span>
  For the assembly reference, initialize a component <span class="ot">path</span>.
  This is necessary even <span class="kw">if</span> the reference geometry is <span class="kw">in</span> the <span class="ot">assembly</span>.
\*-----------------------------------------------------------------*<span class="ot">/</span>
      <span class="kw">var</span> ids = <span class="fu">pfcCreate</span> (<span class="st">&quot;intseq&quot;</span>);
      
      <span class="kw">var</span> path = <span class="fu">pfcCreate</span> (<span class="st">&quot;MpfcAssembly&quot;</span>).<span class="fu">CreateComponentPath</span> (assembly,
                                 ids);
      
<span class="co">/*-----------------------------------------------------------------*\</span>
  Allocate the references
\*-----------------------------------------------------------------*<span class="ot">/</span>
      <span class="kw">var</span> MpfcSelect = <span class="fu">pfcCreate</span> (<span class="st">&quot;MpfcSelect&quot;</span>);
      <span class="kw">var</span> asmSel = <span class="ot">MpfcSelect</span>.<span class="fu">CreateModelItemSelection</span> (asmItem, path);
      <span class="kw">var</span> compSel = <span class="ot">MpfcSelect</span>.<span class="fu">CreateModelItemSelection</span> (compItem, <span class="kw">void</span> <span class="kw">null</span>);
      
<span class="co">/*-----------------------------------------------------------------*\</span>
  Allocate and fill the <span class="ot">constraint</span>.
\*-----------------------------------------------------------------*<span class="ot">/</span>
      <span class="kw">var</span> constr = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcComponentConstraint&quot;</span>).<span class="fu">Create</span> (
                                <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcComponentConstraintType&quot;</span>).<span class="fu">ASM_CONSTRAINT_ALIGN</span>);
      
      <span class="ot">constr</span>.<span class="fu">AssemblyReference</span>  = asmSel;
      <span class="ot">constr</span>.<span class="fu">ComponentReference</span> = compSel;
      
      <span class="ot">constr</span>.<span class="fu">Attributes</span> = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcConstraintAttributes&quot;</span>).<span class="fu">Create</span> (<span class="kw">false</span>, <span class="kw">false</span>);
      
      <span class="ot">constrs</span>.<span class="fu">Append</span> (constr);
    }

<span class="co">/*-----------------------------------------------------------------*\</span>
  Set the assembly component constraints and regenerate the <span class="ot">assembly</span>.
\*-----------------------------------------------------------------*<span class="ot">/</span>
  <span class="ot">asmcomp</span>.<span class="fu">SetConstraints</span> (constrs, <span class="kw">void</span> <span class="kw">null</span>);
  
  <span class="ot">assembly</span>.<span class="fu">Regenerate</span> (<span class="kw">void</span> <span class="kw">null</span>);
  
  <span class="ot">session</span>.<span class="fu">GetModelWindow</span> (assembly).<span class="fu">Repaint</span>();

<span class="co">/*-----------------------------------------------------------------*\</span>
  If any of the expect datums was not found, prompt the user to constrain
  the <span class="kw">new</span> <span class="ot">component</span>.
\*-----------------------------------------------------------------*<span class="ot">/</span>
  <span class="kw">if</span> (interactFlag)
    {
      <span class="fu">alert</span> (<span class="st">&quot;Unable to locate all required datum references.  New component is packaged.&quot;</span>);
      <span class="ot">asmcomp</span>.<span class="fu">RedefineThroughUI</span>();
    }
}
</code></pre>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">/*</span>
<span class="co">   HISTORY</span>

<span class="co">14-NOV-02   J-03-38   $$1   JCN      Adapted from J-Link examples.</span>
<span class="co">07-MAR-03   K-01-03   $$2   JCN      UNIX support</span>

<span class="co">*/</span>

<span class="co">/*</span>
<span class="co">  The following example code shows a utility function that sets angular </span>
<span class="co">  tolerances to a specified range.   For each angular dimension in the current </span>
<span class="co">  model the function gets the dimension value and adds or subtracts the range </span>
<span class="co">  to it to get the upper and lower limits.  The function then initializes a </span>
<span class="co">  pfcDimTolLimits tolerance object and assigns it to the dimension.   The </span>
<span class="co">  function displays each shown dimension.</span>
<span class="co">*/</span>

<span class="kw">function</span> <span class="fu">setAngularToleranceToLimits</span> (range <span class="co">/* number */</span>)
{
  
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);
 <span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">   Get the current solid model </span>
<span class="co"> \*--------------------------------------------------------------------*/</span>  
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span>();
  <span class="kw">var</span> model = <span class="ot">session</span>.<span class="fu">CurrentModel</span>;
  
  <span class="kw">if</span> (model == <span class="kw">void</span> <span class="kw">null</span> || (<span class="ot">model</span>.<span class="fu">Type</span> != <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelType&quot;</span>).<span class="fu">MDL_PART</span> &amp;&amp; 
                 <span class="ot">model</span>.<span class="fu">Type</span> != <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelType&quot;</span>).<span class="fu">MDL_ASSEMBLY</span>))
    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, <span class="st">&quot;Current model is not a part or assembly.&quot;</span>);
  
            
 <span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">   Ensure that dimensions will be shown with tolerances </span>
<span class="co"> \*--------------------------------------------------------------------*/</span>  
  <span class="ot">session</span>.<span class="fu">SetConfigOption</span> (<span class="st">&quot;tol_display&quot;</span>, <span class="st">&quot;yes&quot;</span>);
    
 <span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">   List all model dimensions</span>
<span class="co"> \*--------------------------------------------------------------------*/</span>  
  <span class="kw">var</span> dimensions = <span class="ot">model</span>.<span class="fu">ListItems</span> (<span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelItemType&quot;</span>).<span class="fu">ITEM_DIMENSION</span>);
  
  <span class="kw">for</span> (<span class="kw">var</span> i = <span class="dv">0</span>;  i &lt; <span class="ot">dimensions</span>.<span class="fu">Count</span>; i++)
    {
      <span class="kw">var</span> dimension = <span class="ot">dimensions</span>.<span class="fu">Item</span> (i);

 <span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">   Check for angular dimensions</span>
<span class="co"> \*--------------------------------------------------------------------*/</span>  
      <span class="kw">var</span> dType = <span class="ot">dimension</span>.<span class="fu">DimType</span>;  <span class="co">// from class pfcBaseDimension</span>
      
      
      <span class="kw">if</span> (dType == <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcDimensionType&quot;</span>).<span class="fu">DIM_ANGULAR</span>)
    {
      
 <span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">   Assign the limits tolerance </span>
<span class="co"> \*--------------------------------------------------------------------*/</span>  
      <span class="kw">var</span> dvalue = <span class="ot">dimension</span>.<span class="fu">DimValue</span>;  <span class="co">//from class pfcBaseDimension</span>
      
      <span class="kw">var</span> upper = dvalue + range/<span class="fl">2.0</span>;
      <span class="kw">var</span> lower = dvalue - range/<span class="fl">2.0</span>;
      
      limits =  <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcDimTolLimits&quot;</span>).<span class="fu">Create</span>(upper, lower);
      
      <span class="ot">dimension</span>.<span class="fu">Tolerance</span> = limits;  <span class="co">// from class pfcDimension</span>
        
 <span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">   Display the modified dimension</span>
<span class="co"> \*--------------------------------------------------------------------*/</span>  
      <span class="kw">var</span> showInstrs = 
        <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcComponentDimensionShowInstructions&quot;</span>).<span class="fu">Create</span> (<span class="kw">void</span> <span class="kw">null</span>);
      
      <span class="ot">dimension</span>.<span class="fu">Show</span> (showInstrs);
      
    }
    }
}</code></pre>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">/*</span>

<span class="co">  HISTORY:</span>
<span class="co"> </span>
<span class="co"> 14-NOV-02   J-03-38   $$1   JCN      Adapted from J-Link examples.</span>
<span class="co"> 07-MAR-03   K-01-03   $$2   JCN      UNIX support</span>
<span class="co"> 02-Jun-03   K-01-08   $$3   JCN      Fix comparison for mouse button</span>
<span class="co">*/</span>

<span class="co">/* </span>
<span class="co">   This example demonstrates the use of mouse tracking methods to draw graphics</span>
<span class="co">   on the screen.  The static method DrawRubberbandLine prompts the user to</span>
<span class="co">   pick a screen point.  The example uses &#39;complement mode&#39; to cause the line </span>
<span class="co">   to display and erase as the user moves the mouse around the window.  </span>
<span class="co">   </span>
<span class="co">   NOTE:  This example uses the method transformPosition to convert the </span>
<span class="co">   coordinates into the 3D coordinate system of a solid model, if one is </span>
<span class="co">   displayed.</span>
<span class="co">*/</span>
<span class="kw">function</span> <span class="fu">drawRubberbandLine</span> () 
{
  
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);   
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Select the first end of the rubber band line.  Expect the user to pick with </span>
<span class="co">  the left mouse button.</span>
<span class="co">\*--------------------------------------------------------------------*/</span>      
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span>();
  
  <span class="ot">session</span>.<span class="ot">CurrentWindow</span>.<span class="fu">SetBrowserSize</span> (<span class="fl">0.0</span>);
  
  mouse = <span class="ot">session</span>.<span class="fu">UIGetNextMousePick</span> (<span class="fu">pfcCreate</span> (<span class="st">&quot;pfcMouseButton&quot;</span>).<span class="fu">MOUSE_BTN_LEFT</span>);
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Transform screen point -&gt; model location, if necessary</span>
<span class="co">\*--------------------------------------------------------------------*/</span>  
  <span class="kw">var</span> firstPos = <span class="fu">transformPosition</span> (session, <span class="ot">mouse</span>.<span class="fu">Position</span>);
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Set graphics mode to complement, so that graphics erase after use. </span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  <span class="kw">var</span> currentMode = <span class="ot">session</span>.<span class="fu">CurrentGraphicsMode</span>;
  <span class="ot">session</span>.<span class="fu">CurrentGraphicsMode</span> = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcGraphicsMode&quot;</span>).<span class="fu">DRAW_GRAPHICS_COMPLEMENT</span>;
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Get current mouse position.</span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  <span class="kw">var</span> mouse = <span class="ot">session</span>.<span class="fu">UIGetCurrentMouseStatus</span> (<span class="kw">false</span>);
  <span class="kw">while</span> (<span class="ot">mouse</span>.<span class="fu">SelectedButton</span> == <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcMouseButton&quot;</span>).<span class="fu">MouseButton_nil</span>)
    {  
      <span class="ot">session</span>.<span class="fu">SetPenPosition</span> (firstPos);
      <span class="kw">var</span> secondPos = <span class="fu">transformPosition</span> (session, <span class="ot">mouse</span>.<span class="fu">Position</span>);

<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Draw rubberband line </span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
      <span class="ot">session</span>.<span class="fu">DrawLine</span> (secondPos);
      
      mouse = <span class="ot">session</span>.<span class="fu">UIGetCurrentMouseStatus</span> (<span class="kw">false</span>);
      
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Erase previously drawn line</span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
      <span class="ot">session</span>.<span class="fu">SetPenPosition</span> (firstPos);
      <span class="ot">session</span>.<span class="fu">DrawLine</span> (secondPos);    
    }
  
  <span class="ot">session</span>.<span class="fu">CurrentGraphicsMode</span> =  currentMode;
  
  <span class="kw">return</span>;
}


<span class="co">/* This method transforms the 2D screen coordinates into </span>
<span class="co">   3D model coordinates - if necessary. */</span>
<span class="kw">function</span> <span class="fu">transformPosition</span> (s <span class="co">/* pfcSession */</span>, inPnt <span class="co">/* pfcPoint3D */</span>)
{
  <span class="kw">var</span> mdl = <span class="ot">s</span>.<span class="fu">CurrentModel</span>;
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Skip transform if not in 3D model </span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  <span class="kw">if</span> (mdl == <span class="kw">void</span> <span class="kw">null</span>)
    <span class="kw">return</span> inPnt;
  
  <span class="kw">var</span> type = <span class="ot">mdl</span>.<span class="fu">Type</span>;
  <span class="kw">var</span> modelTypeClass =  <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelType&quot;</span>);
  <span class="kw">var</span> isSolid = ((type == <span class="ot">modelTypeClass</span>.<span class="fu">MDL_PART</span>) || 
         (type == <span class="ot">modelTypeClass</span>.<span class="fu">MDL_ASSEMBLY</span>) || 
         (type == <span class="ot">modelTypeClass</span>.<span class="fu">MDL_MFG</span>));
  <span class="kw">if</span> (!isSolid)
    <span class="kw">return</span> inPnt;
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Get current view&#39;s orientation and invert it</span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  <span class="kw">var</span> currView = <span class="ot">mdl</span>.<span class="fu">GetCurrentView</span>();
  <span class="kw">var</span> invOrient = <span class="ot">currView</span>.<span class="fu">Transform</span>;
  <span class="ot">invOrient</span>.<span class="fu">Invert</span>();
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Get the point in the model csys</span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  <span class="kw">var</span> outPnt = <span class="ot">invOrient</span>.<span class="fu">TransformPoint</span> (inPnt);
  
  <span class="kw">return</span> outPnt;
}</code></pre>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">/*  </span>
<span class="co">   HISTORY</span>

<span class="co">23-JUL-07   L-01-35   $$1  SNV     Created and submitted</span>

<span class="co">*/</span>

<span class="co">/*====================================================================*\</span>
 FUNCTION : <span class="fu">placeDetailSymbol</span>() 
 PURPOSE  : This <span class="kw">function</span> creates a free instance of a symbol 
            definition <span class="kw">with</span> drawing unit heights, variable text and 
            <span class="ot">groups</span>. <span class="fu">A</span> <span class="fu">symbol</span> <span class="fu">is</span> <span class="fu">placed</span> <span class="fu">with</span> <span class="fu">no</span> <span class="fu">leaders</span> <span class="fu">at</span> <span class="fu">a</span> <span class="fu">specified</span> 
            <span class="ot">location</span>.  
\*====================================================================*<span class="ot">/</span>
<span class="kw">function</span> <span class="fu">placeDetailSymbol</span>(groupName , variableText, symHeight)
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>); 

 <span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">   Get the current drawing</span>
<span class="co"> \*--------------------------------------------------------------------*/</span>
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  <span class="kw">var</span> drawing = <span class="ot">session</span>.<span class="fu">CurrentModel</span>;

  
  <span class="kw">if</span> (<span class="ot">drawing</span>.<span class="fu">Type</span> != <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelType&quot;</span>).<span class="fu">MDL_DRAWING</span>)
    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, <span class="st">&quot;Current model is not a drawing&quot;</span>);
      
<span class="co">/*--------------------------------------------------------------------*\  </span>
<span class="co">  Retrieve the symbol definition from the system</span>
<span class="co">\*--------------------------------------------------------------------*/</span>    
  <span class="kw">var</span> symDef = <span class="ot">drawing</span>.<span class="fu">RetrieveSymbolDefinition</span> (<span class="st">&quot;detail_symbol_example&quot;</span>, 
                         <span class="st">&quot;./&quot;</span>, <span class="kw">void</span> <span class="kw">null</span>, <span class="kw">void</span> <span class="kw">null</span>);
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Select the locations for the symbol</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
  <span class="kw">var</span> browserSize = <span class="ot">session</span>.<span class="ot">CurrentWindow</span>.<span class="fu">GetBrowserSize</span>();
  <span class="ot">session</span>.<span class="ot">CurrentWindow</span>.<span class="fu">SetBrowserSize</span> (<span class="fl">0.0</span>);
  
  <span class="kw">var</span> stop = <span class="kw">false</span>;
  <span class="kw">var</span> point
  <span class="kw">while</span> (!stop)
    {
        <span class="kw">var</span> mouse = 
        <span class="ot">session</span>.<span class="fu">UIGetNextMousePick</span> (<span class="fu">pfcCreate</span> (<span class="st">&quot;pfcMouseButton&quot;</span>).<span class="fu">MouseButton_nil</span>);
          
        <span class="kw">if</span> (<span class="ot">mouse</span>.<span class="fu">SelectedButton</span> == <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcMouseButton&quot;</span>).<span class="fu">MOUSE_BTN_LEFT</span>)
        {
          point = <span class="ot">mouse</span>.<span class="fu">Position</span>;
        }
        <span class="kw">else</span>
            stop = <span class="kw">true</span>;
    }
  
    <span class="ot">session</span>.<span class="ot">CurrentWindow</span>.<span class="fu">SetBrowserSize</span> (browserSize);
 
<span class="co">/*--------------------------------------------------------------------*\  </span>
<span class="co">  Allocate the symbol instance instructions </span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  <span class="kw">var</span> instrs = 
    <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcDetailSymbolInstInstructions&quot;</span>).<span class="fu">Create</span> (symDef); 
    
<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co"> Set the symbol height in drawing units </span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  <span class="kw">if</span> (symHeight &gt; <span class="dv">0</span>)
  {
      <span class="ot">instrs</span>.<span class="fu">ScaledHeight</span> = symHeight;
  }    

<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co"> Set text to the variable text in the symbol. This will be displayed </span>
<span class="co"> instead of the text defined when creating the symbol</span>
<span class="co">\*--------------------------------------------------------------------*/</span>        
  <span class="kw">if</span> (variableText != <span class="kw">void</span> <span class="kw">null</span>)
  {
      <span class="kw">var</span> varText = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcDetailVariantText&quot;</span>).<span class="fu">Create</span>(<span class="st">&quot;VAR_TEXT&quot;</span> , variableText);
      <span class="kw">var</span> varTexts = <span class="fu">pfcCreate</span>(<span class="st">&quot;pfcDetailVariantTexts&quot;</span>);
      <span class="ot">varTexts</span>.<span class="fu">Append</span>(varText);
      
      <span class="ot">instrs</span>.<span class="fu">TextValues</span> = varTexts;
  }

<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co"> Display the groups in symbol depending on group name</span>
<span class="co">\*--------------------------------------------------------------------*/</span>        
  <span class="kw">if</span> (groupName == <span class="st">&quot;ALL&quot;</span>)
    <span class="ot">instrs</span>.<span class="fu">SetGroups</span>(<span class="fu">pfcCreate</span>(<span class="st">&quot;pfcDetailSymbolGroupOption&quot;</span>).<span class="fu">DETAIL_SYMBOL_GROUP_ALL</span> , <span class="kw">null</span>);
  <span class="kw">else</span> <span class="kw">if</span> (groupName == <span class="st">&quot;NONE&quot;</span>)
    <span class="ot">instrs</span>.<span class="fu">SetGroups</span>(<span class="fu">pfcCreate</span>(<span class="st">&quot;pfcDetailSymbolGroupOption&quot;</span>).<span class="fu">DETAIL_SYMBOL_GROUP_NONE</span> , <span class="kw">null</span>);
  <span class="kw">else</span>
  {
    <span class="kw">var</span> allGroups = <span class="ot">instrs</span>.<span class="ot">SymbolDef</span>.<span class="fu">ListSubgroups</span>();
    group = <span class="fu">getGroup</span>(allGroups , groupName );
    <span class="kw">if</span> (group != <span class="kw">void</span> <span class="kw">null</span>)
    {
        groups = <span class="fu">pfcCreate</span>(<span class="st">&quot;pfcDetailSymbolGroups&quot;</span>);
        <span class="ot">groups</span>.<span class="fu">Append</span>(group);
        <span class="ot">instrs</span>.<span class="fu">SetGroups</span> (<span class="fu">pfcCreate</span>(<span class="st">&quot;pfcDetailSymbolGroupOption&quot;</span>).<span class="fu">DETAIL_SYMBOL_GROUP_CUSTOM</span> , groups);
    }           
  }
                
<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Set the attachment structure</span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  <span class="kw">var</span> position = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcFreeAttachment&quot;</span>).<span class="fu">Create</span> (point);
  <span class="kw">var</span> allAttachments = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcDetailLeaders&quot;</span>).<span class="fu">Create</span> ();    
  <span class="ot">allAttachments</span>.<span class="fu">ItemAttachment</span> = position;
  
  <span class="ot">instrs</span>.<span class="fu">InstAttachment</span> = allAttachments;

<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Create and display the symbol </span>
<span class="co">\*--------------------------------------------------------------------*/</span>  
  <span class="kw">var</span> symInst = <span class="ot">drawing</span>.<span class="fu">CreateDetailItem</span> (instrs);
  <span class="ot">symInst</span>.<span class="fu">Show</span>();
       
}

<span class="co">/*====================================================================*\</span>
 FUNCTION : <span class="fu">getGroup</span>() 
 PURPOSE  : Return the specific group depending on the group <span class="ot">name</span>. 
\*====================================================================*<span class="ot">/    </span>
<span class="ot">function getGroup</span><span class="fl">(</span><span class="ot">groups, groupName</span><span class="fl">)</span>
<span class="ot">{</span>
<span class="ot">    var group;</span>
<span class="ot">    var groupInstrs;</span>
<span class="ot">    </span>
<span class="ot">    if </span><span class="fl">(</span><span class="ot">groups.Count &lt;=0 </span><span class="fl">)</span>
<span class="ot">    {</span>
<span class="ot">        return null;</span>
<span class="ot">    }</span>
<span class="ot">    </span>
<span class="ot">/</span>*--------------------------------------------------------------------*\    
   Loop through all the groups <span class="kw">in</span> the symbol and <span class="kw">return</span> the group <span class="kw">with</span> 
   the selected name
\*--------------------------------------------------------------------*<span class="ot">/  </span>
<span class="ot">    for</span><span class="fl">(</span><span class="ot">var i=0;i&lt;groups.Count;i</span><span class="fl">++)</span>
<span class="ot">    {</span>
<span class="ot">        group = groups.Item</span><span class="fl">(</span><span class="ot">i</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">        groupInstrs = group.GetInstructions</span><span class="fl">()</span><span class="ot">;</span>
<span class="ot">        </span>
<span class="ot">        if </span><span class="fl">(</span><span class="ot">groupInstrs.Name == groupName</span><span class="fl">)</span>
<span class="ot">            return group;           </span>
<span class="ot">    }</span>
<span class="ot">    return null;        </span>
<span class="ot">}</span></code></pre>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">/*</span>
<span class="co">   HISTORY</span>
<span class="co">   </span>
<span class="co">14-NOV-02   J-03-38   $$1   JCN      Adapted from J-Link examples.</span>
<span class="co">07-MAR-03   K-01-03   $$2   JCN      UNIX support</span>
<span class="co">08-JAN-08   L-01-42   $$3   SNV      Fix for SPR 1430116</span>
<span class="co">*/</span>

<span class="co">/*====================================================================*\</span>
FUNCTION: createDrawingFromTemplate
PURPOSE:  Create a <span class="kw">new</span> drawing using a predefined <span class="ot">template</span>.
\*====================================================================*<span class="ot">/</span>
<span class="kw">function</span> <span class="fu">createDrawingFromTemplate</span> (newDrawingName <span class="co">/* string */</span>)
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);   
  
  <span class="kw">var</span> predefinedTemplate = <span class="st">&quot;c_drawing&quot;</span>;
  
  <span class="kw">if</span> (newDrawingName == <span class="st">&quot;&quot;</span>)
    {
      <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="st">&quot;Please supply a drawing name.  Aborting...&quot;</span>);
    }
  
<span class="co">/*------------------------------------------------------------------*\</span>
  Use the current model to create the <span class="ot">drawing</span>.
\*------------------------------------------------------------------*<span class="ot">/</span>
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  <span class="kw">var</span> solid = <span class="ot">session</span>.<span class="fu">CurrentModel</span>;
  modelTypeClass = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelType&quot;</span>);
  
  <span class="kw">if</span> (solid == <span class="kw">void</span> <span class="kw">null</span> || (<span class="ot">solid</span>.<span class="fu">Type</span> != <span class="ot">modelTypeClass</span>.<span class="fu">MDL_PART</span> &amp;&amp; 
                 <span class="ot">solid</span>.<span class="fu">Type</span> != <span class="ot">modelTypeClass</span>.<span class="fu">MDL_ASSEMBLY</span>))
    {
      <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="st">&quot;Current model is not usable for new drawing.  Aborting...&quot;</span>);
    }
  
  <span class="kw">var</span> options = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcDrawingCreateOptions&quot;</span>);
  <span class="ot">options</span>.<span class="fu">Append</span> (<span class="fu">pfcCreate</span> (<span class="st">&quot;pfcDrawingCreateOption&quot;</span>).<span class="fu">DRAWINGCREATE_DISPLAY_DRAWING</span>);
  
<span class="co">/*------------------------------------------------------------------*\</span>
  Create the required <span class="ot">drawing</span>.
\*------------------------------------------------------------------*<span class="ot">/</span>
  <span class="kw">var</span> drw = <span class="ot">session</span>.<span class="fu">CreateDrawingFromTemplate</span>  (newDrawingName, 
                        predefinedTemplate,
                        <span class="ot">solid</span>.<span class="fu">Descr</span>, options);
}


<span class="co">/*====================================================================*\</span>
FUNCTION : <span class="fu">listSheets</span>() 
PURPOSE  : Command to list drawing sheet info <span class="kw">in</span> an information window
\*====================================================================*<span class="ot">/</span>
<span class="kw">function</span> <span class="fu">listSheets</span>()
{ 
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);  

<span class="co">/*--------------------------------------------------------------------*\</span>
  Open a browser window to contain the information to be displayed
\*--------------------------------------------------------------------*<span class="ot">/ </span>

<span class="ot">  var newWin = window.open </span><span class="fl">(</span><span class="ot">&#39;&#39;, &quot;_LS&quot;, &quot;scrollbars&quot;</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">  if </span><span class="fl">(</span><span class="ot">pfcIsWindows</span><span class="fl">())</span>
<span class="ot">    {</span>
<span class="ot">      newWin.resizeTo </span><span class="fl">(</span><span class="ot">300, screen.height/2</span><span class="fl">.0</span>);
      <span class="ot">newWin</span>.<span class="fu">moveTo</span> (<span class="ot">screen</span>.<span class="fu">width</span><span class="dv">-300</span>, <span class="dv">0</span>);
    }
  <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&quot;</span>);
   
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Get the current drawing</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  <span class="kw">var</span> drawing = <span class="ot">session</span>.<span class="fu">CurrentModel</span>;
  
  <span class="kw">if</span> (<span class="ot">drawing</span>.<span class="fu">Type</span> != <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelType&quot;</span>).<span class="fu">MDL_DRAWING</span>)
    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, <span class="st">&quot;Current model is not a drawing&quot;</span>);
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Get the number of sheets</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
  <span class="kw">var</span> sheets = <span class="ot">drawing</span>.<span class="fu">NumberOfSheets</span>;
  
  <span class="kw">for</span> (i = <span class="dv">1</span>; i &lt;= sheets; i++)
    {
<span class="co">/*--------------------------------------------------------------------*\</span>
  Get the drawing sheet size <span class="ot">etc</span>.
\*--------------------------------------------------------------------*<span class="ot">/</span>
      <span class="kw">var</span> info = <span class="ot">drawing</span>.<span class="fu">GetSheetData</span> (i);
      
      <span class="kw">var</span> format = <span class="ot">drawing</span>.<span class="fu">GetSheetFormat</span> (i);
      
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Print the information to the window</span>
<span class="co">\*--------------------------------------------------------------------*/</span> 

      <span class="kw">var</span> unit = <span class="st">&quot;unknown&quot;</span>;
      <span class="kw">var</span> lengthUnitClass = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcLengthUnitType&quot;</span>);
      
      <span class="kw">switch</span> (<span class="ot">info</span>.<span class="ot">Units</span>.<span class="fu">GetType</span>())
    {
    <span class="kw">case</span> <span class="ot">lengthUnitClass</span>.<span class="fu">LENGTHUNIT_INCH</span>:
      unit = <span class="st">&quot;inches&quot;</span>;
      <span class="kw">break</span>;
    <span class="kw">case</span> <span class="ot">lengthUnitClass</span>.<span class="fu">LENGTHUNIT_FOOT</span>:
      unit = <span class="st">&quot;feet&quot;</span>;
      <span class="kw">break</span>;
    <span class="kw">case</span> <span class="ot">lengthUnitClass</span>.<span class="fu">LENGTHUNIT_MM</span>:
      unit = <span class="st">&quot;mm&quot;</span>;
      <span class="kw">break</span>;
    <span class="kw">case</span> <span class="ot">lengthUnitClass</span>.<span class="fu">LENGTHUNIT_CM</span>:
      unit = <span class="st">&quot;cm&quot;</span>;
      <span class="kw">break</span>;
    <span class="kw">case</span> <span class="ot">lengthUnitClass</span>.<span class="fu">LENGTHUNIT_M</span>:
      unit = <span class="st">&quot;m&quot;</span>;
      <span class="kw">break</span>;
    <span class="kw">case</span> <span class="ot">lengthUnitClass</span>.<span class="fu">LENGTHUNIT_MCM</span>:
      unit = <span class="st">&quot;mcm&quot;</span>;
      <span class="kw">break</span>;
    }
      
      
      
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;h2&gt;Sheet &quot;</span>+ i + <span class="st">&quot;&lt;/h2&gt;&quot;</span>);
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;table&gt;&quot;</span>);
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot; &lt;tr&gt;&lt;td&gt; Width &lt;/td&gt;&lt;td&gt; &quot;</span>+ 
                   <span class="ot">info</span>.<span class="fu">Width</span> + <span class="st">&quot; &lt;/td&gt;&lt;/tr&gt; &quot;</span>);
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;  &lt;tr&gt;&lt;td&gt; Height &lt;/td&gt;&lt;td&gt; &quot;</span>+ 
                   <span class="ot">info</span>.<span class="fu">Height</span> + <span class="st">&quot; &lt;/td&gt;&lt;/tr&gt; &quot;</span>);
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot; &lt;tr&gt;&lt;td&gt; Units &lt;/td&gt;&lt;td&gt; &quot;</span>+ 
                   unit + <span class="st">&quot; &lt;/td&gt;&lt;/tr&gt; &quot;</span>);
      <span class="kw">var</span> formatName;
      <span class="kw">if</span> (format == <span class="kw">void</span> <span class="kw">null</span>)
    formatName = <span class="st">&quot;none&quot;</span>;
      <span class="kw">else</span>
    formatName = <span class="ot">format</span>.<span class="fu">FullName</span>;
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot; &lt;tr&gt;&lt;td&gt; Format &lt;/td&gt;&lt;td&gt; &quot;</span>+ 
                   formatName + <span class="st">&quot; &lt;/td&gt;&lt;/tr&gt; &quot;</span>);
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;/table&gt;&quot;</span>);
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;br&gt;&quot;</span>);
      
    }
  <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;/body&gt;&lt;/html&gt;&quot;</span>);
} 

<span class="co">/*====================================================================*\ </span>
<span class="co">FUNCTION : listViews()</span>
<span class="co">PURPOSE  : Command to list view info in an information window </span>
<span class="co">\*====================================================================*/</span>
<span class="kw">function</span> <span class="fu">listViews</span>() 
{
  
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>); 

<span class="co">/*--------------------------------------------------------------------*\</span>
     Open a browser window to contain the information to be displayed
\*--------------------------------------------------------------------*<span class="ot">/ </span>
<span class="ot">  </span>
<span class="ot">  var newWin = window.open </span><span class="fl">(</span><span class="ot">&#39;&#39;, &quot;_LV&quot;, &quot;scrollbars&quot;</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">  if </span><span class="fl">(</span><span class="ot">pfcIsWindows</span><span class="fl">())</span>
<span class="ot">    {</span>
<span class="ot">      newWin.resizeTo </span><span class="fl">(</span><span class="ot">300, screen.height/2</span><span class="fl">.0</span>);
      <span class="ot">newWin</span>.<span class="fu">moveTo</span> (<span class="ot">screen</span>.<span class="fu">width</span><span class="dv">-300</span>, <span class="dv">0</span>);
    }
  <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&quot;</span>);

<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">   Get the current drawing</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  <span class="kw">var</span> drawing = <span class="ot">session</span>.<span class="fu">CurrentModel</span>;
  
  <span class="kw">if</span> (<span class="ot">drawing</span>.<span class="fu">Type</span> != <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelType&quot;</span>).<span class="fu">MDL_DRAWING</span>)
    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, <span class="st">&quot;Current model is not a drawing&quot;</span>);
  
<span class="co">/*--------------------------------------------------------------------*\  </span>
<span class="co">  Collect the views </span>
<span class="co">\*--------------------------------------------------------------------*/</span>

  <span class="kw">var</span> views = <span class="ot">drawing</span>.<span class="fu">List2DViews</span> ();
  
  <span class="kw">for</span>(i=<span class="dv">0</span>; i&lt;<span class="ot">views</span>.<span class="fu">Count</span>; i++)
    { 
      
      <span class="kw">var</span> view = <span class="ot">views</span>.<span class="fu">Item</span> (i);

<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Get the name &amp; sheet number for this view</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
      <span class="kw">var</span> viewName = <span class="ot">view</span>.<span class="fu">Name</span>;
      <span class="kw">var</span> sheetNo = <span class="ot">view</span>.<span class="fu">GetSheetNumber</span> ();

<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Get the name of the solid that the view contains</span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
      <span class="kw">var</span> solid  = <span class="ot">view</span>.<span class="fu">GetModel</span> ();
      <span class="kw">var</span> descr = <span class="ot">solid</span>.<span class="fu">Descr</span>;
      
<span class="co">/*--------------------------------------------------------------------*\  </span>
<span class="co">  Get the outline, scale, and display state</span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
      <span class="kw">var</span> outline = <span class="ot">view</span>.<span class="fu">Outline</span>;
      <span class="kw">var</span> scale = <span class="ot">view</span>.<span class="fu">Scale</span>;
      <span class="kw">var</span> display = <span class="ot">view</span>.<span class="fu">Display</span>;
    
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Write the information to the browser window file</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
      displayStyleClass = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcDisplayStyle&quot;</span>); 
      <span class="kw">var</span> dispStyle;
      <span class="kw">switch</span>(<span class="ot">display</span>.<span class="fu">Style</span>)
    {         
    <span class="kw">case</span> <span class="ot">displayStyleClass</span>.<span class="fu">DISPSTYLE_DEFAULT</span>: 
      dispStyle = <span class="st">&quot;default&quot;</span>; 
      <span class="kw">break</span>;
    <span class="kw">case</span> <span class="ot">displayStyleClass</span>.<span class="fu">DISPSTYLE_WIREFRAME</span>: 
      dispStyle = <span class="st">&quot;wireframe&quot;</span>; 
      <span class="kw">break</span>;
    <span class="kw">case</span> <span class="ot">displayStyleClass</span>.<span class="fu">DISPSTYLE_HIDDEN_LINE</span>: 
      dispStyle = <span class="st">&quot;hidden line&quot;</span>; 
      <span class="kw">break</span>;
    <span class="kw">case</span> <span class="ot">displayStyleClass</span>.<span class="fu">DISPSTYLE_NO_HIDDEN</span>: 
      dispStyle = <span class="st">&quot;no hidden&quot;</span>;
      <span class="kw">break</span>;
    <span class="kw">case</span> <span class="ot">displayStyleClass</span>.<span class="fu">DISPSTYLE_SHADED</span>: 
      dispStyle = <span class="st">&quot;shaded&quot;</span>; 
      <span class="kw">break</span>;         
    }
      
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;h2&gt;View &quot;</span>+ viewName + <span class="st">&quot;&lt;/h2&gt;&quot;</span>);
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;table&gt;&quot;</span>);
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot; &lt;tr&gt;&lt;td&gt; Sheet &lt;/td&gt;&lt;td&gt; &quot;</span>+ 
                   sheetNo + <span class="st">&quot; &lt;/td&gt;&lt;/tr&gt; &quot;</span>);
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;  &lt;tr&gt;&lt;td&gt; Model &lt;/td&gt;&lt;td&gt; &quot;</span>+ 
                   <span class="ot">descr</span>.<span class="fu">GetFullName</span>() + <span class="st">&quot; &lt;/td&gt;&lt;/tr&gt; &quot;</span>);
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot; &lt;tr&gt;&lt;td&gt; Outline &lt;/td&gt;&lt;td&gt; &quot;</span>);
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;table&gt;&lt;tr&gt;&lt;td&gt; &lt;i&gt;Lower left:&lt;/i&gt; &lt;/td&gt;&lt;td&gt;&quot;</span>);
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="ot">outline</span>.<span class="fu">Item</span> (<span class="dv">0</span>).<span class="fu">Item</span> (<span class="dv">0</span>) + <span class="st">&quot;, &quot;</span> + 
                   <span class="ot">outline</span>.<span class="fu">Item</span> (<span class="dv">0</span>).<span class="fu">Item</span>(<span class="dv">1</span>) + <span class="st">&quot;, &quot;</span> + 
                   <span class="ot">outline</span>.<span class="fu">Item</span> (<span class="dv">0</span>).<span class="fu">Item</span>(<span class="dv">2</span>));
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt; &lt;iUpper right:&lt;/i&gt;&lt;/td&gt;&lt;td&gt;&quot;</span>);
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="ot">outline</span>.<span class="fu">Item</span> (<span class="dv">1</span>).<span class="fu">Item</span> (<span class="dv">0</span>) + <span class="st">&quot;, &quot;</span> + 
                   <span class="ot">outline</span>.<span class="fu">Item</span> (<span class="dv">1</span>).<span class="fu">Item</span>(<span class="dv">1</span>) + <span class="st">&quot;, &quot;</span> + 
                   <span class="ot">outline</span>.<span class="fu">Item</span> (<span class="dv">1</span>).<span class="fu">Item</span>(<span class="dv">2</span>));
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;&quot;</span>);
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot; &lt;tr&gt;&lt;td&gt; Scale &lt;/td&gt;&lt;td&gt; &quot;</span>+ scale + 
                   <span class="st">&quot; &lt;/td&gt;&lt;/tr&gt; &quot;</span>);
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot; &lt;tr&gt;&lt;td&gt; Display style &lt;/td&gt;&lt;td&gt; &quot;</span>+ 
                   dispStyle + <span class="st">&quot; &lt;/td&gt;&lt;/tr&gt;&quot;</span>);
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;/table&gt;&quot;</span>);
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;br&gt;&quot;</span>);
    }
  <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;/body&gt;&lt;/html&gt;&quot;</span>);
}

<span class="co">/*==================================================================*\</span>
FUNCTION: <span class="fu">drawingSolidReplace</span>()
PURPOSE:  Replaces all instance solid models <span class="kw">in</span> a drawing <span class="kw">with</span> their
          <span class="ot">generic</span>.  <span class="fu">Similar</span> <span class="fu">to</span> <span class="fu">the</span> <span class="fu">Pro</span>/ENGINEER behavior,  
          the <span class="kw">function</span> will not replace models <span class="kw">if</span> the target generic 
          model is already present <span class="kw">in</span> the <span class="ot">drawing</span>.
\*==================================================================*<span class="ot">/</span>
<span class="kw">function</span> <span class="fu">replaceModels</span>()
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>); 
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Get the current drawing</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  <span class="kw">var</span> drawing = <span class="ot">session</span>.<span class="fu">CurrentModel</span>;
  
  <span class="kw">if</span> (<span class="ot">drawing</span>.<span class="fu">Type</span> != <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelType&quot;</span>).<span class="fu">MDL_DRAWING</span>)
    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, <span class="st">&quot;Current model is not a drawing&quot;</span>);
    
<span class="co">/*------------------------------------------------------------------*\</span>
  Visit the drawing <span class="ot">models</span>.
\*------------------------------------------------------------------*<span class="ot">/</span>
  <span class="kw">var</span> solids = <span class="ot">drawing</span>.<span class="fu">ListModels</span> ();
  
<span class="co">/*------------------------------------------------------------------*\</span>
  Loop on all of the drawing <span class="ot">models</span>.
\*------------------------------------------------------------------*<span class="ot">/  </span>
<span class="ot">  for </span><span class="fl">(</span><span class="ot">i = 0; i &lt; solids.Count; i</span><span class="fl">++)</span>
<span class="ot">    {</span>
<span class="ot">      var solid = solids.Item </span><span class="fl">(</span><span class="ot">i</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">/</span>*------------------------------------------------------------------*\
  If the generic is not an instance, <span class="kw">continue</span> (Parent property 
  from <span class="kw">class</span> pfcFamilyMember)
\*------------------------------------------------------------------*<span class="ot">/ </span>
<span class="ot">      var generic = solid.Parent;</span>
<span class="ot">      </span>
<span class="ot">      if </span><span class="fl">(</span><span class="ot">generic == void null</span><span class="fl">)</span>
<span class="ot">        continue;</span>
<span class="ot">      </span>
<span class="ot">/</span>*------------------------------------------------------------------*\
  Replace all instances <span class="kw">with</span> <span class="fu">their</span> (top-level) <span class="ot">generic</span>.
\*------------------------------------------------------------------*<span class="ot">/</span>
      <span class="kw">try</span>
    {
      <span class="ot">drawing</span>.<span class="fu">ReplaceModel</span> (solid, generic, <span class="kw">true</span>);
    }
      <span class="kw">catch</span> (err)
    {
      <span class="kw">if</span> (<span class="fu">pfcGetExceptionType</span> (err) == <span class="st">&quot;pfcXToolkitFound&quot;</span>)
        ; <span class="co">// Target generic is already in drawing; do nothing</span>
      <span class="kw">else</span>
        <span class="kw">throw</span> err;
    }
    }
}

<span class="co">/*====================================================================*\ </span>
<span class="co">FUNCTION : util_solidFind()</span>
<span class="co">PURPOSE  : Utility to select a solid using the file browser and retrieve</span>
<span class="co">           it if it is not already in session.</span>
<span class="co">\*====================================================================*/</span> 
<span class="kw">function</span> <span class="fu">util_solidFind</span>(filename <span class="co">/* string &quot;????.???&quot; format */</span>)
{
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">   Find it, if its in session and return it</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  <span class="kw">var</span> mdlDescr = 
    <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelDescriptor&quot;</span>).<span class="fu">CreateFromFileName</span> (filename);
  <span class="kw">var</span> mdl = <span class="ot">session</span>.<span class="fu">GetModelFromDescr</span> (mdlDescr);
  
  <span class="kw">if</span> (mdl != <span class="kw">void</span> <span class="kw">null</span>)
    <span class="kw">return</span> mdl;
  
<span class="co">/*--------------------------------------------------------------------*\     </span>
<span class="co">  Try to retieve the solid </span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  mdl = <span class="ot">session</span>.<span class="fu">RetrieveModel</span> (mdlDescr);
  
  <span class="kw">if</span> (mdl != <span class="kw">void</span> <span class="kw">null</span>)
    <span class="kw">return</span> mdl;
  
  <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, 
           <span class="st">&quot;Model &quot;</span>+filename+<span class="st">&quot; cannot be found or retrieved.&quot;</span>);
  
  <span class="kw">return</span> <span class="kw">void</span> <span class="kw">null</span>;
}


<span class="co">/*====================================================================*\ </span>
<span class="co">FUNCTION : createSheetAndViews() </span>
<span class="co">PURPOSE  : Create a new drawing sheet with a general, and two</span>
<span class="co">           projected,views of a selected solid </span>
<span class="co">\*====================================================================*/</span> 
<span class="kw">function</span> <span class="fu">createSheetAndViews</span>(solidName <span class="co">/* string as ????.??? */</span>)
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>); 
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Get the current drawing, create a new sheet</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  <span class="kw">var</span> drawing = <span class="ot">session</span>.<span class="fu">CurrentModel</span>;
  
  <span class="kw">if</span> (<span class="ot">drawing</span>.<span class="fu">Type</span> != <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelType&quot;</span>).<span class="fu">MDL_DRAWING</span>)
    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, <span class="st">&quot;Current model is not a drawing&quot;</span>);
  
  <span class="kw">var</span> sheetNo = <span class="ot">drawing</span>.<span class="fu">AddSheet</span> ();
  <span class="ot">drawing</span>.<span class="fu">CurrentSheetNumber</span> = sheetNo;
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Find the solid model, if its in session</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
  <span class="kw">var</span> mdlDescr = 
    <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelDescriptor&quot;</span>).<span class="fu">CreateFromFileName</span> (solidName);
  <span class="kw">var</span> solidMdl = <span class="ot">session</span>.<span class="fu">GetModelFromDescr</span> (mdlDescr);
  
  <span class="kw">if</span> (solidMdl == <span class="kw">void</span> <span class="kw">null</span>)
    {
<span class="co">/*--------------------------------------------------------------------*\     </span>
<span class="co">  If its not found, try to retieve the solid model</span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
      solidMdl = <span class="ot">session</span>.<span class="fu">RetrieveModel</span> (mdlDescr);
      
      <span class="kw">if</span> (solidMdl == <span class="kw">void</span> <span class="kw">null</span>)
    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, 
             <span class="st">&quot;Model &quot;</span>+solidName+<span class="st">&quot; cannot be found or retrieved.&quot;</span>);
    }
        
<span class="co">/*--------------------------------------------------------------------*\     </span>
<span class="co">  Try to add it to the drawing</span>
<span class="co">\*--------------------------------------------------------------------*/</span>    
  <span class="kw">try</span>
    { 
      <span class="ot">drawing</span>.<span class="fu">AddModel</span> (solidMdl);
    }
  <span class="kw">catch</span> (err)
    {
      <span class="kw">if</span> (<span class="fu">pfcGetExceptionType</span> (err) == <span class="st">&quot;pfcXToolkitInUse&quot;</span>)
    ; <span class="co">// model is already in this drawing, nothing to do</span>
      <span class="kw">else</span>
    <span class="kw">throw</span> err;
    }
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Create a general view from the Z axis direction at a predefined location </span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  <span class="kw">var</span> matrix = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcMatrix3D&quot;</span>);
  <span class="kw">for</span> (i = <span class="dv">0</span>; i &lt; <span class="dv">4</span>; i++)
    <span class="kw">for</span> (j = <span class="dv">0</span>; j &lt; <span class="dv">4</span>; j++)
      {
    <span class="kw">if</span> (i == j)
      <span class="ot">matrix</span>.<span class="fu">Set</span> (i, j, <span class="fl">1.0</span>);
    <span class="kw">else</span>
      <span class="ot">matrix</span>.<span class="fu">Set</span> (i, j, <span class="fl">0.0</span>);
      }
  
  <span class="kw">var</span> transf = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcTransform3D&quot;</span>).<span class="fu">Create</span> (matrix);
  
  <span class="kw">var</span> pos = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcPoint3D&quot;</span>);
  <span class="ot">pos</span>.<span class="fu">Set</span> (<span class="dv">0</span>, <span class="fl">200.0</span>);
  <span class="ot">pos</span>.<span class="fu">Set</span> (<span class="dv">1</span>, <span class="fl">600.0</span>);
  <span class="ot">pos</span>.<span class="fu">Set</span> (<span class="dv">2</span>, <span class="fl">0.0</span>);
  
  <span class="kw">var</span> instrs = 
    <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcGeneralViewCreateInstructions&quot;</span>).<span class="fu">Create</span> (solidMdl,
                               sheetNo, pos, transf);
  
  <span class="kw">var</span> genView = <span class="ot">drawing</span>.<span class="fu">CreateView</span> (instrs);
    
<span class="co">/*--------------------------------------------------------------------*\     </span>
<span class="co">  Get the position and size of the new view </span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  <span class="kw">var</span> outline = <span class="ot">genView</span>.<span class="fu">Outline</span>;

<span class="co">/*--------------------------------------------------------------------*\     </span>
<span class="co">  Create a projected view to the right of the general view </span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  <span class="ot">pos</span>.<span class="fu">Set</span> (<span class="dv">0</span>, <span class="ot">outline</span>.<span class="fu">Item</span> (<span class="dv">1</span>).<span class="fu">Item</span> (<span class="dv">0</span>) + (<span class="ot">outline</span>.<span class="fu">Item</span>(<span class="dv">1</span>).<span class="fu">Item</span>(<span class="dv">0</span>) - 
                       <span class="ot">outline</span>.<span class="fu">Item</span> (<span class="dv">0</span>).<span class="fu">Item</span> (<span class="dv">0</span>)));
  <span class="ot">pos</span>.<span class="fu">Set</span> (<span class="dv">1</span>, (<span class="ot">outline</span>.<span class="fu">Item</span> (<span class="dv">0</span>).<span class="fu">Item</span>(<span class="dv">1</span>) + <span class="ot">outline</span>.<span class="fu">Item</span> (<span class="dv">1</span>).<span class="fu">Item</span>(<span class="dv">1</span>))/<span class="dv">2</span>);
  
  instrs = 
    <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcProjectionViewCreateInstructions&quot;</span>).<span class="fu">Create</span> (genView, 
                                  pos);
  
  <span class="ot">drawing</span>.<span class="fu">CreateView</span> (instrs);
    
<span class="co">/*--------------------------------------------------------------------*\     </span>
<span class="co">  Create a projected view below the general view </span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  <span class="ot">pos</span>.<span class="fu">Set</span> (<span class="dv">0</span>, (<span class="ot">outline</span>.<span class="fu">Item</span> (<span class="dv">0</span>).<span class="fu">Item</span>(<span class="dv">0</span>) + <span class="ot">outline</span>.<span class="fu">Item</span> (<span class="dv">1</span>).<span class="fu">Item</span>(<span class="dv">0</span>))/<span class="dv">2</span>);
  <span class="ot">pos</span>.<span class="fu">Set</span> (<span class="dv">1</span>, <span class="ot">outline</span>.<span class="fu">Item</span> (<span class="dv">0</span>).<span class="fu">Item</span> (<span class="dv">1</span>) - (<span class="ot">outline</span>.<span class="fu">Item</span>(<span class="dv">1</span>).<span class="fu">Item</span>(<span class="dv">1</span>) - 
                       <span class="ot">outline</span>.<span class="fu">Item</span> (<span class="dv">0</span>).<span class="fu">Item</span> (<span class="dv">1</span>)));
  
  instrs = 
    <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcProjectionViewCreateInstructions&quot;</span>).<span class="fu">Create</span> (genView, 
                                  pos);
    
  <span class="ot">drawing</span>.<span class="fu">CreateView</span> (instrs);
}


<span class="co">/*====================================================================*\ </span>
<span class="co">FUNCTION : lineEntityCreate() </span>
<span class="co">PURPOSE  : Utility to create a line entity between specified points </span>
<span class="co">\*====================================================================*/</span> 
<span class="kw">function</span> <span class="fu">lineEntityCreate</span>()
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>); 
  
  <span class="kw">var</span> color = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcStdColor&quot;</span>).<span class="fu">COLOR_QUILT</span>;
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Get the current drawing &amp; its background view</span>
<span class="co">\*--------------------------------------------------------------------*/</span>  
  <span class="kw">var</span> drawing = <span class="ot">session</span>.<span class="fu">CurrentModel</span>;
  
  <span class="kw">if</span> (<span class="ot">drawing</span>.<span class="fu">Type</span> != <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelType&quot;</span>).<span class="fu">MDL_DRAWING</span>)
    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, <span class="st">&quot;Current model is not a drawing&quot;</span>);
  
  <span class="kw">var</span> currSheet = <span class="ot">drawing</span>.<span class="fu">CurrentSheetNumber</span>;
  <span class="kw">var</span> view = <span class="ot">drawing</span>.<span class="fu">GetSheetBackgroundView</span> (currSheet);
 
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">   Select the endpoints of the line</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
  <span class="ot">session</span>.<span class="ot">CurrentWindow</span>.<span class="fu">SetBrowserSize</span> (<span class="fl">0.0</span>);
  
  <span class="kw">var</span> left = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcMouseButton&quot;</span>).<span class="fu">MOUSE_BTN_LEFT</span>;
  <span class="kw">var</span> mouse1 = <span class="ot">session</span>.<span class="fu">UIGetNextMousePick</span> (left);
  <span class="kw">var</span> start = <span class="ot">mouse1</span>.<span class="fu">Position</span>;
  <span class="kw">var</span> mouse2 = <span class="ot">session</span>.<span class="fu">UIGetNextMousePick</span> (left);
  <span class="kw">var</span> end = <span class="ot">mouse2</span>.<span class="fu">Position</span>;
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Allocate and initialize a curve descriptor </span>
<span class="co">\*--------------------------------------------------------------------*/</span>     
  <span class="kw">var</span> geom = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcLineDescriptor&quot;</span>).<span class="fu">Create</span> (start, end);
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Allocate data for the draft entity </span>
<span class="co">\*--------------------------------------------------------------------*/</span>     
  <span class="kw">var</span> instrs = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcDetailEntityInstructions&quot;</span>).<span class="fu">Create</span> (geom, 
                                 view);

<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Set the color to the specified Pro/ENGINEER predefined color </span>
<span class="co">\*--------------------------------------------------------------------*/</span>
  <span class="kw">var</span> rgb = <span class="ot">session</span>.<span class="fu">GetRGBFromStdColor</span> (color);
  <span class="ot">instrs</span>.<span class="fu">Color</span> = rgb;     
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Create the entity </span>
<span class="co">\*--------------------------------------------------------------------*/</span>     
  <span class="ot">drawing</span>.<span class="fu">CreateDetailItem</span> (instrs);

<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Display the entity </span>
<span class="co">\*--------------------------------------------------------------------*/</span>     
  <span class="ot">session</span>.<span class="ot">CurrentWindow</span>.<span class="fu">Repaint</span>(); 
}
 
 
<span class="co">/*====================================================================*\</span>
FUNCTION : <span class="fu">createSurfNote</span>() 
PURPOSE  : Utility to create a note that documents the surface name or <span class="ot">id</span>.
The note text will be placed at the upper right corner of the selected <span class="ot">view</span>.
\*====================================================================*<span class="ot">/</span>
<span class="kw">function</span> <span class="fu">createSurfNote</span>()
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>); 
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Get the current drawing &amp; its background view</span>
<span class="co">\*--------------------------------------------------------------------*/</span>  
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  <span class="kw">var</span> drawing = <span class="ot">session</span>.<span class="fu">CurrentModel</span>;
  
  <span class="kw">if</span> (<span class="ot">drawing</span>.<span class="fu">Type</span> != <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelType&quot;</span>).<span class="fu">MDL_DRAWING</span>)
    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, <span class="st">&quot;Current model is not a drawing&quot;</span>);
  
<span class="co">/*--------------------------------------------------------------------*\  </span>
<span class="co">  Interactively select a surface in a drawing view</span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  <span class="kw">var</span> browserSize = <span class="ot">session</span>.<span class="ot">CurrentWindow</span>.<span class="fu">GetBrowserSize</span>();
  <span class="ot">session</span>.<span class="ot">CurrentWindow</span>.<span class="fu">SetBrowserSize</span>(<span class="fl">0.0</span>);
  
  <span class="kw">var</span> options = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcSelectionOptions&quot;</span>).<span class="fu">Create</span> (<span class="st">&quot;surface&quot;</span>);
  <span class="ot">options</span>.<span class="fu">MaxNumSels</span> = <span class="dv">1</span>;
  
  <span class="kw">var</span> sels = <span class="ot">session</span>.<span class="fu">Select</span> (options, <span class="kw">void</span> <span class="kw">null</span>);
  <span class="kw">var</span> selSurf = <span class="ot">sels</span>.<span class="fu">Item</span> (<span class="dv">0</span>);
  <span class="kw">var</span> item = <span class="ot">selSurf</span>.<span class="fu">SelItem</span>;
  
  <span class="kw">var</span> name = <span class="ot">item</span>.<span class="fu">GetName</span>();
  <span class="kw">if</span> (name == <span class="kw">void</span> <span class="kw">null</span>)
    name = <span class="kw">new</span> <span class="fu">String</span> (<span class="st">&quot;Surface ID &quot;</span>+<span class="ot">item</span>.<span class="fu">Id</span>);
  
  <span class="ot">session</span>.<span class="ot">CurrentWindow</span>.<span class="fu">SetBrowserSize</span>(browserSize);
    
<span class="co">/*--------------------------------------------------------------------*\  </span>
<span class="co">  Allocate a text item, and set its properties</span>
<span class="co">\*--------------------------------------------------------------------*/</span>   
  <span class="kw">var</span> text = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcDetailText&quot;</span>).<span class="fu">Create</span> (name);
 
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Allocate a new text line, and add the text item to it</span>
<span class="co">/*--------------------------------------------------------------------*/</span> 
  <span class="kw">var</span> texts = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcDetailTexts&quot;</span>);
  <span class="ot">texts</span>.<span class="fu">Append</span> (text);
  
  <span class="kw">var</span> textLine = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcDetailTextLine&quot;</span>).<span class="fu">Create</span> (texts);
  
  <span class="kw">var</span> textLines = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcDetailTextLines&quot;</span>);
  <span class="ot">textLines</span>.<span class="fu">Append</span> (textLine);

<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Set the location of the note text </span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  <span class="kw">var</span> dwgView = <span class="ot">selSurf</span>.<span class="fu">SelView2D</span>;
  <span class="kw">var</span> outline = <span class="ot">dwgView</span>.<span class="fu">Outline</span>;
  <span class="kw">var</span> textPos = <span class="ot">outline</span>.<span class="fu">Item</span> (<span class="dv">1</span>);
  
  <span class="co">// Force the note to be slightly beyond the view outline boundary</span>
 <span class="ot">textPos</span>.<span class="fu">Set</span> (<span class="dv">0</span>, <span class="ot">textPos</span>.<span class="fu">Item</span> (<span class="dv">0</span>) + <span class="fl">0.25</span> * (<span class="ot">textPos</span>.<span class="fu">Item</span> (<span class="dv">0</span>) - 
                        <span class="ot">outline</span>.<span class="fu">Item</span> (<span class="dv">0</span>).<span class="fu">Item</span>(<span class="dv">0</span>)));
 <span class="ot">textPos</span>.<span class="fu">Set</span> (<span class="dv">1</span>, <span class="ot">textPos</span>.<span class="fu">Item</span> (<span class="dv">1</span>) + <span class="fl">0.25</span> * (<span class="ot">textPos</span>.<span class="fu">Item</span> (<span class="dv">1</span>) - 
                        <span class="ot">outline</span>.<span class="fu">Item</span> (<span class="dv">0</span>).<span class="fu">Item</span>(<span class="dv">1</span>)));
 
 <span class="kw">var</span> position = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcFreeAttachment&quot;</span>).<span class="fu">Create</span> (textPos);
 <span class="ot">position</span>.<span class="fu">View</span> = dwgView;
 
<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Set the attachment for the note leader</span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
 <span class="kw">var</span> leaderToSurf = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcParametricAttachment&quot;</span>).<span class="fu">Create</span> (selSurf);

<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Set the attachment structure</span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
 <span class="kw">var</span> allAttachments = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcDetailLeaders&quot;</span>).<span class="fu">Create</span> ();
 <span class="ot">allAttachments</span>.<span class="fu">ItemAttachment</span> = position;
 <span class="ot">allAttachments</span>.<span class="fu">Leaders</span> = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcAttachments&quot;</span>);
 <span class="ot">allAttachments</span>.<span class="ot">Leaders</span>.<span class="fu">Append</span> (leaderToSurf);
    
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Allocate a note description, and set its properties</span>
<span class="co">\*--------------------------------------------------------------------*/</span>    
 <span class="kw">var</span> instrs = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcDetailNoteInstructions&quot;</span>).<span class="fu">Create</span> (textLines);
 
 <span class="ot">instrs</span>.<span class="fu">Leader</span> = allAttachments;
   
<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Create the note</span>
<span class="co">\*--------------------------------------------------------------------*/</span>    
 <span class="kw">var</span> note = <span class="ot">drawing</span>.<span class="fu">CreateDetailItem</span> (instrs);
 
<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Display the note</span>
<span class="co">\*--------------------------------------------------------------------*/</span>  
 <span class="ot">note</span>.<span class="fu">Show</span> (); 
}

<span class="co">/*====================================================================*\</span>
 FUNCTION : <span class="fu">placeSymInst</span>() 
 PURPOSE  :  Place a CG symbol <span class="kw">with</span> no leaders at a specified location  
\*====================================================================*<span class="ot">/</span>
<span class="kw">function</span> <span class="fu">placeSymInst</span>()
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>); 
 <span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">   Get the current drawing</span>
<span class="co"> \*--------------------------------------------------------------------*/</span>
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  <span class="kw">var</span> drawing = <span class="ot">session</span>.<span class="fu">CurrentModel</span>;
  
  <span class="kw">if</span> (<span class="ot">drawing</span>.<span class="fu">Type</span> != <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelType&quot;</span>).<span class="fu">MDL_DRAWING</span>)
    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, <span class="st">&quot;Current model is not a drawing&quot;</span>);
  
<span class="co">/*--------------------------------------------------------------------*\  </span>
<span class="co">  Retrieve the symbol definition from the system</span>
<span class="co">\*--------------------------------------------------------------------*/</span>    
  <span class="kw">var</span> symDef = <span class="ot">drawing</span>.<span class="fu">RetrieveSymbolDefinition</span> (<span class="st">&quot;CG&quot;</span>, 
                         <span class="kw">void</span> <span class="kw">null</span>, <span class="kw">void</span> <span class="kw">null</span>, <span class="kw">void</span> <span class="kw">null</span>);
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Select the locations for the symbol</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
  <span class="kw">var</span> browserSize = <span class="ot">session</span>.<span class="ot">CurrentWindow</span>.<span class="fu">GetBrowserSize</span>();
  <span class="ot">session</span>.<span class="ot">CurrentWindow</span>.<span class="fu">SetBrowserSize</span> (<span class="fl">0.0</span>);
  
  <span class="kw">var</span> stop = <span class="kw">false</span>;
  <span class="kw">var</span> points = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcPoint3Ds&quot;</span>);
  <span class="kw">while</span> (!stop)
    {
      <span class="kw">var</span> mouse = 
    <span class="ot">session</span>.<span class="fu">UIGetNextMousePick</span> (<span class="fu">pfcCreate</span> (<span class="st">&quot;pfcMouseButton&quot;</span>).<span class="fu">MouseButton_nil</span>);
      
      <span class="kw">if</span> (<span class="ot">mouse</span>.<span class="fu">SelectedButton</span> == 
      <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcMouseButton&quot;</span>).<span class="fu">MOUSE_BTN_LEFT</span>)
    {
      <span class="ot">points</span>.<span class="fu">Append</span> (<span class="ot">mouse</span>.<span class="fu">Position</span>);
    }
      <span class="kw">else</span>
    stop = <span class="kw">true</span>;
    }
  
  <span class="ot">session</span>.<span class="ot">CurrentWindow</span>.<span class="fu">SetBrowserSize</span> (browserSize);
 
<span class="co">/*--------------------------------------------------------------------*\  </span>
<span class="co">  Allocate the symbol instance instructions </span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  <span class="kw">var</span> instrs = 
    <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcDetailSymbolInstInstructions&quot;</span>).<span class="fu">Create</span> (symDef); 
  <span class="kw">var</span> position = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcFreeAttachment&quot;</span>).<span class="fu">Create</span> (<span class="ot">points</span>.<span class="fu">Item</span> (<span class="dv">0</span>));
  <span class="kw">var</span> allAttachments = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcDetailLeaders&quot;</span>).<span class="fu">Create</span> ();    
  <span class="kw">for</span> (i = <span class="dv">0</span>; i &lt; <span class="ot">points</span>.<span class="fu">Count</span>; i++)
    {
      
<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Set the location of the note text </span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
      <span class="ot">position</span>.<span class="fu">AttachmentPoint</span> = <span class="ot">points</span>.<span class="fu">Item</span> (i);
      
<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Set the attachment structure</span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
      <span class="ot">allAttachments</span>.<span class="fu">ItemAttachment</span> = position;
      
      <span class="ot">instrs</span>.<span class="fu">InstAttachment</span> = allAttachments;

<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Create and display the symbol </span>
<span class="co">\*--------------------------------------------------------------------*/</span>  
      <span class="kw">var</span> symInst = <span class="ot">drawing</span>.<span class="fu">CreateDetailItem</span> (instrs);
      <span class="ot">symInst</span>.<span class="fu">Show</span>();
    }   
}
 
 
<span class="co">/*====================================================================*\</span>
 FUNCTION : <span class="fu">createGroup</span>() 
 PURPOSE  : Command to create a <span class="kw">new</span> group <span class="kw">with</span> selected items 
\*====================================================================*<span class="ot">/</span>
<span class="kw">function</span> <span class="fu">createGroup</span> (groupName <span class="co">/* string */</span>)
{ 
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);    
<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Select notes, draft entities, symbol instances </span>
<span class="co">\*--------------------------------------------------------------------*/</span>     
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  <span class="kw">var</span> selOptions = 
    <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcSelectionOptions&quot;</span>).<span class="fu">Create</span> (<span class="st">&quot;any_note,draft_ent,dtl_symbol&quot;</span>);
  <span class="kw">var</span> selections = <span class="ot">session</span>.<span class="fu">Select</span> (selOptions, <span class="kw">void</span> <span class="kw">null</span>);
  
  <span class="kw">if</span> (selections == <span class="kw">void</span> <span class="kw">null</span> || <span class="ot">selections</span>.<span class="fu">Count</span> == <span class="dv">0</span>)
    <span class="kw">return</span>;
         
<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Allocate and fill a sequence with the detail item handles </span>
<span class="co">\*--------------------------------------------------------------------*/</span>     
  <span class="kw">var</span> items = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcDetailItems&quot;</span>);
  
  <span class="kw">for</span> (i = <span class="dv">0</span>; i &lt; <span class="ot">selections</span>.<span class="fu">Count</span>; i ++)
    {
      <span class="ot">items</span>.<span class="fu">Append</span> (<span class="ot">selections</span>.<span class="fu">Item</span> (i).<span class="fu">SelItem</span>);
    }
    
<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Get the drawing which will own the group</span>
<span class="co">\*--------------------------------------------------------------------*/</span>     
  <span class="kw">var</span> drawing = <span class="ot">items</span>.<span class="fu">Item</span> (<span class="dv">0</span>).<span class="fu">DBParent</span>;

<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Allocate group data and set the group items</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
  <span class="kw">var</span> instrs = 
    <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcDetailGroupInstructions&quot;</span>).<span class="fu">Create</span> (groupName, items);
  
<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Create the group</span>
<span class="co">\*--------------------------------------------------------------------*/</span>     
  <span class="ot">drawing</span>.<span class="fu">CreateDetailItem</span> (instrs);
}

<span class="co">/*====================================================================*\</span>
FUNCTION : <span class="fu">createTableOfPoints</span>() 
PURPOSE  : Command to create a table of points
\*====================================================================*<span class="ot">/</span>
<span class="kw">function</span> <span class="fu">createTableOfPoints</span>() 
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);   
  
  <span class="kw">var</span> widths = <span class="kw">new</span> <span class="fu">Array</span> ();
  widths [<span class="dv">0</span>] = <span class="fl">8.0</span>;
  widths [<span class="dv">1</span>] = <span class="fl">10.0</span>;
  widths [<span class="dv">2</span>] = <span class="fl">10.0</span>;
  widths [<span class="dv">3</span>] = <span class="fl">10.0</span>;
   
<span class="co">/*--------------------------------------------------------------------*\</span>
  Select a coordinate <span class="ot">system</span>. <span class="fu">This</span> <span class="fu">defines</span> <span class="fu">the</span> <span class="fu">model</span> (the top one
  <span class="kw">in</span> that view), and the reference <span class="kw">for</span> the datum point <span class="ot">positions</span>.
\*--------------------------------------------------------------------*<span class="ot">/</span>
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  
  <span class="ot">session</span>.<span class="ot">CurrentWindow</span>.<span class="fu">SetBrowserSize</span> (<span class="fl">0.0</span>);
  
  <span class="kw">var</span> selOptions = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcSelectionOptions&quot;</span>).<span class="fu">Create</span>(<span class="st">&quot;csys&quot;</span>);
  <span class="ot">selOptions</span>.<span class="fu">MaxNumSels</span> = <span class="dv">1</span>;
  <span class="kw">var</span> selections = <span class="ot">session</span>.<span class="fu">Select</span> (selOptions, <span class="kw">void</span> <span class="kw">null</span>);
  
  <span class="kw">if</span> (selections == <span class="kw">void</span> <span class="kw">null</span> || <span class="ot">selections</span>.<span class="fu">Count</span> == <span class="dv">0</span>)
    <span class="kw">return</span>;
  
<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Extract the csys handle, and assembly path, and view handle.</span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  <span class="kw">var</span> selItem = <span class="ot">selections</span>.<span class="fu">Item</span> (<span class="dv">0</span>).<span class="fu">SelItem</span>;
  <span class="kw">var</span> selPath = <span class="ot">selections</span>.<span class="fu">Item</span> (<span class="dv">0</span>).<span class="fu">Path</span>;  
  <span class="kw">var</span> selView = <span class="ot">selections</span>.<span class="fu">Item</span> (<span class="dv">0</span>).<span class="fu">SelView2D</span>;
  
  <span class="kw">if</span> (selView == <span class="kw">void</span> <span class="kw">null</span>)
    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, <span class="st">&quot;Must select coordinate system from a drawing view.&quot;</span>);
  
  <span class="kw">var</span> drawing = <span class="ot">selView</span>.<span class="fu">DBParent</span>;
 
<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Extract the csys location (property CoordSys from class pfcCoordSystem)</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
  <span class="kw">var</span> csysTransf = <span class="ot">selItem</span>.<span class="fu">CoordSys</span>;
  <span class="ot">csysTransf</span>.<span class="fu">Invert</span> ();
  
<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Extract the cys name</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
  <span class="kw">var</span> csysName = <span class="ot">selItem</span>.<span class="fu">GetName</span>();    
 
<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Get the root solid, and the transform from the root to the</span>
<span class="co">  component owning the csys</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
  
  <span class="kw">var</span> asmTransf = <span class="kw">void</span> <span class="kw">null</span>;
  <span class="kw">var</span> rootSolid = <span class="ot">selItem</span>.<span class="fu">DBParent</span>;
  <span class="kw">if</span> (selPath != <span class="kw">void</span> <span class="kw">null</span>)
    {
      rootSolid = <span class="ot">selPath</span>.<span class="fu">Root</span>;
      asmTransf = <span class="ot">selPath</span>.<span class="fu">GetTransform</span>(<span class="kw">false</span>);   
    }

<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Get a list of datum points in the model</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
  
  <span class="kw">var</span> points = <span class="ot">rootSolid</span>.<span class="fu">ListItems</span> (
                    <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelItemType&quot;</span>).<span class="fu">ITEM_POINT</span>);
  
  <span class="kw">if</span> (points == <span class="kw">void</span> <span class="kw">null</span> || <span class="ot">points</span>.<span class="fu">Count</span> == <span class="dv">0</span>)
    <span class="kw">return</span>;

<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Set the table position</span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  <span class="kw">var</span> location = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcPoint3D&quot;</span>);
  <span class="ot">location</span>.<span class="fu">Set</span> (<span class="dv">0</span>, <span class="fl">200.0</span>);
  <span class="ot">location</span>.<span class="fu">Set</span> (<span class="dv">1</span>, <span class="fl">600.0</span>);
  <span class="ot">location</span>.<span class="fu">Set</span> (<span class="dv">2</span>, <span class="fl">0.0</span>);
       
<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Setup the table creation instructions</span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  <span class="kw">var</span> instrs = 
    <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcTableCreateInstructions&quot;</span>).<span class="fu">Create</span> (location);   
  
  <span class="ot">instrs</span>.<span class="fu">SizeType</span> =
    <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcTableSizeType&quot;</span>).<span class="fu">TABLESIZE_BY_NUM_CHARS</span>;
  
  <span class="kw">var</span> columnInfo = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcColumnCreateOptions&quot;</span>);
  
  <span class="kw">for</span> (i = <span class="dv">0</span>; i &lt; <span class="ot">widths</span>.<span class="fu">length</span>; i++)
    {
      <span class="kw">var</span> column = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcColumnCreateOption&quot;</span>).<span class="fu">Create</span> (
                  <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcColumnJustification&quot;</span>).<span class="fu">COL_JUSTIFY_LEFT</span>,
          widths [i]);
      <span class="ot">columnInfo</span>.<span class="fu">Append</span> (column);
    }
  <span class="ot">instrs</span>.<span class="fu">ColumnData</span> = columnInfo;
  
  <span class="kw">var</span> rowInfo = <span class="fu">pfcCreate</span> (<span class="st">&quot;realseq&quot;</span>);
  
  <span class="kw">for</span> (i = <span class="dv">0</span>; i &lt; <span class="ot">points</span>.<span class="fu">Count</span> + <span class="dv">2</span>; i++)
    {
      <span class="ot">rowInfo</span>.<span class="fu">Append</span> (<span class="fl">1.0</span>);
    }
  <span class="ot">instrs</span>.<span class="fu">RowHeights</span> = rowInfo;

<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Create the table</span>
<span class="co">\*--------------------------------------------------------------------*/</span>    
  <span class="kw">var</span> dwgTable = <span class="ot">drawing</span>.<span class="fu">CreateTable</span> (instrs);
  
<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Merge the top row cells to form the header</span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  <span class="kw">var</span> topLeft = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcTableCell&quot;</span>).<span class="fu">Create</span> (<span class="dv">1</span>, <span class="dv">1</span>);
  <span class="kw">var</span> bottomRight = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcTableCell&quot;</span>).<span class="fu">Create</span> (<span class="dv">1</span>, <span class="dv">4</span>);
  <span class="ot">dwgTable</span>.<span class="fu">MergeRegion</span> (topLeft, bottomRight, <span class="kw">void</span> <span class="kw">null</span>);

<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Write header text specifying model and csys</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
  <span class="fu">writeTextInCell</span> (dwgTable, <span class="dv">1</span>, <span class="dv">1</span>, 
           <span class="st">&quot;Datum points for &quot;</span>+<span class="ot">rootSolid</span>.<span class="fu">FileName</span> + <span class="st">&quot; w.r.t. csys &quot;</span>+csysName);    

<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Add subheadings to columns</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
  <span class="fu">writeTextInCell</span> (dwgTable, <span class="dv">2</span>, <span class="dv">1</span>, <span class="st">&quot;Point&quot;</span>);
  <span class="fu">writeTextInCell</span> (dwgTable, <span class="dv">2</span>, <span class="dv">2</span>, <span class="st">&quot;X&quot;</span>);
  <span class="fu">writeTextInCell</span> (dwgTable, <span class="dv">2</span>, <span class="dv">3</span>, <span class="st">&quot;Y&quot;</span>);
  <span class="fu">writeTextInCell</span> (dwgTable, <span class="dv">2</span>, <span class="dv">4</span>, <span class="st">&quot;Z&quot;</span>);

<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  For each datum point...</span>
<span class="co">\*--------------------------------------------------------------------*/</span>    
  <span class="kw">for</span>(p=<span class="dv">0</span>; p&lt;<span class="ot">points</span>.<span class="fu">Count</span>; p++)
    { 
      <span class="kw">var</span> point = <span class="ot">points</span>.<span class="fu">Item</span> (p);
<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Add the point name to column 1</span>
<span class="co">\*--------------------------------------------------------------------*/</span>   
      <span class="fu">writeTextInCell</span> (dwgTable, p<span class="dv">+3</span>, <span class="dv">1</span>, <span class="ot">point</span>.<span class="fu">GetName</span>());
      
<span class="co">/*--------------------------------------------------------------------*\   </span>
<span class="co"> Transform the location w.r.t to the csys</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
      <span class="kw">var</span> trfPoint = <span class="ot">point</span>.<span class="fu">Point</span>;
      <span class="kw">if</span> (asmTransf != <span class="kw">void</span> <span class="kw">null</span>)
    trfPoint = <span class="ot">asmTransf</span>.<span class="fu">TransformPoint</span> (<span class="ot">point</span>.<span class="fu">Point</span>);
      trfPoint = <span class="ot">csysTransf</span>.<span class="fu">TransformPoint</span> (trfPoint);

<span class="co">/*--------------------------------------------------------------------*\   </span>
<span class="co">  Add the XYZ to column 2,3,4</span>
<span class="co">\*--------------------------------------------------------------------*/</span>   
      <span class="fu">writeTextInCell</span> (dwgTable, p<span class="dv">+3</span>, <span class="dv">2</span>, <span class="ot">trfPoint</span>.<span class="fu">Item</span> (<span class="dv">0</span>));
      <span class="fu">writeTextInCell</span> (dwgTable, p<span class="dv">+3</span>, <span class="dv">3</span>, <span class="ot">trfPoint</span>.<span class="fu">Item</span> (<span class="dv">1</span>));
      <span class="fu">writeTextInCell</span> (dwgTable, p<span class="dv">+3</span>, <span class="dv">4</span>, <span class="ot">trfPoint</span>.<span class="fu">Item</span> (<span class="dv">2</span>));   
    }
<span class="co">/*--------------------------------------------------------------------*\  </span>
<span class="co">  Display the table</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
  <span class="ot">dwgTable</span>.<span class="fu">Display</span> ();
}
 
<span class="co">/*====================================================================*\</span>
FUNCTION : <span class="fu">writeTextInCell</span>() 
PURPOSE  : Utility to add one text line to a table cell
\*====================================================================*<span class="ot">/</span>
<span class="kw">function</span> <span class="fu">writeTextInCell</span>(table <span class="co">/* pfcTable */</span>, row <span class="co">/* integer */</span>,
             col <span class="co">/* integer */</span>, text <span class="co">/* string */</span>)
{
  <span class="kw">var</span> cell = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcTableCell&quot;</span>).<span class="fu">Create</span> (row, col);
  <span class="kw">var</span> lines = <span class="fu">pfcCreate</span> (<span class="st">&quot;stringseq&quot;</span>);
  <span class="ot">lines</span>.<span class="fu">Append</span> (text);
  <span class="ot">table</span>.<span class="fu">SetText</span> (cell, lines);
}

<span class="co">/*====================================================================*\</span>
FUNCTION: <span class="fu">createPointDims</span>() 
PURPOSE  : Command to create dimensions to each of the models<span class="st">&#39; datum points</span>
\*====================================================================*<span class="ot">/</span>
<span class="kw">function</span> <span class="fu">createPointDims</span>()
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);   
  <span class="kw">var</span> hBaseline = <span class="kw">void</span> <span class="kw">null</span>;
  <span class="kw">var</span> vBaseline = <span class="kw">void</span> <span class="kw">null</span>;

<span class="co">/*--------------------------------------------------------------------*\</span>
  Select a coordinate <span class="ot">system</span>. <span class="fu">This</span> <span class="fu">defines</span> <span class="fu">the</span> <span class="fu">model</span> (the top one
  <span class="kw">in</span> that view), and the common attachments <span class="kw">for</span> the dimensions
\*--------------------------------------------------------------------*<span class="ot">/</span>
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  
  <span class="ot">session</span>.<span class="ot">CurrentWindow</span>.<span class="fu">SetBrowserSize</span> (<span class="fl">0.0</span>);
  
  <span class="kw">var</span> selOptions = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcSelectionOptions&quot;</span>).<span class="fu">Create</span>(<span class="st">&quot;csys&quot;</span>);
  <span class="ot">selOptions</span>.<span class="fu">MaxNumSels</span> = <span class="dv">1</span>;
  <span class="kw">var</span> selections = <span class="ot">session</span>.<span class="fu">Select</span> (selOptions, <span class="kw">void</span> <span class="kw">null</span>);
  
  <span class="kw">if</span> (selections == <span class="kw">void</span> <span class="kw">null</span> || <span class="ot">selections</span>.<span class="fu">Count</span> == <span class="dv">0</span>)
    <span class="kw">return</span>;
        
<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Extract the csys handle, and assembly path, and view handle.</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
  <span class="kw">var</span> csysSel = <span class="ot">selections</span>.<span class="fu">Item</span> (<span class="dv">0</span>);
  <span class="kw">var</span> selItem = <span class="ot">csysSel</span>.<span class="fu">SelItem</span>;
  <span class="kw">var</span> selPath = <span class="ot">csysSel</span>.<span class="fu">Path</span>;  
  <span class="kw">var</span> selView = <span class="ot">csysSel</span>.<span class="fu">SelView2D</span>;
  <span class="kw">var</span> selPos = <span class="ot">csysSel</span>.<span class="fu">Point</span>;
  
  <span class="kw">if</span> (selView == <span class="kw">void</span> <span class="kw">null</span>)
    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, <span class="st">&quot;Must select coordinate system from a drawing view.&quot;</span>);
  
  <span class="kw">var</span> drawing = <span class="ot">selView</span>.<span class="fu">DBParent</span>;
    
<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Get the root solid, and the transform from the root to the</span>
<span class="co">  component owning the csys</span>
<span class="co">\*--------------------------------------------------------------------*/</span>

  <span class="kw">var</span> asmTransf = <span class="kw">void</span> <span class="kw">null</span>;
  <span class="kw">var</span> rootSolid = <span class="ot">selItem</span>.<span class="fu">DBParent</span>;
  <span class="kw">if</span> (selPath != <span class="kw">null</span>)
    {
      rootSolid = <span class="ot">selPath</span>.<span class="fu">Root</span>;
      asmTransf = <span class="ot">selPath</span>.<span class="fu">GetTransform</span>(<span class="kw">true</span>);   
    }
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Get a list of datum points in the model</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
  
  <span class="kw">var</span> points = 
    <span class="ot">rootSolid</span>.<span class="fu">ListItems</span> (<span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelItemType&quot;</span>).<span class="fu">ITEM_POINT</span>);
  
  <span class="kw">if</span> (points == <span class="kw">void</span> <span class="kw">null</span> || <span class="ot">points</span>.<span class="fu">Count</span> == <span class="dv">0</span>)
    <span class="kw">return</span>;
  
<span class="co">/*--------------------------------------------------------------------*\</span>
  Calculate where the csys is located on the drawing
\*--------------------------------------------------------------------*<span class="ot">/ </span>
<span class="ot">  </span>
<span class="ot">  var csysPos = selPos;</span>
<span class="ot">  if </span><span class="fl">(</span><span class="ot">asmTransf != void null</span><span class="fl">)</span>
<span class="ot">    {</span>
<span class="ot">      csysPos = asmTransf.TransformPoint </span><span class="fl">(</span><span class="ot">selPos</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">    }</span>
<span class="ot">  var viewTransf = selView.GetTransform</span><span class="fl">()</span><span class="ot">;</span>
<span class="ot">  csysPos = viewTransf.TransformPoint </span><span class="fl">(</span><span class="ot">csysPos</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">  </span>
<span class="ot">  var csys3DPos = pfcCreate </span><span class="fl">(</span><span class="ot">&quot;pfcVector2D&quot;</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">  </span>
<span class="ot">  csys3DPos.Set </span><span class="fl">(</span><span class="ot">0, csysPos.Item </span><span class="fl">(</span><span class="ot">0</span><span class="fl">))</span><span class="ot">;</span>
<span class="ot">  csys3DPos.Set </span><span class="fl">(</span><span class="ot">1, csysPos.Item </span><span class="fl">(</span><span class="ot">1</span><span class="fl">))</span><span class="ot">;  </span>
<span class="ot">  </span>
<span class="ot">/</span>*--------------------------------------------------------------------*\    
  Get the view outline
\*--------------------------------------------------------------------*<span class="ot">/    </span>
<span class="ot">  var outline = selView.Outline;</span>
<span class="ot">  </span>
<span class="ot">/</span>*--------------------------------------------------------------------*\    
  Allocate the attachment arrays
\*--------------------------------------------------------------------*<span class="ot">/    </span>
<span class="ot">  var senses = pfcCreate </span><span class="fl">(</span><span class="ot">&quot;pfcDimensionSenses&quot;</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">  var attachments = pfcCreate </span><span class="fl">(</span><span class="ot">&quot;pfcSelections&quot;</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">    </span>
<span class="ot">/</span>*--------------------------------------------------------------------*\    
  For each datum <span class="ot">point</span>...
\*--------------------------------------------------------------------*<span class="ot">/    </span>
<span class="ot">  for</span><span class="fl">(</span><span class="ot">var p=0; p &lt;points.Count; p</span><span class="fl">++)</span>
<span class="ot">    {</span>
<span class="ot">      </span>
<span class="ot">/</span>*--------------------------------------------------------------------*\  
  Calculate the position of the point on the drawing
\*--------------------------------------------------------------------*<span class="ot">/ </span>
<span class="ot">      var point = points.Item </span><span class="fl">(</span><span class="ot">p</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">      var pntPos = point.Point;</span>
<span class="ot">      </span>
<span class="ot">      pntPos = viewTransf.TransformPoint </span><span class="fl">(</span><span class="ot">pntPos</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">      </span>
<span class="ot">/</span>*--------------------------------------------------------------------*\  
  Set up the <span class="st">&quot;sense&quot;</span> information
\*--------------------------------------------------------------------*<span class="ot">/  </span>
<span class="ot">      var sense1 = pfcCreate </span><span class="fl">(</span><span class="ot">&quot;pfcPointDimensionSense&quot;</span><span class="fl">)</span><span class="ot">.Create </span><span class="fl">(</span>
<span class="ot">            pfcCreate </span><span class="fl">(</span><span class="ot">&quot;pfcDimensionPointType&quot;</span><span class="fl">)</span><span class="ot">.DIMPOINT_CENTER</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">      senses.Set </span><span class="fl">(</span><span class="ot">0, sense1</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">      var sense2 = pfcCreate </span><span class="fl">(</span><span class="ot">&quot;pfcPointDimensionSense&quot;</span><span class="fl">)</span><span class="ot">.Create </span><span class="fl">(</span>
<span class="ot">            pfcCreate </span><span class="fl">(</span><span class="ot">&quot;pfcDimensionPointType&quot;</span><span class="fl">)</span><span class="ot">.DIMPOINT_CENTER</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">      senses.Set </span><span class="fl">(</span><span class="ot">1, sense2</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">        </span>
<span class="ot">/</span>*--------------------------------------------------------------------*\ 
  Set the attachment information
\*--------------------------------------------------------------------*<span class="ot">/</span>
      <span class="kw">var</span> pntSel = 
    <span class="fu">pfcCreate</span> (<span class="st">&quot;MpfcSelect&quot;</span>).<span class="fu">CreateModelItemSelection</span> (point, 
                               <span class="kw">void</span> <span class="kw">null</span>);
      <span class="ot">pntSel</span>.<span class="fu">SelView2D</span> = selView;
      <span class="ot">attachments</span>.<span class="fu">Set</span> (<span class="dv">0</span>, pntSel);
      <span class="ot">attachments</span>.<span class="fu">Set</span> (<span class="dv">1</span>, csysSel);
        
<span class="co">/*--------------------------------------------------------------------*\  </span>
<span class="co">  Calculate the dim position to be just to the left of the</span>
<span class="co">  drawing view, midway between the point and csys</span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
      <span class="kw">var</span> dimPos = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcVector2D&quot;</span>);
      <span class="ot">dimPos</span>.<span class="fu">Set</span> (<span class="dv">0</span>, <span class="ot">outline</span>.<span class="fu">Item</span> (<span class="dv">0</span>).<span class="fu">Item</span> (<span class="dv">0</span>) - <span class="fl">20.0</span>);
      <span class="ot">dimPos</span>.<span class="fu">Set</span> (<span class="dv">1</span>, (<span class="ot">csysPos</span>.<span class="fu">Item</span> (<span class="dv">1</span>) + <span class="ot">pntPos</span>.<span class="fu">Item</span> (<span class="dv">1</span>))/<span class="fl">2.0</span>);
        
<span class="co">/*--------------------------------------------------------------------*\  </span>
<span class="co">  Create and display the dimension</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
      <span class="kw">var</span> createInstrs = 
    <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcDrawingDimCreateInstructions&quot;</span>).<span class="fu">Create</span> (attachments, 
                                  senses,
                                  dimPos, 
                                  <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcOrientationHint&quot;</span>).<span class="fu">ORIENTHINT_VERTICAL</span>);
      <span class="kw">var</span> dim = <span class="ot">drawing</span>.<span class="fu">CreateDrawingDimension</span> (createInstrs);
      
      <span class="kw">var</span> showInstrs =
    <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcDrawingDimensionShowInstructions&quot;</span>).<span class="fu">Create</span> (selView, 
                                                                    <span class="kw">void</span> <span class="kw">null</span>);
      <span class="ot">dim</span>.<span class="fu">Show</span> (showInstrs);
      
<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  If this is the first vertical dim, create an ordinate base</span>
<span class="co">  line from it, else just convert it to ordinate</span>
<span class="co">\*--------------------------------------------------------------------*/</span>  
      <span class="kw">if</span>(p==<span class="dv">0</span>)
    {
      vBaseline = <span class="ot">dim</span>.<span class="fu">ConvertToBaseline</span> (csys3DPos);
    }
      
      <span class="kw">else</span>
    <span class="ot">dim</span>.<span class="fu">ConvertToOrdinate</span> (vBaseline);
            
<span class="co">/*--------------------------------------------------------------------*\   </span>
<span class="co">  Set this dimension to be horizontal</span>
<span class="co">\*--------------------------------------------------------------------*/</span>   
      <span class="ot">createInstrs</span>.<span class="fu">OrientationHint</span> =
    <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcOrientationHint&quot;</span>).<span class="fu">ORIENTHINT_HORIZONTAL</span>;
<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Calculate the dim position to be just to the bottom of the</span>
<span class="co">  drawing view, midway between the point and csys</span>
<span class="co">\*--------------------------------------------------------------------*/</span>   
      <span class="ot">dimPos</span>.<span class="fu">Set</span> (<span class="dv">0</span>, (<span class="ot">csysPos</span>.<span class="fu">Item</span> (<span class="dv">0</span>) + <span class="ot">pntPos</span>.<span class="fu">Item</span> (<span class="dv">0</span>))/<span class="fl">2.0</span>);
      <span class="ot">dimPos</span>.<span class="fu">Set</span> (<span class="dv">1</span>, <span class="ot">outline</span>.<span class="fu">Item</span> (<span class="dv">1</span>).<span class="fu">Item</span> (<span class="dv">1</span>) - <span class="fl">20.0</span>);
      
      <span class="ot">createInstrs</span>.<span class="fu">TextLocation</span> = dimPos;
      
<span class="co">/*--------------------------------------------------------------------*\    </span>
<span class="co">  Create and display the dimension</span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
      dim = <span class="ot">drawing</span>.<span class="fu">CreateDrawingDimension</span> (createInstrs);
      <span class="ot">dim</span>.<span class="fu">Show</span> (showInstrs);
      
<span class="co">/*--------------------------------------------------------------------*\     </span>
<span class="co">  If this is the first horizontal dim, create an ordinate base line</span>
<span class="co">  from it, else just convert it to ordinate</span>
<span class="co">\*--------------------------------------------------------------------*/</span>   
      <span class="kw">if</span>(p==<span class="dv">0</span>)
    {
      hBaseline = <span class="ot">dim</span>.<span class="fu">ConvertToBaseline</span> (csys3DPos);
    }
      
      <span class="kw">else</span>
    <span class="ot">dim</span>.<span class="fu">ConvertToOrdinate</span> (hBaseline);
      
    }
}</code></pre>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">/*</span>
<span class="co">   HISTORY</span>
<span class="co">   </span>
<span class="co">14-NOV-02   J-03-38   $$1   JCN      Adapted from J-Link examples.</span>
<span class="co">07-MAR-03   K-01-03   $$2   JCN      UNIX support</span>
<span class="co">*/</span>

<span class="co">/*====================================================================*\</span>
FUNCTION: addHoleDiameterColumns
PURPOSE:  Add all hole diameters to the family table of a <span class="ot">model</span>.
\*====================================================================*<span class="ot">/</span>
<span class="kw">function</span> <span class="fu">addHoleDiameterColumns</span> ()
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);
  
<span class="co">/*------------------------------------------------------------------*\</span>
  Use the current solid <span class="ot">model</span>.
\*------------------------------------------------------------------*<span class="ot">/</span>
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  <span class="kw">var</span> solid = <span class="ot">session</span>.<span class="fu">CurrentModel</span>;
  modelTypeClass = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelType&quot;</span>);
  
  <span class="kw">if</span> (solid == <span class="kw">void</span> <span class="kw">null</span> || (<span class="ot">solid</span>.<span class="fu">Type</span> != <span class="ot">modelTypeClass</span>.<span class="fu">MDL_PART</span> &amp;&amp; 
                 <span class="ot">solid</span>.<span class="fu">Type</span> != <span class="ot">modelTypeClass</span>.<span class="fu">MDL_ASSEMBLY</span>))
    {
      <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span>  (<span class="dv">0</span>, <span class="st">&quot;Current model is not a part or assembly.&quot;</span>);
    }
     
<span class="co">/*------------------------------------------------------------------*\</span>
  List all holes <span class="kw">in</span> the solid model
\*------------------------------------------------------------------*<span class="ot">/ </span>
<span class="ot">  var holeFeatures = solid.ListFeaturesByType </span><span class="fl">(</span><span class="ot">true, </span>
<span class="ot">         pfcCreate </span><span class="fl">(</span><span class="ot">&quot;pfcFeatureType&quot;</span><span class="fl">)</span><span class="ot">.FEATTYPE_HOLE</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">  for </span><span class="fl">(</span><span class="ot">var ii =0; ii &lt; holeFeatures.Count; ii</span><span class="fl">++)</span>
<span class="ot">    {</span>
<span class="ot">      var holeFeat = holeFeatures.Item</span><span class="fl">(</span><span class="ot">ii</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">      </span>
<span class="ot">/</span>*------------------------------------------------------------------*\
  List all dimensions <span class="kw">in</span> the feature 
\*------------------------------------------------------------------*<span class="ot">/</span>
      dimensions = 
    <span class="ot">holeFeat</span>.<span class="fu">ListSubItems</span>(<span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelItemType&quot;</span>).<span class="fu">ITEM_DIMENSION</span>);
      
      <span class="kw">for</span> (<span class="kw">var</span> jj = <span class="dv">0</span>; jj &lt; <span class="ot">dimensions</span>.<span class="fu">Count</span>; jj++)
    {
      <span class="kw">var</span> dim = <span class="ot">dimensions</span>.<span class="fu">Item</span>(jj);
      
<span class="co">/*------------------------------------------------------------------*\</span>
  Determine <span class="kw">if</span> the dimension is a diameter dimension
\*------------------------------------------------------------------*<span class="ot">/          </span>
<span class="ot">      if </span><span class="fl">(</span><span class="ot">dim.DimType == pfcCreate </span><span class="fl">(</span><span class="ot">&quot;pfcDimensionType&quot;</span><span class="fl">)</span><span class="ot">.DIM_DIAMETER</span><span class="fl">)</span><span class="ot"> </span>
<span class="ot">        {</span>
<span class="ot">/</span>*------------------------------------------------------------------*\
  Create the family table <span class="fu">column</span> (from pfcFamilyMember <span class="kw">class</span>)
\*------------------------------------------------------------------*<span class="ot">/            </span>
<span class="ot">          var dimColumn = solid.CreateDimensionColumn</span><span class="fl">(</span><span class="ot">dim</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">/</span>*------------------------------------------------------------------*\
  Add the column to the family <span class="ot">table</span>.  <span class="fu">Second</span> <span class="fu">argument</span> <span class="fu">could</span> <span class="fu">be</span>
  a sequence of pfcParamValues to use <span class="kw">for</span> each family table <span class="ot">instance</span>.
\*------------------------------------------------------------------*<span class="ot">/        </span>
<span class="ot">          solid.AddColumn</span><span class="fl">(</span><span class="ot">dimColumn, void null</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">        }</span>
<span class="ot">    }</span>
<span class="ot">    }</span>
<span class="ot">}</span></code></pre>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">/*</span>
<span class="co">  HISTORY</span>
<span class="co">  </span>
<span class="co">  14-NOV-02   J-03-38   $$1   JCN      Adapted from J-Link examples.</span>
<span class="co">  07-MAR-03   K-01-03   $$2   JCN      UNIX support</span>
<span class="co">  09-APR-09   L-03-29   $$3   SRV      Remvng Enum:pfcIntfCATIA </span>
<span class="co">  02-Oct-09   L-05-10   $$4 tshmeleva  Removed pfcIntfPDGS</span>
<span class="co">*/</span>

<span class="co">/*</span>
<span class="co">  This function will return a Feature object when provided with a solid</span>
<span class="co">  a coordinate system name and an import feature&#39;s filename. The method</span>
<span class="co">  find the coordinate system in the model, sets the Import Feature Attributes,</span>
<span class="co">  and creates the Import Feature. Then the Feature is returned.</span>
<span class="co">*/</span>
<span class="kw">function</span> <span class="fu">createImportFeatureFromDataFile</span> (fileType <span class="co">/* string */</span>, 
                      fileName <span class="co">/* string */</span>,
                      csysName <span class="co">/* string */</span>) 
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);
  
  <span class="kw">var</span> fileClass = <span class="kw">void</span> <span class="kw">null</span>;
  
  <span class="kw">if</span> (fileType == <span class="st">&quot;Neutral&quot;</span>)
    fileClass = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcIntfNeutralFile&quot;</span>);
  <span class="kw">else</span> <span class="kw">if</span> (fileType == <span class="st">&quot;IGES&quot;</span>)
    fileClass = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcIntfIges&quot;</span>);
  <span class="kw">else</span> <span class="kw">if</span> (fileType == <span class="st">&quot;SET&quot;</span>)
    fileClass = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcIntfSet&quot;</span>);
  <span class="kw">else</span> <span class="kw">if</span> (fileType == <span class="st">&quot;STEP&quot;</span>)
    fileClass = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcIntfStep&quot;</span>);
  <span class="kw">else</span> <span class="kw">if</span> (fileType == <span class="st">&quot;VDA&quot;</span>)
    fileClass = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcIntfVDA&quot;</span>);
  <span class="kw">else</span>
    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, <span class="st">&quot;Unrecognized file type&quot;</span>);
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Get the current part </span>
<span class="co">\*--------------------------------------------------------------------*/</span>  
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  <span class="kw">var</span> solid = <span class="ot">session</span>.<span class="fu">CurrentModel</span>;
  
  <span class="kw">if</span> (<span class="ot">solid</span>.<span class="fu">Type</span> != <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelType&quot;</span>).<span class="fu">MDL_PART</span>)
    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, <span class="st">&quot;Current model is not an assembly&quot;</span>);

<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Find the indicated coordinate system</span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  <span class="kw">var</span> cSystem = <span class="ot">solid</span>.<span class="fu">GetItemByName</span> (<span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelItemType&quot;</span>).<span class="fu">ITEM_COORD_SYS</span>, 
                     csysName);
  <span class="kw">if</span> (cSystem == <span class="kw">void</span> <span class="kw">null</span>)
    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, <span class="st">&quot;Couldn&#39;t find named coordinate system.&quot;</span>);

<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Prepare the import feature instructions classes and create the feature</span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  <span class="kw">var</span> dataSource = <span class="ot">fileClass</span>.<span class="fu">Create</span>(fileName);
  <span class="kw">var</span> featAttr = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcImportFeatAttr&quot;</span>).<span class="fu">Create</span>();
  <span class="ot">featAttr</span>.<span class="fu">JoinSurfs</span> = <span class="kw">true</span>;
  <span class="ot">featAttr</span>.<span class="fu">MakeSolid</span> = <span class="kw">true</span>;
  <span class="ot">featAttr</span>.<span class="fu">Operation</span> = <span class="fu">pfcCreate</span>(<span class="st">&quot;pfcOperationType&quot;</span>).<span class="fu">ADD_OPERATION</span>;
  
  <span class="kw">var</span> importFeature = <span class="ot">solid</span>.<span class="fu">CreateImportFeat</span>(dataSource, cSystem, featAttr);
  
  <span class="kw">return</span> importFeature;
}
</code></pre>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">/*</span>
<span class="co">   HISTORY</span>

<span class="co">14-NOV-02   J-03-38   $$1   JCN      Adapted from J-Link examples.</span>
<span class="co">07-MAR-03   K-01-03   $$2   JCN      UNIX support</span>
<span class="co">*/</span>

<span class="co">/*</span>
<span class="co">   This method allows a user to evaluate the assembly for a presence of any</span>
<span class="co">   interferences. Upon finding one, this method will highlight the interfering</span>
<span class="co">   surfaces, compute and highlight the interference volume.</span>
<span class="co">*/</span>
<span class="kw">function</span> <span class="fu">showInterferences</span>()
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);

<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Get the current assembly </span>
<span class="co">\*--------------------------------------------------------------------*/</span>  
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  <span class="kw">var</span> assembly = <span class="ot">session</span>.<span class="fu">CurrentModel</span>;
  
  <span class="kw">if</span> (<span class="ot">assembly</span>.<span class="fu">Type</span> != <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelType&quot;</span>).<span class="fu">MDL_ASSEMBLY</span>)
    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, <span class="st">&quot;Current model is not an assembly&quot;</span>);
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Calculate the assembly interference</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
  <span class="kw">var</span> gblEval = 
    <span class="fu">pfcCreate</span> (<span class="st">&quot;MpfcInterference&quot;</span>).<span class="fu">CreateGlobalEvaluator</span>(assembly);
  
  <span class="kw">var</span> gblInters = <span class="ot">gblEval</span>.<span class="fu">ComputeGlobalInterference</span>(<span class="kw">true</span>);
  
  <span class="kw">if</span> (gblInters != <span class="kw">void</span> <span class="kw">null</span>)
    {
      <span class="kw">var</span> size = <span class="ot">gblInters</span>.<span class="fu">Count</span>;
      
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  For each interference object display the interfering surfaces</span>
<span class="co">  and compute the interference volume</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
      <span class="ot">session</span>.<span class="ot">CurrentWindow</span>.<span class="fu">SetBrowserSize</span> (<span class="fl">0.0</span>);
      <span class="ot">session</span>.<span class="ot">CurrentWindow</span>.<span class="fu">Repaint</span>();
      <span class="fu">alert</span> (<span class="st">&quot;Interferences detected, highlighting each instance.&quot;</span>);
      <span class="kw">for</span> (<span class="kw">var</span> i = <span class="dv">0</span>; i &lt; size; i++)
    {
      <span class="kw">var</span> gblInter = <span class="ot">gblInters</span>.<span class="fu">Item</span> (i);
      
      <span class="kw">var</span> selectPair = <span class="ot">gblInter</span>.<span class="fu">SelParts</span>;
      <span class="kw">var</span> sel1 = <span class="ot">selectPair</span>.<span class="fu">Sel1</span>;
      <span class="kw">var</span> sel2 = <span class="ot">selectPair</span>.<span class="fu">Sel2</span>;
      <span class="ot">sel1</span>.<span class="fu">Highlight</span>(<span class="fu">pfcCreate</span> (<span class="st">&quot;pfcStdColor&quot;</span>).<span class="fu">COLOR_HIGHLIGHT</span>);
      <span class="ot">sel2</span>.<span class="fu">Highlight</span>(<span class="fu">pfcCreate</span> (<span class="st">&quot;pfcStdColor&quot;</span>).<span class="fu">COLOR_HIGHLIGHT</span>);
      
      <span class="kw">var</span> vol = <span class="ot">gblInter</span>.<span class="fu">Volume</span>;
      <span class="kw">var</span> totalVolume = <span class="ot">vol</span>.<span class="fu">ComputeVolume</span>();
      <span class="ot">vol</span>.<span class="fu">Highlight</span>(<span class="fu">pfcCreate</span> (<span class="st">&quot;pfcStdColor&quot;</span>).<span class="fu">COLOR_PREHIGHLIGHT</span>);
      <span class="fu">alert</span> (<span class="st">&quot;Interference &quot;</span> + (i + <span class="dv">1</span>) + <span class="st">&quot; = &quot;</span> + totalVolume);
      
      <span class="ot">sel1</span>.<span class="fu">UnHighlight</span>();
      <span class="ot">sel2</span>.<span class="fu">UnHighlight</span>();           
    }
    }
}</code></pre>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">/*</span>
<span class="co">   HISTORY</span>

<span class="co">14-NOV-02   J-03-38   $$1   JCN      Adapted from J-Link examples.</span>
<span class="co">07-MAR-03   K-01-02   $$3   JCN      UNIX support</span>
<span class="co">*/</span>

<span class="co">/*====================================================================*\</span>
FUNCTION: createParametersFromArguments
PURPOSE:  Create/modify parameters <span class="kw">in</span> the model based on name-value pairs 
            <span class="kw">in</span> the page URL
\*====================================================================*<span class="ot">/</span>
<span class="kw">function</span> <span class="fu">createParametersFromArguments</span> ()  
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);
  
  <span class="kw">var</span> propValue;
  <span class="kw">var</span> propsfile = <span class="st">&quot;params.properties&quot;</span>;
  <span class="kw">var</span> p;

  <span class="kw">var</span> args = <span class="fu">getArgs</span> ();
  
<span class="co">/*------------------------------------------------------------------*\</span>
  Use the current model as the parameter <span class="ot">owner</span>.
\*------------------------------------------------------------------*<span class="ot">/</span>
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  <span class="kw">var</span> pOwner = <span class="ot">session</span>.<span class="fu">CurrentModel</span>;
  
  <span class="kw">if</span> (pOwner == <span class="kw">void</span> <span class="kw">null</span>)
    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, <span class="st">&quot;No current model.&quot;</span>);

<span class="co">/*------------------------------------------------------------------*\</span>
  Process each name/value pair as a Pro/E <span class="ot">parameter</span>.
\*------------------------------------------------------------------*<span class="ot">/</span>
  <span class="kw">for</span> (<span class="kw">var</span> i = <span class="dv">0</span>; i &lt; <span class="ot">args</span>.<span class="fu">length</span>; i++)
    {
      <span class="kw">var</span> pName = args[i].<span class="fu">Name</span>;
      <span class="kw">var</span> pv = <span class="fu">createParamValueFromString</span>(args[i].<span class="fu">Value</span>);
      p = <span class="ot">pOwner</span>.<span class="fu">GetParam</span>(pName);
<span class="co">/*------------------------------------------------------------------*\</span>
  GetParam returns <span class="kw">null</span> <span class="kw">if</span> it can<span class="st">&#39;t find the param.  Create it.</span>
\*------------------------------------------------------------------*<span class="ot">/</span>
      <span class="kw">if</span> (p == <span class="kw">void</span> <span class="kw">null</span>) 
    {
      <span class="ot">pOwner</span>.<span class="fu">CreateParam</span> (pName, pv);
    }
      <span class="kw">else</span>
    {
      <span class="ot">p</span>.<span class="fu">Value</span> = pv;
    }
    }
  
  <span class="ot">session</span>.<span class="fu">RunMacro</span> (<span class="st">&quot;~ Select `main_dlg_cur` `MenuBar1` `Utilities`;~ Close `main_dlg_cur` `MenuBar1`;~ Activate `main_dlg_cur` `Utilities.psh_params`&quot;</span>);
}

<span class="co">/*====================================================================*\</span>
FUNCTION: getArgs
PURPOSE:  Parse arguments passed via the URL
\*====================================================================*<span class="ot">/</span>
<span class="kw">function</span> <span class="fu">getArgs</span> ()
{
  <span class="kw">var</span> args = <span class="kw">new</span> <span class="fu">Array</span> ();
  
  <span class="kw">var</span> query = <span class="ot">location</span>.<span class="ot">search</span>.<span class="fu">substring</span> (<span class="dv">1</span>);
  
  <span class="kw">var</span> pairs = <span class="ot">query</span>.<span class="fu">split</span> (<span class="st">&quot;&amp;&quot;</span>);
  <span class="kw">for</span> (<span class="kw">var</span> i = <span class="dv">0</span>; i &lt; <span class="ot">pairs</span>.<span class="fu">length</span>; i++)
    {   
      <span class="kw">var</span> pos = pairs [i].<span class="fu">indexOf</span> (<span class="st">&#39;=&#39;</span>);
      <span class="kw">if</span> (pos == -<span class="dv">1</span>) <span class="kw">continue</span>;
      <span class="kw">var</span> argname = pairs[i].<span class="fu">substring</span> (<span class="dv">0</span>, pos);
      <span class="kw">var</span> value = pairs[i].<span class="fu">substring</span> (pos<span class="dv">+1</span>);
      <span class="kw">var</span> argPair = <span class="kw">new</span> <span class="fu">Object</span> ();
      <span class="ot">argPair</span>.<span class="fu">Name</span> = argname;
      <span class="ot">argPair</span>.<span class="fu">Value</span> = <span class="fu">unescape</span> (value);
      <span class="ot">args</span>.<span class="fu">push</span> (argPair);
    }
  
  <span class="kw">return</span> args;
}

<span class="co">/*====================================================================*\</span>
FUNCTION: createParamValueFromString
PURPOSE:  Parses a string into a pfcParamValue object, checking <span class="kw">for</span> most 
        restrictive possible type to <span class="ot">use</span>.
\*====================================================================*<span class="ot">/    </span>
<span class="ot">function createParamValueFromString </span><span class="fl">(</span><span class="ot">s /</span>* string *<span class="ot">/</span><span class="fl">)</span>
<span class="ot">{</span>
<span class="ot">  if </span><span class="fl">(</span><span class="ot">s.indexOf </span><span class="fl">(</span><span class="ot">&quot;.&quot;</span><span class="fl">)</span><span class="ot"> == -1</span><span class="fl">)</span>
<span class="ot">    {</span>
<span class="ot">      var i = parseInt </span><span class="fl">(</span><span class="ot">s</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">      if </span><span class="fl">(</span><span class="ot">!isNaN</span><span class="fl">(</span><span class="ot">i</span><span class="fl">))</span>
<span class="ot">    return pfcCreate </span><span class="fl">(</span><span class="ot">&quot;MpfcModelItem&quot;</span><span class="fl">)</span><span class="ot">.CreateIntParamValue</span><span class="fl">(</span><span class="ot">i</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">    }</span>
<span class="ot">  else</span>
<span class="ot">    {</span>
<span class="ot">      var d = parseFloat </span><span class="fl">(</span><span class="ot">s</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">      if </span><span class="fl">(</span><span class="ot">!isNaN</span><span class="fl">(</span><span class="ot">d</span><span class="fl">))</span>
<span class="ot">    return pfcCreate </span><span class="fl">(</span><span class="ot">&quot;MpfcModelItem&quot;</span><span class="fl">)</span><span class="ot">.CreateDoubleParamValue</span><span class="fl">(</span><span class="ot">d</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">    }</span>
<span class="ot">  if </span><span class="fl">(</span><span class="ot">s.toUpperCase</span><span class="fl">()</span><span class="ot"> == &quot;Y&quot; </span><span class="fl">||</span><span class="ot"> s.toUpperCase </span><span class="fl">()</span><span class="ot">== &quot;TRUE&quot;</span><span class="fl">)</span>
<span class="ot">    return pfcCreate </span><span class="fl">(</span><span class="ot">&quot;MpfcModelItem&quot;</span><span class="fl">)</span><span class="ot">.CreateBoolParamValue</span><span class="fl">(</span><span class="ot">true</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">  </span>
<span class="ot">  if </span><span class="fl">(</span><span class="ot">s.toUpperCase</span><span class="fl">()</span><span class="ot"> == &quot;N&quot; </span><span class="fl">||</span><span class="ot"> s.toUpperCase </span><span class="fl">()</span><span class="ot">== &quot;FALSE&quot;</span><span class="fl">)</span>
<span class="ot">    return pfcCreate </span><span class="fl">(</span><span class="ot">&quot;MpfcModelItem&quot;</span><span class="fl">)</span><span class="ot">.CreateBoolParamValue</span><span class="fl">(</span><span class="ot">false</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">  </span>
<span class="ot">  return pfcCreate </span><span class="fl">(</span><span class="ot">&quot;MpfcModelItem&quot;</span><span class="fl">)</span><span class="ot">.CreateStringParamValue</span><span class="fl">(</span><span class="ot">s</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">}</span>

<span class="ot">                    </span>
<span class="ot">    </span></code></pre>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">/*</span>
<span class="co">   HISTORY</span>
<span class="co">   </span>
<span class="co">14-NOV-02   J-03-38   $$1   JCN      Adapted from J-Link examples.</span>
<span class="co">07-MAR-03   K-01-03   $$2   JCN      UNIX support</span>

<span class="co"> */</span>
 
<span class="co">/* </span>
<span class="co">   A sample that shows the use of the GetProEArguments</span>
<span class="co">   method to access the Pro/ENGINEER command line arguments. </span>
<span class="co">   The first argument is always the full path to the Pro/E executable. </span>
<span class="co">   For this application the next two arguments can be either (&quot;+runtime&quot; or </span>
<span class="co">   &quot;+development&quot;) or (&quot;-Unix&quot; or &quot;-NT&quot;). Based on these values 2 boolean </span>
<span class="co">   variables are set and passed on to another function which makes use of </span>
<span class="co">   this information.   </span>
<span class="co">*/</span>    

<span class="kw">var</span> runtime = <span class="kw">true</span>;
<span class="kw">var</span> unix = <span class="kw">false</span>;

<span class="kw">function</span> <span class="fu">getArguments</span> ()
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);
  
  <span class="kw">var</span> argseq = <span class="fu">pfcCreate</span> (<span class="st">&quot;MpfcCOMGlobal&quot;</span>).<span class="fu">GetProEArguments</span>();         
  
<span class="co">/*------------------------------------------------------------------*\</span>
  Making sure that there are three <span class="ot">arguments</span>.
\*------------------------------------------------------------------*<span class="ot">/</span>
  <span class="kw">if</span> (<span class="ot">argseq</span>.<span class="fu">Count</span> == <span class="dv">3</span>)
    {
<span class="co">/*------------------------------------------------------------------*\</span>
  First argument is Pro/E executable  - skip it
\*------------------------------------------------------------------*<span class="ot">/</span>
<span class="co">/*------------------------------------------------------------------*\</span>
  Set flags based on Pro/E input arguments
\*------------------------------------------------------------------*<span class="ot">/</span>
      <span class="kw">var</span> val=<span class="ot">argseq</span>.<span class="fu">Item</span>(<span class="dv">1</span>);
      
      <span class="fu">setFlags</span> (val);
     
<span class="co">/*------------------------------------------------------------------*\</span>
  Set third flag based on Pro/E input argument
\*------------------------------------------------------------------*<span class="ot">/</span>
      val=<span class="ot">argseq</span>.<span class="fu">Item</span>(<span class="dv">2</span>);
      
      <span class="fu">setFlags</span> (val);
    }
<span class="co">/*------------------------------------------------------------------*\</span>
  Pass the boolean values to another <span class="kw">function</span>
\*------------------------------------------------------------------*<span class="ot">/</span>
  <span class="co">//runApplication(runtime,unix);</span>
}
    
    
<span class="kw">function</span> <span class="fu">setFlags</span> (val <span class="co">/* string */</span>)
{
  <span class="kw">if</span> (val == <span class="st">&quot;+runtime&quot;</span>)
    {
      runtime=<span class="kw">true</span>;
    }
  <span class="kw">else</span> <span class="kw">if</span> (val == <span class="st">&quot;+development&quot;</span>)
    {                   
      runtime=<span class="kw">false</span>;
    }      
  <span class="kw">else</span> <span class="kw">if</span> (val == <span class="st">&quot;-Unix&quot;</span>)
    {
      unix=<span class="kw">true</span>;
    }
  <span class="kw">else</span> <span class="kw">if</span> (val == <span class="st">&quot;-NT&quot;</span>)
    {
      unix=<span class="kw">false</span>;
    }
}
           

</code></pre>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">/*  </span>
<span class="co">   HISTORY</span>

<span class="co">23-JUL-07   L-01-35   $$1  SNV     Created and submitted</span>

<span class="co">*/</span>

<span class="co">/*====================================================================*\</span>
FUNCTION: createParamDimRelation_script_wrapper
PURPOSE:  Wrapper <span class="kw">function</span> <span class="kw">for</span> <span class="ot">createParamDimRelation</span>.
\*====================================================================*<span class="ot">/</span>
<span class="kw">function</span> <span class="fu">createParamDimRelation_script_wrapper</span>()
{   
    <span class="kw">var</span> i;
    <span class="kw">var</span> selections;
    <span class="kw">var</span> options ;
    
    <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
    <span class="co">/*=====================================================================*\</span>
    Get the current part model
    \*=====================================================================*<span class="ot">/      </span>
<span class="ot">    var solid = session.CurrentModel;</span>
<span class="ot">    modelTypeClass = pfcCreate </span><span class="fl">(</span><span class="ot">&quot;pfcModelType&quot;</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">    </span>
<span class="ot">    if </span><span class="fl">(</span><span class="ot">solid == void null </span><span class="fl">||</span><span class="ot"> </span><span class="fl">(</span><span class="ot">solid.Type != modelTypeClass.MDL_PART</span><span class="fl">))</span>
<span class="ot">    {</span>
<span class="ot">        throw new Error  </span><span class="fl">(</span><span class="ot">0, &quot;Current model is not a part.&quot;</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">    }</span>
<span class="ot">      </span>
<span class="ot">    /</span>*=====================================================================*\
        Get selected components
    \*=====================================================================*<span class="ot">/               </span>
<span class="ot">    var browserSize = session.CurrentWindow.GetBrowserSize</span><span class="fl">()</span><span class="ot">;</span>
<span class="ot">    session.CurrentWindow.SetBrowserSize </span><span class="fl">(</span><span class="ot">0.0</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">    </span>
<span class="ot">    options = pfcCreate</span><span class="fl">(</span><span class="ot">&quot;pfcSelectionOptions&quot;</span><span class="fl">)</span><span class="ot">.Create</span><span class="fl">(</span><span class="ot">&quot;feature&quot;</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">    selections = session.Select </span><span class="fl">(</span><span class="ot">options, void null</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">    </span>
<span class="ot">    session.CurrentWindow.SetBrowserSize </span><span class="fl">(</span><span class="ot">browserSize</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">    if </span><span class="fl">(</span><span class="ot">selections == void null </span><span class="fl">||</span><span class="ot"> selections.Count == 0</span><span class="fl">)</span>
<span class="ot">    {</span>
<span class="ot">        throw new Error  </span><span class="fl">(</span><span class="ot">0, &quot;Nothing selected&quot;</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">    }</span>
<span class="ot">    </span>
<span class="ot">    var features = pfcCreate</span><span class="fl">(</span><span class="ot">&quot;pfcFeatures&quot;</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">    for </span><span class="fl">(</span><span class="ot">i =0; i &lt; selections.Count ; i</span><span class="fl">++)</span>
<span class="ot">    {</span>
<span class="ot">        features.Append</span><span class="fl">(</span><span class="ot">selections.Item</span><span class="fl">(</span><span class="ot">i</span><span class="fl">)</span><span class="ot">.SelItem</span><span class="fl">)</span><span class="ot">;                        </span>
<span class="ot">    }</span>
<span class="ot">    </span>
<span class="ot">    createParamDimRelation</span><span class="fl">(</span><span class="ot">features</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">    </span>
<span class="ot">}</span>


<span class="ot">/</span>*====================================================================*\
<span class="dt">FUNCTION</span>: createParamDimRelation
<span class="dt">PURPOSE</span>:  This <span class="kw">function</span> creates parameters <span class="kw">for</span> all dimensions <span class="kw">in</span> input 
          features of a part model and adds relation between <span class="ot">them</span>.
\*====================================================================*<span class="ot">/</span>
<span class="kw">function</span> <span class="fu">createParamDimRelation</span> (features)
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);
    
  <span class="kw">var</span> i,j;
  <span class="kw">var</span> relations;
  <span class="kw">var</span> items;  
  <span class="kw">var</span> dimName , paramName;
  <span class="kw">var</span> dimValue;
  <span class="kw">var</span> paramAdded;
  <span class="kw">var</span> param ;
  <span class="kw">var</span> paramValue;
                   
  <span class="kw">for</span> (i =<span class="dv">0</span>; i &lt; <span class="ot">features</span>.<span class="fu">Count</span> ; i++)
  {   
      <span class="co">/*=====================================================================*\</span>
        Get the selected feature
      \*=====================================================================*<span class="ot">/   </span>
<span class="ot">      var feature = features.Item</span><span class="fl">(</span><span class="ot">i</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">      if </span><span class="fl">(</span><span class="ot">feature == void null</span><span class="fl">)</span>
<span class="ot">      {</span>
<span class="ot">          continue;</span>
<span class="ot">      }</span>
<span class="ot">      </span>
<span class="ot">      /</span>*=====================================================================*\
        Get the dimensions <span class="kw">in</span> the current feature
      \*=====================================================================*<span class="ot">/</span>
      items = <span class="ot">feature</span>.<span class="fu">ListSubItems</span>(<span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelItemType&quot;</span>).<span class="fu">ITEM_DIMENSION</span>);

      <span class="kw">if</span> ((items == <span class="kw">void</span> <span class="kw">null</span>) || (<span class="ot">items</span>.<span class="fu">Count</span> == <span class="dv">0</span> ))
      {
          <span class="kw">continue</span>;
      }
              
      relations = <span class="fu">pfcCreate</span>(<span class="st">&quot;stringseq&quot;</span>);
            
      <span class="co">/*=====================================================================*\</span>
        Loop through all the dimensions and create relations
      \*=====================================================================*<span class="ot">/</span>
      <span class="kw">for</span> (j = <span class="dv">0</span>; j &lt; <span class="ot">items</span>.<span class="fu">Count</span>; j++)
      {       
          <span class="kw">var</span> item = <span class="ot">items</span>.<span class="fu">Item</span>(j);       
          dimName = <span class="ot">item</span>.<span class="fu">GetName</span>();       
          paramName = paramName = <span class="st">&quot;PARAM_&quot;</span> + dimName;         

          dimValue = <span class="ot">item</span>.<span class="fu">DimValue</span>;
                          
          param = <span class="ot">feature</span>.<span class="fu">GetParam</span>(paramName);        
          paramAdded = <span class="kw">false</span>;
          
          <span class="kw">if</span> (param == <span class="kw">void</span> <span class="kw">null</span>)
          {
              paramValue = <span class="fu">pfcCreate</span> (<span class="st">&quot;MpfcModelItem&quot;</span>).<span class="fu">CreateDoubleParamValue</span>(dimValue);
              <span class="ot">feature</span>.<span class="fu">CreateParam</span> (paramName, paramValue);
              paramAdded = <span class="kw">true</span>;
          }
          <span class="kw">else</span>
          {
              <span class="kw">if</span> (<span class="ot">param</span>.<span class="ot">Value</span>.<span class="fu">discr</span> == <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcParamValueType&quot;</span>).<span class="fu">PARAM_DOUBLE</span>)
              {
                  paramValue = <span class="fu">pfcCreate</span> (<span class="st">&quot;MpfcModelItem&quot;</span>).<span class="fu">CreateDoubleParamValue</span>(dimValue);
                  <span class="ot">param</span>.<span class="fu">Value</span> = paramValue;
                  paramAdded = <span class="kw">true</span>;
              }
          }
          
          <span class="kw">if</span> (paramAdded == <span class="kw">true</span>)
          {
              <span class="ot">relations</span>.<span class="fu">Append</span>(dimName + <span class="st">&quot; = &quot;</span> + paramName);                  
          }
          param = <span class="kw">void</span> <span class="kw">null</span>;
          
      }
     <span class="ot">feature</span>.<span class="fu">Relations</span> = relations;
  }
}         
    
      </code></pre>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">/*</span>
<span class="co">   HISTORY</span>
<span class="co">   </span>
<span class="co">14-NOV-02   J-03-38   $$1   JCN      Adapted from J-Link examples.</span>
<span class="co">07-MAR-03   K-01-03   $$2   JCN      UNIX support</span>
<span class="co">*/</span>
 
<span class="co">/*</span>
<span class="co">  This example code demonstrates how to invoke an interactive selection. </span>
<span class="co">*/</span>
<span class="kw">function</span> <span class="fu">selectItems</span> (options <span class="co">/* string[] */</span>, max <span class="co">/* integer */</span>)
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Get the session. If no model in present abort the operation. </span>
<span class="co">\*--------------------------------------------------------------------*/</span>  
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  <span class="kw">var</span> model = <span class="ot">session</span>.<span class="fu">CurrentModel</span>;
  
  <span class="kw">if</span> (model == <span class="kw">void</span> <span class="kw">null</span>)
    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, <span class="st">&quot;No current model.&quot;</span>);
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Collect the options array into a comma delimited list</span>
<span class="co">\*--------------------------------------------------------------------*/</span>  
  <span class="kw">var</span> optString = <span class="st">&quot;&quot;</span>;
  <span class="kw">for</span> (<span class="kw">var</span> i = <span class="dv">0</span>; i &lt; <span class="ot">options</span>.<span class="fu">length</span>; i++)
    {
      optString += options [i];
      <span class="kw">if</span> (i != <span class="ot">options</span>.<span class="fu">length</span> -<span class="dv">1</span>)
    optString += <span class="st">&quot;,&quot;</span>;
    }
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Prompt for selection.</span>
<span class="co">\*--------------------------------------------------------------------*/</span>  
  selOptions = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcSelectionOptions&quot;</span>).<span class="fu">Create</span> (optString);
  
  <span class="kw">if</span> (max != <span class="st">&quot;UNLIMITED&quot;</span>)
    {
      <span class="ot">selOptions</span>.<span class="fu">MaxNumSels</span> = <span class="fu">parseInt</span> (max);
    }
  
  <span class="ot">session</span>.<span class="ot">CurrentWindow</span>.<span class="fu">SetBrowserSize</span> (<span class="fl">0.0</span>);
  
  <span class="kw">var</span> selections = <span class="kw">void</span> <span class="kw">null</span>;
  <span class="kw">try</span> {
    selections = <span class="ot">session</span>.<span class="fu">Select</span> (selOptions, <span class="kw">void</span> <span class="kw">null</span>);
  }
  <span class="kw">catch</span> (err) {
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Handle the situation where the  user didn&#39;t make selections, but picked </span>
<span class="co">  elsewhere instead.</span>
<span class="co">  \*--------------------------------------------------------------------*/</span>  
    <span class="kw">if</span> (<span class="fu">pfcGetExceptionType</span> (err) == <span class="st">&quot;pfcXToolkitUserAbort&quot;</span> || 
    <span class="fu">pfcGetExceptionType</span> (err) == <span class="st">&quot;pfcXToolkitPickAbove&quot;</span>)
      <span class="kw">return</span> (<span class="kw">void</span> <span class="kw">null</span>);
    <span class="kw">else</span>
      <span class="kw">throw</span> err;
  }
  <span class="kw">if</span> (<span class="ot">selections</span>.<span class="fu">Count</span> == <span class="dv">0</span>)
    <span class="kw">return</span> (<span class="kw">void</span> <span class="kw">null</span>);
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Write selection info to the browser window</span>
<span class="co">\*--------------------------------------------------------------------*/</span>  
  <span class="kw">var</span> newWin = <span class="ot">window</span>.<span class="fu">open</span> (<span class="st">&#39;&#39;</span>, <span class="st">&quot;_IS&quot;</span>, <span class="st">&quot;scrollbars&quot;</span>);
  <span class="kw">if</span> (<span class="fu">pfcIsWindows</span>())
    {
      <span class="ot">newWin</span>.<span class="fu">resizeTo</span> (<span class="dv">300</span>, <span class="ot">screen</span>.<span class="fu">height</span>/<span class="fl">2.0</span>);
      <span class="ot">newWin</span>.<span class="fu">moveTo</span> (<span class="ot">screen</span>.<span class="fu">width</span><span class="dv">-300</span>, <span class="dv">0</span>);
    }
  <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&quot;</span>);
  
  <span class="kw">for</span> (<span class="kw">var</span> i = <span class="dv">0</span>; i &lt; <span class="ot">selections</span>.<span class="fu">Count</span>; i ++)
    {
      <span class="kw">var</span> sel = <span class="ot">selections</span>.<span class="fu">Item</span> (i);
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;h2&gt;Selection &quot;</span>+(i<span class="dv">+1</span>)+<span class="st">&quot;: &lt;/h2&gt;&quot;</span>);
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;table&gt;&quot;</span>);
      
      <span class="kw">var</span> selModelName = <span class="st">&quot;N/A&quot;</span>;
      <span class="kw">if</span> (<span class="ot">sel</span>.<span class="fu">SelModel</span> != <span class="kw">void</span> <span class="kw">null</span>)
    selModelName = <span class="ot">sel</span>.<span class="ot">SelModel</span>.<span class="fu">FullName</span>;   
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;tr&gt;&lt;td&gt;Sel model: &lt;/td&gt;&lt;td&gt;&quot;</span>+
                   selModelName+<span class="st">&quot;&lt;/td&gt;&lt;/tr&gt;&quot;</span>);
      
      <span class="kw">var</span> selItemInfo = <span class="st">&quot;N/A&quot;</span>;
      <span class="kw">if</span> (<span class="ot">sel</span>.<span class="fu">SelItem</span> != <span class="kw">void</span> <span class="kw">null</span>)
    selItemInfo = <span class="st">&quot;Type: &quot;</span>+ <span class="ot">sel</span>.<span class="ot">SelItem</span>.<span class="ot">Type</span>.<span class="fu">toString</span>() + 
      <span class="st">&quot; id: &quot;</span>+<span class="ot">sel</span>.<span class="ot">SelItem</span>.<span class="fu">Id</span>;
      
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;tr&gt;&lt;td&gt;Sel item: &lt;/td&gt;&lt;td&gt;&quot;</span> +
                   selItemInfo + <span class="st">&quot;&lt;/td&gt;&lt;/tr&gt;&quot;</span>);
      <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;/table&gt;&quot;</span>);
    }
  
  <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&quot;</span>);
  
  <span class="kw">return</span> (selections);
}


<span class="co">/* </span>
<span class="co">   This method highlights all the features in all levels of an assembly that have a given name. </span>
<span class="co">*/</span>
<span class="kw">function</span> <span class="fu">createAndHighlightSelections</span> (featureName <span class="co">/* string */</span>)
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Get the session. If no model in present abort the operation. </span>
<span class="co">\*--------------------------------------------------------------------*/</span>  
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  <span class="kw">var</span> assem = <span class="ot">session</span>.<span class="fu">CurrentModel</span>;
  
  <span class="kw">if</span> (assem == <span class="kw">void</span> <span class="kw">null</span> || 
      <span class="ot">assem</span>.<span class="fu">Type</span> != <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelType&quot;</span>).<span class="fu">MDL_ASSEMBLY</span>)
    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, <span class="st">&quot;Current model is not an assembly.&quot;</span>);
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Start a recursive traversal of the assembly structure. </span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  intPath = <span class="fu">pfcCreate</span> (<span class="st">&quot;intseq&quot;</span>);
  
  <span class="fu">highlightFeaturesRecursively</span> (assem, intPath, featureName);
}

<span class="kw">function</span> <span class="fu">highlightFeaturesRecursively</span> (assem <span class="co">/* pfcAssembly */</span>, 
                       intPath <span class="co">/* intseq */</span>,
                       featureName <span class="co">/* string */</span>)
{
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Obtain the model at the current assembly level.</span>
<span class="co">\*--------------------------------------------------------------------*/</span>
  <span class="kw">var</span> subcomponent;
  <span class="kw">var</span> cmpPath = <span class="kw">void</span> <span class="kw">null</span>;
  <span class="kw">if</span> (<span class="ot">intPath</span>.<span class="fu">Count</span> == <span class="dv">0</span>)
    subcomponent = assem;
  <span class="kw">else</span>
    {
      cmpPath = 
    <span class="fu">pfcCreate</span> (<span class="st">&quot;MpfcAssembly&quot;</span>).<span class="fu">CreateComponentPath</span>( assem, intPath );
      subcomponent = <span class="ot">cmpPath</span>.<span class="fu">Leaf</span>; 
    }
   
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Search for the desired feature.</span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  <span class="kw">var</span> theFeat = <span class="ot">subcomponent</span>.<span class="fu">GetFeatureByName</span> (featureName);
  <span class="kw">if</span> (theFeat != <span class="kw">void</span> <span class="kw">null</span>)
    {
      <span class="kw">var</span> cmpSelection = 
    <span class="fu">pfcCreate</span> (<span class="st">&quot;MpfcSelect&quot;</span>).<span class="fu">CreateModelItemSelection</span> ( theFeat, cmpPath );
      
      <span class="ot">cmpSelection</span>.<span class="fu">Highlight</span>(<span class="fu">pfcCreate</span> (<span class="st">&quot;pfcStdColor&quot;</span>).<span class="fu">COLOR_HIGHLIGHT</span>);
    }
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Search for subcomponents, and traverse each of them.</span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  <span class="kw">var</span> components = <span class="ot">subcomponent</span>.<span class="fu">ListFeaturesByType</span>(<span class="kw">true</span>, 
        <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcFeatureType&quot;</span>).<span class="fu">FEATTYPE_COMPONENT</span>);
  <span class="kw">for</span> (<span class="kw">var</span> i = <span class="dv">0</span>; i &lt; <span class="ot">components</span>.<span class="fu">Count</span>; i++)
    {
      <span class="kw">var</span> compFeat = <span class="ot">components</span>.<span class="fu">Item</span> (i);
      <span class="kw">if</span> (<span class="ot">compFeat</span>.<span class="fu">Status</span> == <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcFeatureStatus&quot;</span>).<span class="fu">FEAT_ACTIVE</span>)
    {
      <span class="ot">intPath</span>.<span class="fu">Append</span> (<span class="ot">components</span>.<span class="fu">Item</span> (i).<span class="fu">Id</span>);
      <span class="fu">highlightFeaturesRecursively</span> (assem, intPath, featureName); 
    }
    }
    
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Clean up the assembly ids at this level before returning.</span>
<span class="co">\*--------------------------------------------------------------------*/</span> 
  <span class="kw">if</span> (<span class="ot">intPath</span>.<span class="fu">Count</span> &gt; <span class="dv">0</span>)
    {
      <span class="ot">intPath</span>.<span class="fu">Remove</span> (<span class="ot">intPath</span>.<span class="fu">Count</span> - <span class="dv">1</span>, <span class="ot">intPath</span>.<span class="fu">Count</span>);
    } 
}</code></pre>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">/*</span>
<span class="co">   HISTORY</span>
<span class="co">   </span>
<span class="co">02-Aug-10   L-05-28   $$1   pdeshmuk      Created.</span>

<span class="co">*/</span>

<span class="kw">function</span> <span class="fu">deleteItemsInSimpRep</span> ()
{  
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);

 <span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">   Get the current assembly </span>
<span class="co"> \*--------------------------------------------------------------------*/</span>  
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  <span class="kw">var</span> assembly = <span class="ot">session</span>.<span class="fu">CurrentModel</span>;
  
  <span class="kw">if</span> (<span class="ot">assembly</span>.<span class="fu">Type</span> != <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelType&quot;</span>).<span class="fu">MDL_ASSEMBLY</span>)
    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, <span class="st">&quot;Current model is not an assembly&quot;</span>);
  
 <span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">   Get the current active simprep.</span>
<span class="co"> \*--------------------------------------------------------------------*/</span>  
  <span class="kw">var</span> simp_rep = <span class="ot">assembly</span>.<span class="fu">GetActiveSimpRep</span>();
 
 <span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">   Get the current number of items</span>
<span class="co"> \*--------------------------------------------------------------------*/</span>  
  <span class="kw">var</span> simp_rep_instructions = <span class="ot">simp_rep</span>.<span class="fu">GetInstructions</span>();
    
  <span class="kw">var</span> number_items = <span class="ot">simp_rep_instructions</span>.<span class="ot">Items</span>.<span class="fu">Count</span>;
  <span class="ot">document</span>.<span class="fu">getElementById</span>(<span class="st">&quot;numItems&quot;</span>).<span class="fu">value</span> = number_items;

 
 <span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">   Deleting items</span>
<span class="co"> \*--------------------------------------------------------------------*/</span>               
  <span class="kw">var</span> simp_rep_instructions_item = <span class="ot">simp_rep_instructions</span>.<span class="ot">Items</span>.<span class="fu">Item</span>(number_items<span class="dv">-1</span>);
  <span class="ot">simp_rep_instructions_item</span>.<span class="fu">Action</span> = <span class="kw">null</span>;    
  <span class="ot">simp_rep</span>.<span class="fu">SetInstructions</span>(simp_rep_instructions);  
  number_items = <span class="ot">simp_rep</span>.<span class="fu">GetInstructions</span>().<span class="ot">Items</span>.<span class="fu">Count</span>;
  <span class="ot">document</span>.<span class="fu">getElementById</span>(<span class="st">&quot;numItems&quot;</span>).<span class="fu">value</span> = number_items;
  

  
  <span class="kw">return</span>;
}


    


<span class="kw">function</span> <span class="fu">addItemsInSimpRep</span> ()
{  
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);

 <span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">   Get the current assembly </span>
<span class="co"> \*--------------------------------------------------------------------*/</span>  
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  <span class="kw">var</span> assembly = <span class="ot">session</span>.<span class="fu">CurrentModel</span>;
  
  <span class="kw">if</span> (<span class="ot">assembly</span>.<span class="fu">Type</span> != <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelType&quot;</span>).<span class="fu">MDL_ASSEMBLY</span>)
    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, <span class="st">&quot;Current model is not an assembly&quot;</span>);
  
 <span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">   Get the current active simprep.</span>
<span class="co"> \*--------------------------------------------------------------------*/</span>  
  <span class="kw">var</span> simp_rep = <span class="ot">assembly</span>.<span class="fu">GetActiveSimpRep</span>();
 
 <span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">   Get the current number of items</span>
<span class="co"> \*--------------------------------------------------------------------*/</span>  
  <span class="kw">var</span> simp_rep_instructions = <span class="ot">simp_rep</span>.<span class="fu">GetInstructions</span>();
    
  <span class="kw">var</span> number_items = <span class="ot">simp_rep_instructions</span>.<span class="ot">Items</span>.<span class="fu">Count</span>;
  <span class="ot">document</span>.<span class="fu">getElementById</span>(<span class="st">&quot;numItems&quot;</span>).<span class="fu">value</span> = number_items;         

  
 <span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">   Add an item  </span>
<span class="co"> \*--------------------------------------------------------------------*/</span>  
  <span class="kw">var</span> item_path = <span class="fu">pfcCreate</span> (<span class="st">&quot;intseq&quot;</span>);
  
  <span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Prompt for selection.</span>
<span class="co">\*--------------------------------------------------------------------*/</span>  
  selOptions = <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcSelectionOptions&quot;</span>).<span class="fu">Create</span> (<span class="st">&quot;feature&quot;</span>);
  
  <span class="ot">selOptions</span>.<span class="fu">MaxNumSels</span> = <span class="fu">parseInt</span> (<span class="dv">1</span>);
  
  <span class="kw">var</span> selections = <span class="kw">void</span> <span class="kw">null</span>;
  <span class="kw">try</span> {
    selections = <span class="ot">session</span>.<span class="fu">Select</span> (selOptions, <span class="kw">void</span> <span class="kw">null</span>);
  }
  <span class="kw">catch</span> (err) {
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Handle the situation where the  user didn&#39;t make selections, but picked </span>
<span class="co">  elsewhere instead.</span>
<span class="co">  \*--------------------------------------------------------------------*/</span>  
  <span class="kw">if</span> (<span class="fu">pfcGetExceptionType</span> (err) == <span class="st">&quot;pfcXToolkitUserAbort&quot;</span> || 
    <span class="fu">pfcGetExceptionType</span> (err) == <span class="st">&quot;pfcXToolkitPickAbove&quot;</span>)
      <span class="kw">return</span> (<span class="kw">void</span> <span class="kw">null</span>);
    <span class="kw">else</span>
      <span class="kw">throw</span> err;
  }
  <span class="kw">if</span> (<span class="ot">selections</span>.<span class="fu">Count</span> == <span class="dv">0</span>)
    <span class="kw">return</span> (<span class="kw">void</span> <span class="kw">null</span>);

  <span class="kw">var</span> selection = <span class="ot">selections</span>.<span class="fu">Item</span>(<span class="dv">0</span>);
  <span class="kw">var</span> componentpath = <span class="ot">selection</span>.<span class="fu">Path</span>;
  <span class="kw">var</span> intseqIds = <span class="ot">componentpath</span>.<span class="fu">ComponentIds</span>;
  <span class="ot">item_path</span>.<span class="fu">Append</span>(<span class="ot">intseqIds</span>.<span class="fu">Item</span>(<span class="dv">0</span>));
  simp_rep_comp_item_path = <span class="fu">pfcCreate</span>(<span class="st">&quot;pfcSimpRepCompItemPath&quot;</span>).<span class="fu">Create</span>(item_path);
  
  simp_rep_item = <span class="fu">pfcCreate</span>(<span class="st">&quot;pfcSimpRepItem&quot;</span>).<span class="fu">Create</span>(simp_rep_comp_item_path);
  
  simp_rep_action = <span class="fu">pfcCreate</span>(<span class="st">&quot;pfcSimpRepExclude&quot;</span>).<span class="fu">Create</span>();
  
  <span class="ot">simp_rep_item</span>.<span class="fu">Action</span> = simp_rep_action;
  
  <span class="ot">simp_rep_instructions</span>.<span class="ot">Items</span>.<span class="fu">Append</span>(simp_rep_item);
  
  <span class="ot">simp_rep</span>.<span class="fu">SetInstructions</span>(simp_rep_instructions);
  
  simp_rep_instructions = <span class="ot">simp_rep</span>.<span class="fu">GetInstructions</span>();
  
  number_items = <span class="ot">simp_rep_instructions</span>.<span class="ot">Items</span>.<span class="fu">Count</span>;
  <span class="ot">document</span>.<span class="fu">getElementById</span>(<span class="st">&quot;numItems&quot;</span>).<span class="fu">value</span> = number_items; 
  
  <span class="kw">return</span>;
}
</code></pre>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">/*</span>
<span class="co">   HISTORY</span>
<span class="co">   </span>
<span class="co">14-NOV-02   J-03-38   $$1   JCN      Adapted from J-Link examples.</span>
<span class="co">07-MAR-03   K-01-03   $$2   JCN      UNIX support</span>
<span class="co">*/</span>

<span class="co">/* This method retrieves a MassProperty object from the provided solid</span>
<span class="co"> * model. Then solid&#39;s mass, volume, and center of gravity point are printed</span>
<span class="co"> */</span>
<span class="kw">function</span> <span class="fu">printMassProperties</span> ()
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Get the session. If no model in present abort the operation. </span>
<span class="co">\*--------------------------------------------------------------------*/</span>  
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  <span class="kw">var</span> solid = <span class="ot">session</span>.<span class="fu">CurrentModel</span>;
  
  <span class="kw">if</span> (solid == <span class="kw">void</span> <span class="kw">null</span> || (<span class="ot">solid</span>.<span class="fu">Type</span> != <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelType&quot;</span>).<span class="fu">MDL_PART</span> &amp;&amp;
                 <span class="ot">solid</span>.<span class="fu">Type</span> != <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelType&quot;</span>).<span class="fu">MDL_ASSEMBLY</span>))
    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, <span class="st">&quot;Current model is not a part or assembly.&quot;</span>);
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Calculate the mass properties.  Pass null to use the model </span>
<span class="co">    coordinate system.</span>
<span class="co">\*--------------------------------------------------------------------*/</span>  
  properties = <span class="ot">solid</span>.<span class="fu">GetMassProperty</span>(<span class="kw">void</span> <span class="kw">null</span>);
  
<span class="co">/*--------------------------------------------------------------------*\ </span>
<span class="co">  Display selected results.</span>
<span class="co">\*--------------------------------------------------------------------*/</span>  
  <span class="kw">var</span> newWin = <span class="ot">window</span>.<span class="fu">open</span> (<span class="st">&#39;&#39;</span>, <span class="st">&quot;_MP&quot;</span>, <span class="st">&quot;scrollbars&quot;</span>);
  <span class="kw">if</span> (<span class="fu">pfcIsWindows</span>())
    {
      <span class="ot">newWin</span>.<span class="fu">resizeTo</span> (<span class="dv">300</span>, <span class="ot">screen</span>.<span class="fu">height</span>/<span class="fl">2.0</span>);
      <span class="ot">newWin</span>.<span class="fu">moveTo</span> (<span class="ot">screen</span>.<span class="fu">width</span><span class="dv">-300</span>, <span class="dv">0</span>);
    }
  <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&quot;</span>);
  
  <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;p&gt;The solid mass is: &quot;</span> + <span class="ot">properties</span>.<span class="fu">Mass</span>);
  <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;p&gt;The solid volume is: &quot;</span> + <span class="ot">properties</span>.<span class="fu">Volume</span>);
  
  COG = <span class="ot">properties</span>.<span class="fu">GravityCenter</span>;
  <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;hr&gt;&lt;p&gt;The Center Of Gravity is at &quot;</span>);
  <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;table&gt;&quot;</span>);
  <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;tr&gt;&lt;td&gt;X&lt;/td&gt;&lt;td&gt;&quot;</span>+<span class="ot">COG</span>.<span class="fu">Item</span>(<span class="dv">0</span>)+<span class="st">&quot;&lt;/td&gt;&lt;/tr&gt;&quot;</span>);
  <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;tr&gt;&lt;td&gt;Y&lt;/td&gt;&lt;td&gt;&quot;</span>+<span class="ot">COG</span>.<span class="fu">Item</span>(<span class="dv">1</span>)+<span class="st">&quot;&lt;/td&gt;&lt;/tr&gt;&quot;</span>);
  <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;tr&gt;&lt;td&gt;Z&lt;/td&gt;&lt;td&gt;&quot;</span>+<span class="ot">COG</span>.<span class="fu">Item</span>(<span class="dv">2</span>)+<span class="st">&quot;&lt;/td&gt;&lt;/tr&gt;&quot;</span>);
  <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;/table&gt;&quot;</span>); 
  <span class="ot">newWin</span>.<span class="ot">document</span>.<span class="fu">writeln</span> (<span class="st">&quot;&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&quot;</span>);
}</code></pre>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">/*</span>
<span class="co">   HISTORY</span>

<span class="co">14-NOV-02   J-03-38   $$1   JCN      Adapted from J-Link examples.</span>
<span class="co">07-MAR-03   K-01-03   $$2   JCN      UNIX support</span>
<span class="co"> */</span>

<span class="co">/*====================================================================*\</span>
FUNCTION: createNodeUDFInPart
PURPOSE:  Places copies of a node UDF at a particular coordinate system 
          location <span class="kw">in</span> a <span class="ot">part</span>.  <span class="fu">The</span> <span class="fu">node</span> <span class="fu">UDF</span> <span class="fu">is</span> <span class="fu">a</span> <span class="fu">spherical</span> <span class="fu">cut</span> <span class="fu">centered</span> <span class="fu">at</span> <span class="fu">the</span> 
          coordinate system whose diameter is driven by the <span class="st">&#39;diam&#39;</span> argument to the 
          <span class="ot">method</span>.
\*====================================================================*<span class="ot">/</span>
<span class="kw">function</span> <span class="fu">createNodeUDFInPart</span> (csysName <span class="co">/* string */</span>, 
                  diam <span class="co">/* number */</span>) 
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);
  
<span class="co">/*------------------------------------------------------------------*\</span>
  Use the current model to place the <span class="ot">UDF</span>.
\*------------------------------------------------------------------*<span class="ot">/</span>
  <span class="kw">var</span> session = <span class="fu">pfcGetProESession</span> ();
  <span class="kw">var</span> solid = <span class="ot">session</span>.<span class="fu">CurrentModel</span>;
  
  <span class="kw">if</span> (solid == <span class="kw">void</span> <span class="kw">null</span> || <span class="ot">solid</span>.<span class="fu">Type</span> != <span class="fu">pfcCreate</span> (<span class="st">&quot;pfcModelType&quot;</span>).<span class="fu">MDL_PART</span>)
    <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="dv">0</span>, <span class="st">&quot;Current model is not a part.  Aborting...&quot;</span>);
  
<span class="co">/*------------------------------------------------------------------*\</span>
  The instructions <span class="kw">for</span> the UDF <span class="ot">creation</span>.
\*------------------------------------------------------------------*<span class="ot">/  </span>
<span class="ot">  var instrs = </span>
<span class="ot">    pfcCreate </span><span class="fl">(</span><span class="ot">&quot;pfcUDFCustomCreateInstructions&quot;</span><span class="fl">)</span><span class="ot">.Create </span><span class="fl">(</span><span class="ot">&quot;node&quot;</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">    </span>
<span class="ot">/</span>*------------------------------------------------------------------*\
  Make non-variant dimensions blank so they cannot be <span class="ot">changed</span>.
\*------------------------------------------------------------------*<span class="ot">/  </span>
<span class="ot">  instrs.DimDisplayType = </span>
<span class="ot">    pfcCreate </span><span class="fl">(</span><span class="ot">&quot;pfcUDFDimensionDisplayType&quot;</span><span class="fl">)</span><span class="ot">.UDFDISPLAY_BLANK;</span>
<span class="ot">  </span>
<span class="ot">/</span>*------------------------------------------------------------------*\
  Initialize the UDF reference and assign it to the <span class="ot">instructions</span>.  
  The string argument is the reference prompt <span class="kw">for</span> the particular 
  <span class="ot">reference</span>.
\*------------------------------------------------------------------*<span class="ot">/       </span>
<span class="ot">  csys = </span>
<span class="ot">    solid.GetItemByName </span><span class="fl">(</span><span class="ot">pfcCreate </span><span class="fl">(</span><span class="ot">&quot;pfcModelItemType&quot;</span><span class="fl">)</span><span class="ot">.ITEM_COORD_SYS, </span>
<span class="ot">             csysName</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">  if </span><span class="fl">(</span><span class="ot">csys == void null</span><span class="fl">)</span>
<span class="ot">    throw new Error </span><span class="fl">(</span><span class="ot">0, &quot;Requested coordinate system &quot;</span><span class="fl">+</span><span class="ot">csysName</span><span class="fl">+</span><span class="ot">&quot; not found.&quot;</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">  csysSel = </span>
<span class="ot">    pfcCreate </span><span class="fl">(</span><span class="ot">&quot;MpfcSelect&quot;</span><span class="fl">)</span><span class="ot">.CreateModelItemSelection  </span><span class="fl">(</span><span class="ot">csys, void null</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">  </span>
<span class="ot">  var csysRef = </span>
<span class="ot">    pfcCreate </span><span class="fl">(</span><span class="ot">&quot;pfcUDFReference&quot;</span><span class="fl">)</span><span class="ot">.Create </span><span class="fl">(</span><span class="ot">&quot;REF_CSYS&quot;, csysSel</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">  </span>
<span class="ot">  var refs = pfcCreate </span><span class="fl">(</span><span class="ot">&quot;pfcUDFReferences&quot;</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">  refs.Append </span><span class="fl">(</span><span class="ot">csysRef</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">  </span>
<span class="ot">  instrs.References = refs;</span>
<span class="ot">  </span>
<span class="ot">/</span>*------------------------------------------------------------------*\
  Initialize the variant dimension and assign it to the <span class="ot">instructions</span>.  
  The string argument is the dimension symbol <span class="kw">for</span> the variant 
  <span class="ot">dimension</span>.
\*------------------------------------------------------------------*<span class="ot">/  </span>
<span class="ot">   var varDiam = </span>
<span class="ot">     pfcCreate </span><span class="fl">(</span><span class="ot">&quot;pfcUDFVariantDimension&quot;</span><span class="fl">)</span><span class="ot">.Create </span><span class="fl">(</span><span class="ot">&quot;d11&quot;, diam</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">   </span>
<span class="ot">   var vals = pfcCreate </span><span class="fl">(</span><span class="ot">&quot;pfcUDFVariantValues&quot;</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">   vals.Append </span><span class="fl">(</span><span class="ot">varDiam</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">   </span>
<span class="ot">   instrs.VariantValues = vals;</span>
<span class="ot">   </span>
<span class="ot">/</span>*------------------------------------------------------------------*\
  Create the <span class="kw">new</span> UDF <span class="ot">placement</span>.
\*------------------------------------------------------------------*<span class="ot">/  </span>
<span class="ot">   var group = solid.CreateUDFGroup </span><span class="fl">(</span><span class="ot">instrs</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">    return </span><span class="fl">(</span><span class="ot">group</span><span class="fl">)</span><span class="ot">;</span>
<span class="ot">}</span></code></pre>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">/*</span>
<span class="co">   HISTORY</span>

<span class="co">14-NOV-02   J-03-38   $$1   JCN      Submitted.</span>
<span class="co">07-MAR-03   K-01-03   $$2   JCN      UNIX support</span>
<span class="co">01-MAY-07   L-01-31   $$3   JCN      New exception messaging.</span>
<span class="co"> */</span>

<span class="kw">function</span> <span class="fu">isProEEmbeddedBrowser</span> ()
{
  <span class="kw">if</span> (<span class="ot">top</span>.<span class="fu">external</span> &amp;&amp; <span class="ot">top</span>.<span class="ot">external</span>.<span class="fu">ptc</span>)
    <span class="kw">return</span> <span class="kw">true</span>;
  <span class="kw">else</span>
    <span class="kw">return</span> <span class="kw">false</span>;
}

<span class="kw">function</span> <span class="fu">pfcIsWindows</span> ()
{
  <span class="kw">if</span> (<span class="ot">navigator</span>.<span class="ot">appName</span>.<span class="fu">indexOf</span> (<span class="st">&quot;Microsoft&quot;</span>) != -<span class="dv">1</span>)
    <span class="kw">return</span> <span class="kw">true</span>;
  <span class="kw">else</span>
    <span class="kw">return</span> <span class="kw">false</span>;
}

<span class="kw">function</span> <span class="fu">pfcCreate</span> (className)
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())  
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);
  
  <span class="kw">if</span> (<span class="fu">pfcIsWindows</span>())
    <span class="kw">return</span> <span class="kw">new</span> <span class="fu">ActiveXObject</span> (<span class="st">&quot;pfc.&quot;</span>+className);
  <span class="kw">else</span>
    {
      ret = <span class="ot">Components</span>.<span class="fu">classes</span> [<span class="st">&quot;@ptc.com/pfc/&quot;</span> + className + <span class="st">&quot;;1&quot;</span>].
    
    <span class="fu">createInstance</span>();
      
      <span class="kw">return</span> ret;
    }
}

<span class="kw">function</span> <span class="fu">pfcGetProESession</span> ()
{
  <span class="kw">if</span> (!<span class="fu">isProEEmbeddedBrowser</span> ())
    {
      <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="st">&quot;Not in embedded browser.  Aborting...&quot;</span>);
    }
  
  <span class="co">// Security code</span>
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);
  
  <span class="kw">var</span> glob = <span class="fu">pfcCreate</span> (<span class="st">&quot;MpfcCOMGlobal&quot;</span>);
  <span class="kw">return</span> <span class="ot">glob</span>.<span class="fu">GetProESession</span>();
}

<span class="kw">function</span> <span class="fu">pfcGetScript</span> ()
{  
  <span class="kw">if</span> (!<span class="fu">isProEEmbeddedBrowser</span> ())
    {
      <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">Error</span> (<span class="st">&quot;Not in embedded browser.  Aborting...&quot;</span>);
    }
  
  <span class="co">// Security code</span>
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);
  
  <span class="kw">var</span> glob = <span class="fu">pfcCreate</span> (<span class="st">&quot;MpfcCOMGlobal&quot;</span>);
  <span class="kw">return</span> <span class="ot">glob</span>.<span class="fu">GetScript</span>();
}


<span class="kw">function</span> <span class="fu">pfcGetExceptionDescription</span> (err)
{
 <span class="kw">if</span> (<span class="fu">pfcIsWindows</span>())
    errString = <span class="ot">err</span>.<span class="fu">description</span>;
 <span class="kw">else</span>
      errString = <span class="ot">err</span>.<span class="fu">message</span>;

 <span class="kw">return</span> errString;
}

<span class="kw">function</span> <span class="fu">pfcGetExceptionType</span> (err)
{
  errString = <span class="fu">pfcGetExceptionDescription</span> (err);

  <span class="co">// This should remove the XPCOM prefix (&quot;XPCR_C&quot;)</span>
  <span class="kw">if</span> (<span class="ot">errString</span>.<span class="fu">search</span> (<span class="st">&quot;XPCR_C&quot;</span>) &lt; <span class="dv">0</span>)
  {
    errString = <span class="ot">errString</span>.<span class="fu">replace</span> (<span class="st">&quot;Exceptions::&quot;</span>, <span class="st">&quot;&quot;</span>);
    semicolonIndex = <span class="ot">errString</span>.<span class="fu">search</span> (<span class="st">&quot;;&quot;</span>);
    <span class="kw">if</span> (semicolonIndex &gt; <span class="dv">0</span>)
        errString = <span class="ot">errString</span>.<span class="fu">substring</span> (<span class="dv">0</span>, semicolonIndex);
    <span class="kw">return</span> (errString);
  }
  <span class="kw">else</span>
      <span class="kw">return</span> (<span class="ot">errString</span>.<span class="fu">replace</span>(<span class="st">&quot;XPCR_C&quot;</span>, <span class="st">&quot;&quot;</span>));
}

      </code></pre>
<pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="co">/*</span>
<span class="co">   HISTORY</span>
<span class="co">   </span>
<span class="co">14-NOV-02   J-03-38   $$1   JCN      Adapted from J-Link examples.</span>
<span class="co">07-MAR-03   K-01-03   $$2   JCN      UNIX support</span>
<span class="co"> */</span>


<span class="kw">try</span>
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);
  
  wpwl = <span class="fu">pfcGetScript</span> ();
  <span class="ot">document</span>.<span class="fu">pwl</span> = wpwl;
  wpwlc = <span class="ot">wpwl</span>.<span class="fu">GetPWLConstants</span> ();
  <span class="ot">document</span>.<span class="fu">pwlc</span> = wpwlc;
  wpwlf = <span class="ot">wpwl</span>.<span class="fu">GetPWLFeatureConstants</span> ();
  <span class="ot">document</span>.<span class="fu">pwlf</span> = wpwlf;
}
<span class="kw">catch</span> (err)
{
  <span class="fu">alert</span> (<span class="st">&quot;Exception caught: &quot;</span>+<span class="fu">pfcGetExceptionType</span> (err));
}

<span class="kw">function</span> <span class="fu">WlProEStart</span>()
{ 
  <span class="kw">if</span> (<span class="ot">document</span>.<span class="fu">pwl</span> == <span class="kw">void</span> <span class="kw">null</span>)
    {
      <span class="fu">alert</span>(<span class="st">&quot;Connect failed.&quot;</span>);
      <span class="kw">return</span> ;
    }
}

<span class="kw">function</span> <span class="fu">WlProEConnect</span>()
<span class="co">//  Connect to a running Pro/ENGINEER session.</span>
{
  <span class="fu">WlProEStart</span>();
}

<span class="kw">function</span> <span class="fu">WlModelOpen</span>()
<span class="co">//  Open a Pro/ENGINEER model.</span>
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);
  <span class="kw">if</span> (<span class="ot">document</span>.<span class="ot">main</span>.<span class="ot">ModelName</span>.<span class="fu">value</span> == <span class="st">&quot;&quot;</span>)
    <span class="kw">return</span> ;
  <span class="kw">var</span> ret = <span class="ot">document</span>.<span class="ot">pwl</span>.<span class="fu">pwlMdlOpen</span>(<span class="ot">document</span>.<span class="ot">main</span>.<span class="ot">ModelName</span>.<span class="fu">value</span>,
                    <span class="ot">document</span>.<span class="ot">main</span>.<span class="ot">ModelPath</span>.<span class="fu">value</span>, <span class="kw">true</span>);
  <span class="kw">if</span> (!<span class="ot">ret</span>.<span class="fu">Status</span>)
    {
      <span class="kw">if</span> (<span class="ot">ret</span>.<span class="fu">ErrorCode</span> == -<span class="dv">4</span> &amp;&amp; <span class="ot">document</span>.<span class="ot">main</span>.<span class="ot">ModelPath</span>.<span class="fu">value</span> == <span class="st">&quot;&quot;</span>)
    <span class="kw">return</span> ;
      <span class="kw">else</span>
        {
      <span class="fu">alert</span>(<span class="st">&quot;pwlMdlOpen failed (&quot;</span> + <span class="ot">ret</span>.<span class="fu">ErrorCode</span> + <span class="st">&quot;)&quot;</span>);
      <span class="kw">return</span> ;
        }
    }
}

<span class="kw">function</span> <span class="fu">WlModelRegenerate</span>()
<span class="co">//  Regenerate the Pro/ENGINEER model.</span>
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);
  <span class="kw">var</span> ret = <span class="ot">document</span>.<span class="ot">pwl</span>.<span class="fu">pwlMdlRegenerate</span>(<span class="ot">document</span>.<span class="ot">main</span>.<span class="ot">ModelNameExt</span>.<span class="fu">value</span>);
  <span class="kw">if</span> (!<span class="ot">ret</span>.<span class="fu">Status</span>)
    {
      <span class="fu">alert</span>(<span class="st">&quot;pwlMdlRegenerate failed (&quot;</span> + <span class="ot">ret</span>.<span class="fu">ErrorCode</span> + <span class="st">&quot;)&quot;</span>);
      <span class="kw">return</span> ;
    }
}

<span class="kw">function</span> <span class="fu">WlModelSave</span>()
<span class="co">//  Save a Pro/ENGINEER model.</span>
{ 
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);
  <span class="kw">var</span> ret = <span class="ot">document</span>.<span class="ot">pwl</span>.<span class="fu">pwlMdlSaveAs</span>(<span class="ot">document</span>.<span class="ot">main</span>.<span class="ot">ModelNameExt</span>.<span class="fu">value</span>, <span class="kw">void</span> <span class="kw">null</span>, <span class="kw">void</span> <span class="kw">null</span>);
  <span class="kw">if</span> (!<span class="ot">ret</span>.<span class="fu">Status</span>)
    {
      <span class="fu">alert</span>(<span class="st">&quot;pwlMdlSaveAs failed (&quot;</span> + <span class="ot">ret</span>.<span class="fu">ErrorCode</span> + <span class="st">&quot;)&quot;</span>);
      <span class="kw">return</span> ;
    }
}

<span class="kw">function</span> <span class="fu">WlModelSaveAs</span>()
<span class="co">//  Save a Pro/ENGINEER model under a new name.</span>
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);
  <span class="kw">var</span> NewPath = <span class="ot">document</span>.<span class="ot">main</span>.<span class="ot">NewPath</span>.<span class="fu">value</span>;
  <span class="kw">var</span> NewName = <span class="ot">document</span>.<span class="ot">main</span>.<span class="ot">NewName</span>.<span class="fu">value</span>;
  <span class="kw">if</span> (NewPath == <span class="st">&quot;&quot;</span>)
    {
      NewPath = <span class="kw">void</span> <span class="kw">null</span>;
    }
  <span class="kw">if</span> (NewName == <span class="st">&quot;&quot;</span>)
    {
      NewName = <span class="kw">void</span> <span class="kw">null</span>;
    }
  <span class="kw">var</span> ret = <span class="ot">document</span>.<span class="ot">pwl</span>.<span class="fu">pwlMdlSaveAs</span>(<span class="ot">document</span>.<span class="ot">main</span>.<span class="ot">ModelNameExt</span>.<span class="fu">value</span>,
                      NewPath, NewName);
  <span class="kw">if</span> (!<span class="ot">ret</span>.<span class="fu">Status</span>)
    {
      <span class="fu">alert</span>(<span class="st">&quot;pwlMdlSaveAs failed (&quot;</span> + <span class="ot">ret</span>.<span class="fu">ErrorCode</span> + <span class="st">&quot;)&quot;</span>);
      <span class="kw">return</span> ;
    }
}

<span class="kw">function</span> <span class="fu">WlWindowRepaint</span>()
<span class="co">//  Repaint the active window.</span>
{
  <span class="kw">if</span> (!<span class="fu">pfcIsWindows</span>())
    <span class="ot">netscape</span>.<span class="ot">security</span>.<span class="ot">PrivilegeManager</span>.<span class="fu">enablePrivilege</span>(<span class="st">&quot;UniversalXPConnect&quot;</span>);
  <span class="kw">var</span> get_ret = <span class="ot">document</span>.<span class="ot">pwl</span>.<span class="fu">pwlWindowActiveGet</span>();
  <span class="kw">if</span> (!<span class="ot">get_ret</span>.<span class="fu">Status</span>)
    {
      <span class="fu">alert</span>(<span class="st">&quot;pwlWindowActiveGet failed (&quot;</span> + <span class="ot">get_ret</span>.<span class="fu">ErrorCode</span> + <span class="st">&quot;)&quot;</span>);
      <span class="kw">return</span> ;
    }
  <span class="co">/* You can also repaint the active window using -1 as the window</span>
<span class="co">     identifier. */</span>
  <span class="kw">var</span> ret = <span class="ot">document</span>.<span class="ot">pwl</span>.<span class="fu">pwlWindowRepaint</span>(<span class="fu">parseInt</span>(<span class="ot">get_ret</span>.<span class="fu">WindowID</span>));
  <span class="kw">if</span> (!<span class="ot">ret</span>.<span class="fu">Status</span>)
    {
      <span class="fu">alert</span>(<span class="st">&quot;pwlWindowRepaint failed (&quot;</span> + <span class="ot">ret</span>.<span class="fu">ErrorCode</span> + <span class="st">&quot;)&quot;</span>);
      <span class="kw">return</span> ;
    }
}

<span class="co">// Define the form with all the buttons to perform the above actions.</span>
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;form name=&#39;main&#39;&gt;&quot;</span>);

<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;hr&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;h4&gt;Main Controls&lt;/h4&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;p&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;center&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;input type=&#39;button&#39; value=&#39;Start Pro/E&#39; onclick=&#39;WlProEStart()&#39;&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;input type=&#39;button&#39; value=&#39;Connect to Pro/E&#39; onclick=&#39;WlProEConnect()&#39;&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;p&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;Path: &lt;input type=&#39;text&#39; name=&#39;ModelPath&#39; onchange=&#39;WlModelOpen()&#39;&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;spacer size=20&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;Model: &lt;input type=&#39;text&#39; name=&#39;ModelName&#39; onchange=&#39;WlModelOpen()&#39;&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;spacer size=20&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;input type=&#39;button&#39; value=&#39;Open Model&#39; onclick=&#39;WlModelOpen()&#39;&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;p&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;table&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;tr&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;td&gt;&lt;center&gt;Model:&lt;/center&gt;&lt;/td&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;td&gt;&lt;center&gt;New Path:&lt;/center&gt;&lt;/td&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;td&gt;&lt;center&gt;New Name:&lt;/center&gt;&lt;/td&gt;&lt;/tr&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;tr&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;td&gt;&lt;input type=&#39;text&#39; name=&#39;ModelNameExt&#39;&gt;&lt;/td&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;td&gt;&lt;input type=&#39;text&#39; name=&#39;NewPath&#39;&gt;&lt;/td&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;td&gt;&lt;input type=&#39;text&#39; name=&#39;NewName&#39;&gt;&lt;/td&gt;&lt;/tr&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;/table&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;input type=&#39;button&#39; value=&#39;Regenerate Model&#39; onclick=&#39;WlModelRegenerate()&#39;&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;spacer size=10&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;input type=&#39;button&#39; value=&#39;Save Model&#39; onclick=&#39;WlModelSave()&#39;&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;spacer size=10&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;input type=&#39;button&#39; value=&#39;Save Model As&#39; onclick=&#39;WlModelSaveAs()&#39;&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;p&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;input type=&#39;button&#39; value=&#39;REPAINT  SCREEN&#39; onclick=&#39;WlWindowRepaint()&#39;&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;/center&gt;&quot;</span>);
<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;hr&gt;&quot;</span>);

<span class="ot">document</span>.<span class="fu">writeln</span>(<span class="st">&quot;&lt;/form&gt;&quot;</span>);</code></pre>
<h1 id="collaborative-engine-for-distributed-mechanical-design">Collaborative Engine for Distributed Mechanical Design</h1>
<p>分散式機械設計協同引擎</p>
<p>Qianfu Ni and Wen Feng Lu</p>
<h1 id="abstract">Abstract</h1>
<p>摘要</p>
<p>Effective collaboration is essential for engineers at geographically dispersed locations to accomplish good design with less iteration.</p>
<p>分散在世界各地的工程師若希望以較少的重複流程來完成好的設計, 需要仰賴有效率的協同.</p>
<p>Over the last several years, more and more efforts have been put into such research as many industries have distributed their product development to locations with knowledge force.</p>
<p>過去幾年, 有越來越多的業者將心力投注在利用各地的知識人力來進行分散式產品開發.</p>
<p>This paper presents a collaborative engine to facilitate collaborations among distributed mechanical designs.</p>
<p>本論文提出一種協同引擎(設計), 可用來協助分散式機械設計有效進行協同.</p>
<p>Using component-based software technology, collaboration functionality is developed into a set of groupware that makes the collaborative engine applicable to develop new collaborative applications or integrate legacy applications into collaborative environments.</p>
<p>(本研究)運用元件導向的軟體技術, 將協同功能置入組群組軟體中, 讓此一協同系統可以用來開發新的協同應用或將傳統應用程式與協同環境加以整合.</p>
<p>An XML-based information representation is developed to streamline the information transmission within the distributed environment.</p>
<p>(本研究)採用以 XML 為基礎的資訊表示法, 以便讓分散式環境中的資訊傳遞得以流暢進行.</p>
<p>A case study is carried out to show how this engine facilitates designers to collaboratively create a 3D solid model of a same part in real time.</p>
<p>(本研究)利用案例研究來說明此一(協同)引擎如何有效協助設計者以即時協同模式建立 3D 實體模型.</p>
<p>Keywords: collaboration, distributed design, collaborative engine</p>
<p>關鍵字: 協同, 分散式設計, 協同引擎</p>
<p>人偶零件: http://2014cda-mdenfu.rhcloud.com/cmsimply/download/?filepath=/var/lib/openshift/5356315e4382ec2b3f000557/app-root/data//downloads/lego_man.7z</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="ot">@language</span> python

<span class="ch">import</span> cherrypy

<span class="co"># 這是 MAN 類別的定義</span>
<span class="co">&#39;&#39;&#39;</span>
<span class="co"># 在 application 中導入子模組</span>
<span class="co">import programs.cdag30.man as cdag30_man</span>
<span class="co"># 加入 cdag30 模組下的 man.py 且以子模組 man 對應其 MAN() 類別</span>
<span class="co">root.cdag30.man = cdag30_man.MAN()</span>

<span class="co"># 完成設定後, 可以利用</span>
<span class="co">/cdag30/man/assembly</span>
<span class="co"># 呼叫 man.py 中 MAN 類別的 assembly 方法</span>
<span class="co">&#39;&#39;&#39;</span>
<span class="kw">class</span> MAN(<span class="dt">object</span>):
    <span class="co"># 各組利用 index 引導隨後的程式執行</span>
    <span class="ot">@cherrypy.expose</span>
    <span class="kw">def</span> index(<span class="ot">self</span>, *args, **kwargs):
        outstring = <span class="st">&#39;&#39;&#39;</span>
<span class="st">這是 2014CDA 協同專案下的 cdag30 模組下的 MAN 類別.&lt;br /&gt;&lt;br /&gt;</span>
<span class="st">&lt;!-- 這裡採用相對連結, 而非網址的絕對連結 (這一段為 html 註解) --&gt;</span>
<span class="st">&lt;a href=&quot;assembly&quot;&gt;執行  MAN 類別中的 assembly 方法&lt;/a&gt;&lt;br /&gt;&lt;br /&gt;</span>
<span class="st">請確定下列零件於 V:/home/lego/man 目錄中, 且開啟空白 Creo 組立檔案.&lt;br /&gt;</span>
<span class="st">&lt;a href=&quot;/static/lego_man.7z&quot;&gt;lego_man.7z&lt;/a&gt;(滑鼠右鍵存成 .7z 檔案)&lt;br /&gt;</span>
<span class="st">&#39;&#39;&#39;</span>
        <span class="kw">return</span> outstring

    <span class="ot">@cherrypy.expose</span>
    <span class="kw">def</span> assembly(<span class="ot">self</span>, *args, **kwargs):
        outstring = <span class="st">&#39;&#39;&#39;</span>
<span class="st">&lt;!DOCTYPE html&gt; </span>
<span class="st">&lt;html&gt;</span>
<span class="st">&lt;head&gt;</span>
<span class="st">&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;</span>
<span class="st">&lt;script type=&quot;text/javascript&quot; src=&quot;/static/weblink/examples/jscript/pfcUtils.js&quot;&gt;&lt;/script&gt;</span>
<span class="st">&lt;/head&gt;</span>
<span class="st">&lt;body&gt;</span>
<span class="st">&lt;/script&gt;&lt;script language=&quot;JavaScript&quot;&gt;</span>
<span class="st">/*設計一個零件組立函示*/</span>
<span class="st">// featID 為組立件第一個組立零件的編號</span>
<span class="st">// inc 則為 part1 的組立順序編號, 第一個入組立檔編號為 featID+0</span>
<span class="st">// part2 為外加的零件名稱</span>
<span class="st">function axis_plane_assembly(session, assembly, transf, featID, inc, part2, axis1, plane1, axis2, plane2){</span>
<span class="st">var descr = pfcCreate(&quot;pfcModelDescriptor&quot;).CreateFromFileName (&quot;v:/home/lego/man/&quot;+part2);</span>
<span class="st">var componentModel = session.GetModelFromDescr(descr);</span>
<span class="st">var componentModel = session.RetrieveModel(descr);</span>
<span class="st">if (componentModel != void null)</span>
<span class="st">{</span>
<span class="st">    var asmcomp = assembly.AssembleComponent (componentModel, transf);</span>
<span class="st">}</span>
<span class="st">var ids = pfcCreate(&quot;intseq&quot;);</span>
<span class="st">ids.Append(featID+inc);</span>
<span class="st">var subPath = pfcCreate(&quot;MpfcAssembly&quot;).CreateComponentPath(assembly, ids);</span>
<span class="st">subassembly = subPath.Leaf;</span>
<span class="st">var asmDatums = new Array(axis1, plane1);</span>
<span class="st">var compDatums = new Array(axis2, plane2);</span>
<span class="st">var relation = new Array (pfcCreate(&quot;pfcComponentConstraintType&quot;).ASM_CONSTRAINT_ALIGN, pfcCreate(&quot;pfcComponentConstraintType&quot;).ASM_CONSTRAINT_MATE);</span>
<span class="st">var relationItem = new Array(pfcCreate(&quot;pfcModelItemType&quot;).ITEM_AXIS, pfcCreate(&quot;pfcModelItemType&quot;).ITEM_SURFACE);</span>
<span class="st">var constrs = pfcCreate(&quot;pfcComponentConstraints&quot;);</span>
<span class="st">    for (var i = 0; i &lt; 2; i++)</span>
<span class="st">    {</span>
<span class="st">        var asmItem = subassembly.GetItemByName (relationItem[i], asmDatums [i]);</span>
<span class="st">        if (asmItem == void null)</span>
<span class="st">        {</span>
<span class="st">            interactFlag = true;</span>
<span class="st">            continue;</span>
<span class="st">        }</span>
<span class="st">        var compItem = componentModel.GetItemByName (relationItem[i], compDatums [i]);</span>
<span class="st">        if (compItem == void null)</span>
<span class="st">        {</span>
<span class="st">            interactFlag = true;</span>
<span class="st">            continue;</span>
<span class="st">        }</span>
<span class="st">        var MpfcSelect = pfcCreate (&quot;MpfcSelect&quot;);</span>
<span class="st">        var asmSel = MpfcSelect.CreateModelItemSelection (asmItem, subPath);</span>
<span class="st">        var compSel = MpfcSelect.CreateModelItemSelection (compItem, void null);</span>
<span class="st">        var constr = pfcCreate(&quot;pfcComponentConstraint&quot;).Create (relation[i]);</span>
<span class="st">        constr.AssemblyReference  = asmSel;</span>
<span class="st">        constr.ComponentReference = compSel;</span>
<span class="st">        constr.Attributes = pfcCreate(&quot;pfcConstraintAttributes&quot;).Create (true, false);</span>
<span class="st">        constrs.Append(constr);</span>
<span class="st">    }</span>
<span class="st">asmcomp.SetConstraints(constrs, void null);</span>
<span class="st">}</span>
<span class="st">// 以上為 axis_plane_assembly() 函式</span>
<span class="st">//</span>
<span class="st">function three_plane_assembly(session, assembly, transf, featID, inc, part2, plane1, plane2, plane3, plane4, plane5, plane6){</span>
<span class="st">var descr = pfcCreate(&quot;pfcModelDescriptor&quot;).CreateFromFileName (&quot;v:/home/lego/man/&quot;+part2);</span>
<span class="st">var componentModel = session.GetModelFromDescr(descr);</span>
<span class="st">var componentModel = session.RetrieveModel(descr);</span>
<span class="st">if (componentModel != void null)</span>
<span class="st">{</span>
<span class="st">    var asmcomp = assembly.AssembleComponent (componentModel, transf);</span>
<span class="st">}</span>
<span class="st">var ids = pfcCreate(&quot;intseq&quot;);</span>
<span class="st">ids.Append(featID+inc);</span>
<span class="st">var subPath = pfcCreate(&quot;MpfcAssembly&quot;).CreateComponentPath(assembly, ids);</span>
<span class="st">subassembly = subPath.Leaf;</span>
<span class="st">var constrs = pfcCreate(&quot;pfcComponentConstraints&quot;);</span>
<span class="st">var asmDatums = new Array(plane1, plane2, plane3);</span>
<span class="st">var compDatums = new Array(plane4, plane5, plane6);</span>
<span class="st">var MpfcSelect = pfcCreate(&quot;MpfcSelect&quot;);</span>
<span class="st">for (var i = 0; i &lt; 3; i++)</span>
<span class="st">{</span>
<span class="st">    var asmItem = subassembly.GetItemByName(pfcCreate(&quot;pfcModelItemType&quot;).ITEM_SURFACE, asmDatums[i]);</span>
<span class="st">    </span>
<span class="st">    if (asmItem == void null)</span>
<span class="st">    {</span>
<span class="st">        interactFlag = true;</span>
<span class="st">        continue;</span>
<span class="st">    }</span>
<span class="st">    var compItem = componentModel.GetItemByName(pfcCreate(&quot;pfcModelItemType&quot;).ITEM_SURFACE, compDatums[i]);</span>
<span class="st">    if (compItem == void null)</span>
<span class="st">    {</span>
<span class="st">        interactFlag = true;</span>
<span class="st">        continue;</span>
<span class="st">    }</span>
<span class="st">    var asmSel = MpfcSelect.CreateModelItemSelection(asmItem, subPath);</span>
<span class="st">    var compSel = MpfcSelect.CreateModelItemSelection(compItem, void null);</span>
<span class="st">    var constr = pfcCreate(&quot;pfcComponentConstraint&quot;).Create(pfcCreate(&quot;pfcComponentConstraintType&quot;).ASM_CONSTRAINT_MATE);</span>
<span class="st">    constr.AssemblyReference = asmSel;</span>
<span class="st">    constr.ComponentReference = compSel;</span>
<span class="st">    constr.Attributes = pfcCreate(&quot;pfcConstraintAttributes&quot;).Create (false, false);</span>
<span class="st">    constrs.Append(constr);</span>
<span class="st">}</span>
<span class="st">asmcomp.SetConstraints(constrs, void null);</span>
<span class="st">}</span>
<span class="st">// 以上為 three_plane_assembly() 函式</span>
<span class="st">//</span>
<span class="st">// 假如 Creo 所在的操作系統不是 Windows 環境</span>
<span class="st">if (!pfcIsWindows())</span>
<span class="st">// 則啟動對應的 UniversalXPConnect 執行權限 (等同 Windows 下的 ActiveX)</span>
<span class="st">netscape.security.PrivilegeManager.enablePrivilege(&quot;UniversalXPConnect&quot;);</span>
<span class="st">// pfcGetProESession() 是位於 pfcUtils.js 中的函式, 確定此 JavaScript 是在嵌入式瀏覽器中執行</span>
<span class="st">var session = pfcGetProESession();</span>
<span class="st">// 設定 config option, 不要使用元件組立流程中內建的假設約束條件</span>
<span class="st">session.SetConfigOption(&quot;comp_placement_assumptions&quot;,&quot;no&quot;);</span>
<span class="st">// 建立擺放零件的位置矩陣, Pro/Web.Link 中的變數無法直接建立, 必須透過 pfcCreate() 建立</span>
<span class="st">var identityMatrix = pfcCreate(&quot;pfcMatrix3D&quot;);</span>
<span class="st">// 建立 identity 位置矩陣</span>
<span class="st">for (var x = 0; x &lt; 4; x++)</span>
<span class="st">for (var y = 0; y &lt; 4; y++)</span>
<span class="st">{</span>
<span class="st">    if (x == y)</span>
<span class="st">        identityMatrix.Set(x, y, 1.0);</span>
<span class="st">    else</span>
<span class="st">        identityMatrix.Set(x, y, 0.0);</span>
<span class="st">}</span>
<span class="st">// 利用 identityMatrix 建立 transf 座標轉換矩陣</span>
<span class="st">var transf = pfcCreate(&quot;pfcTransform3D&quot;).Create(identityMatrix);</span>
<span class="st">// 取得目前的工作目錄</span>
<span class="st">var currentDir = session.getCurrentDirectory();</span>
<span class="st">// 以目前已開檔的空白組立檔案, 作為 model</span>
<span class="st">var model = session.CurrentModel;</span>
<span class="st">// 查驗有無 model, 或 model 類別是否為組立件, 若不符合條件則丟出錯誤訊息</span>
<span class="st">if (model == void null || model.Type != pfcCreate(&quot;pfcModelType&quot;).MDL_ASSEMBLY)</span>
<span class="st">throw new Error (0, &quot;Current model is not an assembly.&quot;);</span>
<span class="st">// 將此模型設為組立物件</span>
<span class="st">var assembly = model;</span>

<span class="st">/**---------------------- LEGO_BODY--------------------**/</span>
<span class="st">// 設定零件的 descriptor 物件變數</span>
<span class="st">var descr = pfcCreate(&quot;pfcModelDescriptor&quot;).CreateFromFileName(&quot;v:/home/lego/man/LEGO_BODY.prt&quot;);</span>
<span class="st">// 若零件在 session 則直接取用</span>
<span class="st">var componentModel = session.GetModelFromDescr(descr);</span>
<span class="st">// 若零件不在 session 則從工作目錄中載入 session</span>
<span class="st">var componentModel = session.RetrieveModel(descr);</span>
<span class="st">// 若零件已經在 session 中則放入組立檔中</span>
<span class="st">if (componentModel != void null)</span>
<span class="st">{</span>
<span class="st">    // 注意這個 asmcomp 即為設定約束條件的本體</span>
<span class="st">    // asmcomp 為特徵物件, 直接將零件, 以 transf 座標轉換矩陣方位放入組立檔案中</span>
<span class="st">    var asmcomp = assembly.AssembleComponent(componentModel, transf);</span>
<span class="st">}</span>

<span class="st">// 建立約束條件變數</span>
<span class="st">var constrs = pfcCreate(&quot;pfcComponentConstraints&quot;);</span>
<span class="st">// 設定組立檔中的三個定位面, 注意內定名稱與 Pro/E WF 中的 ASM_D_FRONT 不同, 而是 ASM_FRONT, 可在組立件-&gt;info-&gt;model 中查詢定位面名稱</span>
<span class="st">// 組立檔案中的 Datum 名稱也可以利用 View-&gt;plane tag display 查詢名稱</span>
<span class="st">// 建立組立參考面所組成的陣列</span>
<span class="st">var asmDatums = new Array(&quot;ASM_FRONT&quot;, &quot;ASM_TOP&quot;, &quot;ASM_RIGHT&quot;);</span>
<span class="st">// 設定零件檔中的三個定位面, 名稱與 Pro/E WF 中相同</span>
<span class="st">var compDatums = new Array(&quot;FRONT&quot;, &quot;TOP&quot;, &quot;RIGHT&quot;);</span>
<span class="st">// 建立 ids 變數, intseq 為 sequence of integers 為資料類別, 使用者可以經由整數索引擷取此資料類別的元件, 第一個索引為 0</span>
<span class="st">       // intseq 等同 Python 的數列資料?</span>
<span class="st">var ids = pfcCreate(&quot;intseq&quot;);</span>
<span class="st">// 利用 assembly 物件模型, 建立路徑變數</span>
<span class="st">var path = pfcCreate(&quot;MpfcAssembly&quot;).CreateComponentPath(assembly, ids);</span>
<span class="st">// 採用互動式設定相關的變數, MpfcSelect 為 Module level class 中的一種</span>
<span class="st">var MpfcSelect = pfcCreate(&quot;MpfcSelect&quot;);</span>
<span class="st">// 利用迴圈分別約束組立與零件檔中的三個定位平面</span>
<span class="st">for (var i = 0; i &lt; 3; i++)</span>
<span class="st">{</span>
<span class="st">// 設定組立參考面, 也就是 &quot;ASM_FRONT&quot;, &quot;ASM_TOP&quot;, &quot;ASM_RIGHT&quot; 等三個 datum planes</span>
<span class="st">var asmItem = assembly.GetItemByName (pfcCreate(&quot;pfcModelItemType&quot;).ITEM_SURFACE, asmDatums[i]);</span>
<span class="st">// 若無對應的組立參考面, 則啟用互動式平面選擇表單 flag</span>
<span class="st">if (asmItem == void null)</span>
<span class="st">{</span>
<span class="st">    interactFlag = true;</span>
<span class="st">    continue;</span>
<span class="st">}</span>
<span class="st">// 設定零件參考面, 也就是 &quot;FRONT&quot;, &quot;TOP&quot;, &quot;RIGHT&quot; 等三個 datum planes</span>
<span class="st">var compItem = componentModel.GetItemByName (pfcCreate (&quot;pfcModelItemType&quot;).ITEM_SURFACE, compDatums[i]);</span>
<span class="st">// 若無對應的零件參考面, 則啟用互動式平面選擇表單 flag</span>
<span class="st">if (compItem == void null)</span>
<span class="st">{</span>
<span class="st">    interactFlag = true;</span>
<span class="st">    continue;</span>
<span class="st">}</span>
<span class="st">        // 因為 asmItem 為組立件中的定位特徵, 必須透過 path 才能取得</span>
<span class="st">var asmSel = MpfcSelect.CreateModelItemSelection(asmItem, path);</span>
<span class="st">        // 而 compItem 則為零件, 沒有 path 路徑, 因此第二變數為 null</span>
<span class="st">var compSel = MpfcSelect.CreateModelItemSelection(compItem, void null);</span>
<span class="st">        // 利用 ASM_CONSTRAINT_ALIGN 對齊組立約束建立約束變數</span>
<span class="st">var constr = pfcCreate(&quot;pfcComponentConstraint&quot;).Create (pfcCreate (&quot;pfcComponentConstraintType&quot;).ASM_CONSTRAINT_ALIGN);</span>
<span class="st">        // 設定約束條件的組立參考與元件參考選擇</span>
<span class="st">constr.AssemblyReference = asmSel;</span>
<span class="st">constr.ComponentReference = compSel;</span>
<span class="st">       // 第一個變數為強制變數, 第二個為忽略變數</span>
<span class="st">       // 強制變數為 false, 表示不強制約束, 只有透過點與線對齊時需設為 true</span>
<span class="st">       // 忽略變數為 false, 約束條件在更新模型時是否忽略, 設為 false 表示不忽略</span>
<span class="st">       // 通常在組立 closed chain 機構時,  忽略變數必須設為 true, 才能完成約束</span>
<span class="st">       // 因為三個面絕對約束, 因此輸入變數為 false, false</span>
<span class="st">constr.Attributes = pfcCreate(&quot;pfcConstraintAttributes&quot;).Create (false, false);</span>
<span class="st">// 將互動選擇相關資料, 附加在程式約束變數之後</span>
<span class="st">constrs.Append(constr);</span>
<span class="st">}</span>

<span class="st">// 設定組立約束條件</span>
<span class="st">asmcomp.SetConstraints (constrs, void null);</span>
<span class="st">/**---------------------- LEGO_ARM_RT 右手上臂--------------------**/</span>
<span class="st">var descr = pfcCreate (&quot;pfcModelDescriptor&quot;).CreateFromFileName (&quot;v:/home/lego/man/LEGO_ARM_RT.prt&quot;);</span>
<span class="st">var componentModel = session.GetModelFromDescr(descr);</span>
<span class="st">var componentModel = session.RetrieveModel(descr);</span>
<span class="st">if (componentModel != void null)</span>
<span class="st">{</span>
<span class="st">        // 注意這個 asmcomp 即為設定約束條件的本體</span>
<span class="st">        // asmcomp 為特徵物件,直接將零件, 以 transf 座標轉換放入組立檔案中</span>
<span class="st">var asmcomp = assembly.AssembleComponent (componentModel, transf);</span>
<span class="st">}</span>
<span class="st">// 取得 assembly 項下的元件 id, 因為只有一個零件, 採用 index 0 取出其 featID</span>
<span class="st">var components = assembly.ListFeaturesByType(true, pfcCreate (&quot;pfcFeatureType&quot;).FEATTYPE_COMPONENT);</span>
<span class="st">// 此一 featID 為組立件中的第一個零件編號, 也就是樂高人偶的 body</span>
<span class="st">var featID = components.Item(0).Id;</span>

<span class="st">ids.Append(featID);</span>
<span class="st">// 在 assembly 模型中建立子零件所對應的路徑</span>
<span class="st">var subPath = pfcCreate(&quot;MpfcAssembly&quot;).CreateComponentPath(assembly, ids);</span>
<span class="st">subassembly = subPath.Leaf;</span>
<span class="st">// 以下針對 body 的 A_13 軸與 DTM1 基準面及右臂的  A_4 軸線與 DTM1 進行對齊與面接約束</span>
<span class="st">var asmDatums = new Array(&quot;A_13&quot;, &quot;DTM1&quot;);</span>
<span class="st">var compDatums = new Array(&quot;A_4&quot;, &quot;DTM1&quot;);</span>
<span class="st">// 組立的關係變數為對齊與面接</span>
<span class="st">var relation = new Array (pfcCreate (&quot;pfcComponentConstraintType&quot;).ASM_CONSTRAINT_ALIGN, pfcCreate (&quot;pfcComponentConstraintType&quot;).ASM_CONSTRAINT_MATE);</span>
<span class="st">// 組立元件則為軸與平面</span>
<span class="st">var relationItem = new Array(pfcCreate(&quot;pfcModelItemType&quot;).ITEM_AXIS, pfcCreate(&quot;pfcModelItemType&quot;).ITEM_SURFACE);</span>
<span class="st">// 建立約束條件變數, 軸採對齊而基準面則以面接進行約束</span>
<span class="st">var constrs = pfcCreate (&quot;pfcComponentConstraints&quot;);</span>
<span class="st">for (var i = 0; i &lt; 2; i++)</span>
<span class="st">{</span>
<span class="st">                  // 設定組立參考面, asmItem 為 model item</span>
<span class="st">    var asmItem = subassembly.GetItemByName (relationItem[i], asmDatums [i]);</span>
<span class="st">                  // 若無對應的組立參考面, 則啟用互動式平面選擇表單 flag</span>
<span class="st">    if (asmItem == void null)</span>
<span class="st">    {</span>
<span class="st">        interactFlag = true;</span>
<span class="st">        continue;</span>
<span class="st">    }</span>
<span class="st">                  // 設定零件參考面, compItem 為 model item</span>
<span class="st">    var compItem = componentModel.GetItemByName (relationItem[i], compDatums[i]);</span>
<span class="st">    if (compItem == void null)</span>
<span class="st">    {</span>
<span class="st">        interactFlag = true;</span>
<span class="st">        continue;</span>
<span class="st">    }</span>
<span class="st">                  // 採用互動式設定相關的變數</span>
<span class="st">    var MpfcSelect = pfcCreate (&quot;MpfcSelect&quot;);</span>
<span class="st">    var asmSel = MpfcSelect.CreateModelItemSelection (asmItem, subPath);</span>
<span class="st">    var compSel = MpfcSelect.CreateModelItemSelection (compItem, void null);</span>
<span class="st">    var constr = pfcCreate(&quot;pfcComponentConstraint&quot;).Create (relation[i]);</span>
<span class="st">    constr.AssemblyReference  = asmSel;</span>
<span class="st">    constr.ComponentReference = compSel;</span>
<span class="st">                  // 因為透過軸線對齊, 第一 force 變數需設為 true</span>
<span class="st">    constr.Attributes = pfcCreate(&quot;pfcConstraintAttributes&quot;).Create (true, false);</span>
<span class="st">                  // 將互動選擇相關資料, 附加在程式約束變數之後</span>
<span class="st">    constrs.Append(constr);</span>
<span class="st">}</span>
<span class="st">// 設定組立約束條件, 以 asmcomp 特徵進行約束條件設定</span>
<span class="st">// 請注意, 第二個變數必須為 void null 表示零件對零件進行約束, 若為 subPath, 則零件會與原始零件的平面進行約束</span>
<span class="st">asmcomp.SetConstraints (constrs, void null);</span>
<span class="st">/**---------------------- LEGO_ARM_LT 左手上臂--------------------**/</span>
<span class="st">var descr = pfcCreate (&quot;pfcModelDescriptor&quot;).CreateFromFileName (&quot;v:/home/lego/man/LEGO_ARM_LT.prt&quot;);</span>
<span class="st">var componentModel = session.GetModelFromDescr(descr);</span>
<span class="st">var componentModel = session.RetrieveModel(descr);</span>
<span class="st">if (componentModel != void null)</span>
<span class="st">{</span>
<span class="st">        // 注意這個 asmcomp 即為設定約束條件的本體</span>
<span class="st">        // asmcomp 為特徵物件,直接將零件, 以 transf 座標轉換放入組立檔案中</span>
<span class="st">var asmcomp = assembly.AssembleComponent(componentModel, transf);</span>
<span class="st">}</span>
<span class="st">// 取得 assembly 項下的元件 id, 因為只有一個零件, 採用 index 0 取出其 featID</span>
<span class="st">var components = assembly.ListFeaturesByType(true, pfcCreate (&quot;pfcFeatureType&quot;).FEATTYPE_COMPONENT);</span>
<span class="st">var ids = pfcCreate (&quot;intseq&quot;);</span>
<span class="st">// 因為左臂也是與 body 進行約束條件組立,  因此取 body 的 featID</span>
<span class="st">// 至此右臂 id 應該是 featID+1, 而左臂則是 featID+2</span>
<span class="st">ids.Append(featID);</span>
<span class="st">// 在 assembly 模型中建立子零件所對應的路徑</span>
<span class="st">var subPath = pfcCreate(&quot;MpfcAssembly&quot;).CreateComponentPath(assembly, ids);</span>
<span class="st">subassembly = subPath.Leaf;</span>
<span class="st">var asmDatums = new Array(&quot;A_9&quot;, &quot;DTM2&quot;);</span>
<span class="st">var compDatums = new Array(&quot;A_4&quot;, &quot;DTM1&quot;);</span>
<span class="st">var relation = new Array (pfcCreate (&quot;pfcComponentConstraintType&quot;).ASM_CONSTRAINT_ALIGN, pfcCreate (&quot;pfcComponentConstraintType&quot;).ASM_CONSTRAINT_MATE);</span>
<span class="st">var relationItem = new Array(pfcCreate(&quot;pfcModelItemType&quot;).ITEM_AXIS, pfcCreate(&quot;pfcModelItemType&quot;).ITEM_SURFACE);</span>
<span class="st">// 建立約束條件變數</span>
<span class="st">var constrs = pfcCreate (&quot;pfcComponentConstraints&quot;);</span>
<span class="st">for (var i = 0; i &lt; 2; i++)</span>
<span class="st">{</span>
<span class="st">                  // 設定組立參考面, asmItem 為 model item</span>
<span class="st">    var asmItem = subassembly.GetItemByName (relationItem[i], asmDatums [i]);</span>
<span class="st">                  // 若無對應的組立參考面, 則啟用互動式平面選擇表單 flag</span>
<span class="st">    if (asmItem == void null)</span>
<span class="st">    {</span>
<span class="st">        interactFlag = true;</span>
<span class="st">        continue;</span>
<span class="st">    }</span>
<span class="st">                  // 設定零件參考面, compItem 為 model item</span>
<span class="st">    var compItem = componentModel.GetItemByName (relationItem[i], compDatums [i]);</span>
<span class="st">    if (compItem == void null)</span>
<span class="st">    {</span>
<span class="st">        interactFlag = true;</span>
<span class="st">        continue;</span>
<span class="st">    }</span>
<span class="st">                  // 採用互動式設定相關的變數</span>
<span class="st">    var MpfcSelect = pfcCreate (&quot;MpfcSelect&quot;);</span>
<span class="st">    var asmSel = MpfcSelect.CreateModelItemSelection (asmItem, subPath);</span>
<span class="st">    var compSel = MpfcSelect.CreateModelItemSelection (compItem, void null);</span>
<span class="st">    var constr = pfcCreate(&quot;pfcComponentConstraint&quot;).Create (relation[i]);</span>
<span class="st">    constr.AssemblyReference  = asmSel;</span>
<span class="st">    constr.ComponentReference = compSel;</span>
<span class="st">    constr.Attributes = pfcCreate(&quot;pfcConstraintAttributes&quot;).Create (true, false);</span>
<span class="st">                  // 將互動選擇相關資料, 附加在程式約束變數之後</span>
<span class="st">    constrs.Append(constr);</span>
<span class="st">}</span>
<span class="st">// 設定組立約束條件, 以 asmcomp 特徵進行約束條件設定</span>
<span class="st">// 請注意, 第二個變數必須為 void null 表示零件對零件進行約束, 若為 subPath, 則零件會與原始零件的平面進行約束</span>
<span class="st">asmcomp.SetConstraints (constrs, void null);</span>
<span class="st">/**---------------------- LEGO_HAND 右手手腕--------------------**/</span>
<span class="st">// 右手臂 LEGO_ARM_RT.prt 基準  A_2, DTM2</span>
<span class="st">// 右手腕 LEGO_HAND.prt 基準 A_1, DTM3</span>
<span class="st">var descr = pfcCreate (&quot;pfcModelDescriptor&quot;).CreateFromFileName (&quot;v:/home/lego/man/LEGO_HAND.prt&quot;);</span>
<span class="st">var componentModel = session.GetModelFromDescr(descr);</span>
<span class="st">var componentModel = session.RetrieveModel(descr);</span>
<span class="st">if (componentModel != void null)</span>
<span class="st">{</span>
<span class="st">        // 注意這個 asmcomp 即為設定約束條件的本體</span>
<span class="st">        // asmcomp 為特徵物件,直接將零件, 以 transf 座標轉換放入組立檔案中</span>
<span class="st">var asmcomp = assembly.AssembleComponent (componentModel, transf);</span>
<span class="st">}</span>
<span class="st">// 取得 assembly 項下的元件 id, 因為只有一個零件, 採用 index 0 取出其 featID</span>
<span class="st">var components = assembly.ListFeaturesByType(true, pfcCreate (&quot;pfcFeatureType&quot;).FEATTYPE_COMPONENT);</span>
<span class="st">var ids = pfcCreate (&quot;intseq&quot;);</span>

<span class="st">// 組立件中 LEGO_BODY.prt 編號為 featID</span>
<span class="st">// LEGO_ARM_RT.prt 則是組立件第二個置入的零件,  編號為 featID+1</span>
<span class="st">ids.Append(featID+1);</span>
<span class="st">// 在 assembly 模型中, 根據子零件的編號, 建立子零件所對應的路徑</span>
<span class="st">var subPath = pfcCreate(&quot;MpfcAssembly&quot;).CreateComponentPath(assembly, ids);</span>
<span class="st">subassembly = subPath.Leaf;</span>
<span class="st">// 以下針對 LEGO_ARM_RT 的 A_2 軸與 DTM2 基準面及 HAND 的  A_1 軸線與 DTM3 進行對齊與面接約束</span>
<span class="st">var asmDatums = new Array(&quot;A_2&quot;, &quot;DTM2&quot;);</span>
<span class="st">var compDatums = new Array(&quot;A_1&quot;, &quot;DTM3&quot;);</span>
<span class="st">// 組立的關係變數為對齊與面接</span>
<span class="st">var relation = new Array (pfcCreate (&quot;pfcComponentConstraintType&quot;).ASM_CONSTRAINT_ALIGN, pfcCreate (&quot;pfcComponentConstraintType&quot;).ASM_CONSTRAINT_MATE);</span>
<span class="st">// 組立元件則為軸與平面</span>
<span class="st">var relationItem = new Array(pfcCreate(&quot;pfcModelItemType&quot;).ITEM_AXIS, pfcCreate(&quot;pfcModelItemType&quot;).ITEM_SURFACE);</span>
<span class="st">// 建立約束條件變數, 軸採對齊而基準面則以面接進行約束</span>
<span class="st">var constrs = pfcCreate (&quot;pfcComponentConstraints&quot;);</span>
<span class="st">for (var i = 0; i &lt; 2; i++)</span>
<span class="st">{</span>
<span class="st">                  // 設定組立參考面, asmItem 為 model item</span>
<span class="st">    var asmItem = subassembly.GetItemByName (relationItem[i], asmDatums [i]);</span>
<span class="st">                  // 若無對應的組立參考面, 則啟用互動式平面選擇表單 flag</span>
<span class="st">    if (asmItem == void null)</span>
<span class="st">    {</span>
<span class="st">        interactFlag = true;</span>
<span class="st">        continue;</span>
<span class="st">    }</span>
<span class="st">                  // 設定零件參考面, compItem 為 model item</span>
<span class="st">    var compItem = componentModel.GetItemByName (relationItem[i], compDatums [i]);</span>
<span class="st">    if (compItem == void null)</span>
<span class="st">    {</span>
<span class="st">        interactFlag = true;</span>
<span class="st">        continue;</span>
<span class="st">    }</span>
<span class="st">                  // 採用互動式設定相關的變數</span>
<span class="st">    var MpfcSelect = pfcCreate(&quot;MpfcSelect&quot;);</span>
<span class="st">    var asmSel = MpfcSelect.CreateModelItemSelection(asmItem, subPath);</span>
<span class="st">    var compSel = MpfcSelect.CreateModelItemSelection (compItem, void null);</span>
<span class="st">    var constr = pfcCreate(&quot;pfcComponentConstraint&quot;).Create (relation[i]);</span>
<span class="st">    constr.AssemblyReference  = asmSel;</span>
<span class="st">    constr.ComponentReference = compSel;</span>
<span class="st">                  // 因為透過軸線對齊, 第一 force 變數需設為 true</span>
<span class="st">    constr.Attributes = pfcCreate(&quot;pfcConstraintAttributes&quot;).Create (true, false);</span>
<span class="st">                  // 將互動選擇相關資料, 附加在程式約束變數之後</span>
<span class="st">    constrs.Append(constr);</span>
<span class="st">}</span>
<span class="st">// 設定組立約束條件, 以 asmcomp 特徵進行約束條件設定</span>
<span class="st">// 請注意, 第二個變數必須為 void null 表示零件對零件進行約束, 若為 subPath, 則零件會與原始零件的平面進行約束</span>
<span class="st">asmcomp.SetConstraints (constrs, void null);</span>
<span class="st">// 利用函式呼叫組立左手 HAND</span>
<span class="st">axis_plane_assembly(session, assembly, transf, featID, 2, </span>
<span class="st">                              &quot;LEGO_HAND.prt&quot;, &quot;A_2&quot;, &quot;DTM2&quot;, &quot;A_1&quot;, &quot;DTM3&quot;);</span>
<span class="st">// 利用函式呼叫組立人偶頭部 HEAD</span>
<span class="st">// BODY id 為 featID+0, 以 A_2 及  DTM3 約束</span>
<span class="st">// HEAD 則直接呼叫檔案名稱, 以 A_2, DTM2 約束</span>
<span class="st">axis_plane_assembly(session, assembly, transf, featID, 0, </span>
<span class="st">                              &quot;LEGO_HEAD.prt&quot;, &quot;A_2&quot;, &quot;DTM3&quot;, &quot;A_2&quot;, &quot;DTM2&quot;);</span>
<span class="st">// Body 與 WAIST 採三個平面約束組立</span>
<span class="st">// Body 組立面為 DTM4, DTM5, DTM6</span>
<span class="st">// WAIST 組立面為 DTM1, DTM2, DTM3</span>
<span class="st">three_plane_assembly(session, assembly, transf, featID, 0, &quot;LEGO_WAIST.prt&quot;, &quot;DTM4&quot;, &quot;DTM5&quot;, &quot;DTM6&quot;, &quot;DTM1&quot;, &quot;DTM2&quot;, &quot;DTM3&quot;); </span>
<span class="st">// 右腳</span>
<span class="st">axis_plane_assembly(session, assembly, transf, featID, 6, </span>
<span class="st">                              &quot;LEGO_LEG_RT.prt&quot;, &quot;A_8&quot;, &quot;DTM4&quot;, &quot;A_10&quot;, &quot;DTM1&quot;);</span>
<span class="st">// 左腳</span>
<span class="st">axis_plane_assembly(session, assembly, transf, featID, 6, </span>
<span class="st">                              &quot;LEGO_LEG_LT.prt&quot;, &quot;A_8&quot;, &quot;DTM5&quot;, &quot;A_10&quot;, &quot;DTM1&quot;);</span>
<span class="st">// 紅帽</span>
<span class="st">axis_plane_assembly(session, assembly, transf, featID, 5, </span>
<span class="st">                              &quot;LEGO_HAT.prt&quot;, &quot;A_2&quot;, &quot;TOP&quot;, &quot;A_2&quot;, &quot;FRONT&quot;);     </span>
<span class="st">&lt;/script&gt;</span>
<span class="st">&lt;/body&gt;</span>
<span class="st">&lt;/html&gt;</span>
<span class="st">&#39;&#39;&#39;</span>
        <span class="kw">return</span> outstring</code></pre>
<h1 id="cd2ag10報告2ag10">cd2ag10報告(2ag10)</h1>
<p>以下為各週報告</p>
<h1 id="第十組組員">第十組組員</h1>
<p>小組網站:http://goo.gl/aztMHi</p>
<p>40123116-吳羽閔</p>
<p>40123118-吳謦麟</p>
<p>40123153-戴志軒</p>
<h1 id="第八週考試摘要2ag10">第八週考試摘要(2ag10)</h1>
<p>小組網站:http://goo.gl/yi3qJ5</p>
2014S CD Week8
<td>
<p>課程教材:</p>
A collaborative writing approach to wikis
<td>
Collabrative engine for distributed mechanical design
<td>
Web-based collaborative engineering support system
<td>
第八週考試題目
<td>
<p>下列題目完成後, 必須(1)將程式碼送到個人的 Bitbucket repository 下(2)程式可在近端與雲端部署執行(3)在 wiki.mde.tw 個人第八週心得中留下 Bitbucket 與雲端執行連結(4)整理出一份小考第一(二, 或三)題的 PDF 檔案, 寄到 course@mde.tw, 標題為: 學號-小考第一(二, 或三)題, 內容必須包含程式碼, 解題過程, 解題心得, Bitbucket 連結, 雲端網址等資料.</p>
(第一題) 請寫一個執行時可以列出 9×9 乘法表的網際 Python 程式, 然後 Push 到個人 bitbucket 空間, 而且同步指到 OpenShift 個人帳號上執行.
<td>
(第二題) 請將上述執行過程錄為 flv 後, 上傳到個人的 Vemeo 空間中, 並將網址回報到各組網站 (dokuwiki 與 CMSimply)與報告中, 並且將相關心得與報告連結登錄到 wiki.mde.tw 第八週的分組頁面中.
<td>
<p>(第三題) (協同計分, 分組進行) 請在各組的雲端 dowiki 中,根據下列 40 個帳號與密碼, 新增對應的使用者帳號與密碼後, 將雲端網址登錄在 wiki.mde.tw 各組第八週頁面中, 並說明操作過程與心得後, 將心得整理成 pdf 後繳交到 course@mde.tw.</p>
40 個帳號與密碼
<td>

58B39 , 9J35UAVM
<td>
3624D , QANF34CW
<td>
7345B , 3PAFXKWZ
<td>
358DA , E6RJFKW4
<td>
3BC7B , HG2ASNYH
<td>
CA55C , XUZTHWQK
<td>
D2756 , UHK2W3D2
<td>
368B8 , A5QGYA6W
<td>
7948A , PF278WDQ
<td>
C65C4 , GT4KBCXU
<td>
A8964 , 3RPQSW2U
<td>
22422 , 7E57K7F3
<td>
9A5B4 , 4MVKRE5Z
<td>
B5A76 , 3DTAAHUF
<td>
57388 , NP39FGXR
<td>
8A833 , C7DNBHCQ
<td>
29AB8 , 6KMGK73Z
<td>
5ABD2 , PV5FH722
<td>
86293 , PJ69FBMS
<td>
9DCBC , U5HR6QR8
<td>
276DD , URE9FNWD
<td>
599AA , X2P6CTXF
<td>
9C449 , DKRN3V59
<td>
64236 , 86UWN3E9
<td>
43AAC , MNCJZCAX
<td>
73B93 , QX945VJJ
<td>
36283 , M3MQGUXD
<td>
7447C , TQZVDKPT
<td>
C73AB , MSP4GPPX
<td>
8284B , XMT8W9RD
<td>
62454 , SD4C7V89
<td>
44B3C , 636DBRJC
<td>
C75CB , M66RMMQ2
<td>
4A3CB , FF485EQ4
<td>
7D248 , FGJHQDAS
<td>
A7CC4 , R47AHA4Y
<td>
99BCC , RNQYZGQZ
<td>
6DA77 , HRCDP9D8
<td>
357AB , CKB4Q2EC
<td>
A9525 , JDVX75ST
<td>


<p>第八週協同設計練習題目:</p>
建立各組 OpenShift 上的 dokuwiki
<td>
http://ethercalc.tw/ Openshift 上的 ethercalc
<td>
近端的 ethercalc
<td>
用 markdown 編輯電子書: https://github.com/progit/progit ,
<td> 
http://johnmacfarlane.net/pandoc/epub.html
<td>
期中考試與分組報告必選題
<td>
請以三組共 9 個人的情況下(座位為 3×3 配置), 分析2014s_week3的協同設計題目, 如何配置座位可以得到團隊的最大配分. 假如將組別擴大為五組共 15 人的情況下(座位為 4×4 配置, 則團隊座位安排後的最大配合又是多少?
<td>
<p>上課影片 http://vimeo.com/user24079973/videos</p>
<h1 id="第八週報告2ag10">第八週報告(2ag10)</h1>
<p>小組網站:http://goo.gl/YCNd7p</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="ch">import</span> cherrypy
<span class="kw">class</span> HelloWorld(<span class="dt">object</span>):
    <span class="ot">@cherrypy.expose</span>
    <span class="kw">def</span> index(<span class="ot">self</span>, var1=<span class="dv">9</span>, var2=<span class="dv">9</span>):
        <span class="co"># initialize outstring</span>
        outstring = <span class="st">&quot;&quot;</span>
        <span class="co"># initialize count</span>
        count = <span class="dv">0</span>
        d = <span class="dt">int</span>(var1)
        e = <span class="dt">int</span>(var2)+<span class="dv">1</span>
        <span class="kw">for</span> i in <span class="dt">range</span>(<span class="dv">1</span>, d):
            <span class="kw">for</span> j in <span class="dt">range</span>(<span class="dv">1</span>, e):
                count += <span class="dv">1</span>
                <span class="co">#print(count)</span>
                <span class="kw">if</span> count%(<span class="dt">int</span>(var2)) == <span class="dv">0</span>:
                    outstring += <span class="st">&quot;&lt;td&gt;&quot;</span>+<span class="dt">str</span>(i) + <span class="st">&quot;*&quot;</span> + <span class="dt">str</span>(j) + <span class="st">&quot;=&quot;</span> + <span class="dt">str</span>(i*j) +<span class="st">&quot;&lt;/td&gt;&quot;</span>+<span class="st">&quot;&lt;/tr&gt;&quot;</span> + <span class="st">&quot;&lt;br /&gt;&quot;</span>
                <span class="kw">else</span>:
                    outstring += <span class="st">&quot;&lt;td&gt;&quot;</span>+<span class="dt">str</span>(i) + <span class="st">&quot;x&quot;</span> + <span class="dt">str</span>(j) + <span class="st">&quot;=&quot;</span> + <span class="dt">str</span>(i*j) + <span class="st">&quot;&lt;/td&gt;&quot;</span>
        <span class="kw">return</span> <span class="st">&quot;&lt;table border=2&gt;&lt;tr&gt;&lt;td&gt;99乘法表&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&quot;</span>+outstring
<span class="co">#http://127.0.0.1:8080/index?var1=10&amp;var2=20</span>
<span class="co">#&quot;&amp;nbsp;&quot;*4</span>
 
 
cherrypy.quickstart(HelloWorld())
<span class="co">#application=cherrypy.Application(HelloWorld()) #將符號打開上傳openshift即可使用，並刪掉上列</span></code></pre>
<p>以上程式碼即可跑出99乘法表.</p>
<p>9x9openshift: http://9x9-cadp13ag8.rhcloud.com/ (因openshift空間不足，故利用第九週程式，程式碼略有差別，主要為多新增兩個輸入表單，其餘相同)</p>
<p>同步bitbucket: https://bitbucket.org/40123153/input9x9 (同上)</p>
<p>————我是分隔線————</p>
<p>影片(由於網路超慢，怕錄製影片過大所以只錄製最後結果)</p>
<p>https://vimeo.com/92003966</p>
<p>P.S 由於題目理解錯誤，所以上述影片為失效。</p>
<h1 id="第九週考試摘要2ag10">第九週考試摘要(2ag10)</h1>
<p>小組網站:http://goo.gl/8nPx2Y</p>
2014S CD Week9
<td>
<p>課程教材:</p>
A collaborative writing approach to wikis
<td>
Collabrative engine for distributed mechanical design
<td>
Web-based collaborative engineering support system
<td>
期中考試題目
<td>
<p>下列題目完成後, 必須(1)將程式碼送到個人的 Bitbucket repository 下(2)程式可在近端與雲端部署執行(3)在 wiki.mde.tw 個人第九週心得中留下 Bitbucket 與雲端執行連結以及其它參考連結(4)整理出一份期中考第一(二, 或三)題的 PDF 檔案, 寄到 course@mde.tw, 標題為: cda_學號_姓名_期中考第一(二, 或三)題(乙班將 cda 改為 cdb), 內容必須包含程式碼, 解題過程, 解題心得, Bitbucket 連結, 雲端網址等資料.</p>
(第一題 30%) 請寫一個執行時可以列出以十為底對數表的網際 Python 程式, 然後 Push 到個人 bitbucket 空間, 而且同步指到 OpenShift 個人帳號上執行.
<td>
(第二題 40%) 請在個人的 OpenShift 平台上建立一個能夠列印出與九九乘法表結果完全相同的網際程式, 接著在乘法表上端加上兩個輸入表單, 讓使用者輸入兩個整數, 按下送出鍵後, 程式會列出以此兩個整數為基底的乘法表, 例如: 若兩個欄位都輸入: 9, 則列出九九乘法表, 若輸入 9, 20, 則列出 9×20 的乘法表.
<td>
(第三題 30%) 請在各組的雲端 dokuwiki 中, 新增帳號與密碼都是由 abc001 ~ abc399 字串所組成的 399 名用戶登入對應資料, 並將製作過程與驗證流程拍成 flv 後上傳到個人的 Vimeo 資料區, 並將連結放在個人第九週頁面.
<td>
<p>第一題參考資料: 對數表與應用, 當 x=10, 對應到 0 行的值, 表示要對 1.00 取以十為底的對數, 所得到的值為 math.log(1.00, 10)=0, 而 x=10 對應到 1 行的值, 表示要對 1.01 取以十為底的對數, 所得到的值為 math.log(1.01, 10)=0.004321373782642578 然後再乘上 10000, 並且只取整數, 所以對應表的值為 43, 也就是表中的 0043, 當 x=20, 而且對應到第 9 行的值, 則為 math.log(2.09, 10)=0.32014628611105395, 然後再乘上 10000, 只取整數, 所以對應表上的值為 3201.</p>
<p>第一題參考: Python 中 str() 可以將整數或浮點數轉為字串, int() 則可以將字串轉為整數, round(1.0123, 2) 表示只取小數點後兩位, math.log(x, 10) 表示對 x 取以 10 為底的 log 值, html 表格請參考.</p>
期中成績評量
<td>
請各組依據2014s_week7中的說明完成期中報告.(最後繳交期限為 2014.4.26 晚上 12:00)
<td>
成績評量時, 將依據各組在 wiki.mde.tw 中的頁面進行評量, 期中成績包括平時成績(參考個人自評成績)、第八週考試與期中考試成績、期中報告成績等.
<td>
<p>上課影片 http://vimeo.com/user24079973/videos</p>
<h1 id="第九週報告2ag10">第九週報告(2ag10)</h1>
<p>小組網站:http://goo.gl/Hy7Ktn</p>
<p>第一題:</p>
<p>Log以10為底之表單openshift: http://log-cadp13ag8.rhcloud.com/</p>
<p>bitbucket: https://bitbucket.org/40123153/log10-1.00-1.99</p>
<p>因為迴圈關係，多了一個21…還在更新中。(解決)</p>
<p>P.S已利用elif判斷式將最後的21給剃除！</p>
當在最後20的地方下elif將
<tr>
<p>給剃除，故不在往下做表格及列印出21數字。</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="ch">import</span> cherrypy
<span class="ch">import</span> os
<span class="ch">import</span> math
<span class="co"># 1. 導入所需模組</span>

<span class="co"># 2. 設定近端與遠端目錄</span>
<span class="co"># 確定程式檔案所在目錄, 在 Windows 有最後的反斜線</span>
_curdir = os.path.join(os.getcwd(), os.path.dirname(<span class="ot">__file__</span>))
<span class="co"># 設定在雲端與近端的資料儲存目錄</span>
<span class="kw">if</span> <span class="st">&#39;OPENSHIFT_REPO_DIR&#39;</span> in os.environ.keys():
    <span class="co"># 表示程式在雲端執行</span>
    download_root_dir = os.environ[<span class="st">&#39;OPENSHIFT_DATA_DIR&#39;</span>]
    data_dir = os.environ[<span class="st">&#39;OPENSHIFT_DATA_DIR&#39;</span>]
<span class="kw">else</span>:
    <span class="co"># 表示程式在近端執行</span>
    download_root_dir = _curdir + <span class="st">&quot;/local_data/&quot;</span>
    data_dir = _curdir + <span class="st">&quot;/local_data/&quot;</span>
 
<span class="co"># 3. 建立主物件</span>
<span class="kw">class</span> HelloWorld(<span class="dt">object</span>):
    <span class="ot">@cherrypy.expose</span>
    <span class="kw">def</span> index2(<span class="ot">self</span>, input1=<span class="ot">None</span>, input2=<span class="ot">None</span>):
        <span class="kw">return</span> <span class="st">&quot;Hello world!&quot;</span>+<span class="dt">str</span>(input1)
    <span class="ot">@cherrypy.expose</span>
    <span class="kw">def</span> inputform(<span class="ot">self</span>, input1=<span class="ot">None</span>, input2=<span class="ot">None</span>):
        <span class="kw">return</span> <span class="st">&quot;input form&quot;</span>+<span class="dt">str</span>(input1)
    <span class="co">#index.exposed = True</span>
    <span class="ot">@cherrypy.expose</span>
    <span class="kw">def</span> index(<span class="ot">self</span>):
        out=<span class="st">&quot;&quot;</span>
        c = <span class="dv">0</span>
        k = <span class="dv">0</span>
        <span class="kw">for</span> i in <span class="dt">range</span>(<span class="dv">0</span>,<span class="dv">11</span>):
            <span class="kw">for</span> j in <span class="dt">range</span> (<span class="dv">0</span>,<span class="dv">10</span>):
                k += <span class="dv">1</span>
                c = <span class="dv">10</span> + i
                d = c/<span class="dv">10</span>+j/<span class="dv">100</span>
                e = (<span class="dt">int</span>(math.log(d,<span class="dv">10</span>)*<span class="dv">10000</span>))
                <span class="kw">if</span> (k%<span class="dv">10</span> == <span class="dv">0</span> and k&lt;=<span class="dv">100</span>):
                    out += <span class="st">&quot;&lt;td&gt;&quot;</span>+<span class="dt">str</span>(e)+<span class="st">&quot;&lt;/td&gt;&lt;/tr&gt;&lt;td&gt;&quot;</span>+<span class="dt">str</span>(c<span class="dv">+1</span>)+<span class="st">&quot;&lt;/td&gt;&lt;br /&gt;&quot;</span>
                <span class="kw">elif</span> k%<span class="dv">100</span> == <span class="dv">0</span>:
                    out += <span class="st">&quot;&lt;td&gt;&quot;</span>+<span class="dt">str</span>(e)+<span class="st">&quot;&lt;/td&gt;&lt;br /&gt;&quot;</span>
                <span class="kw">else</span>:
                    out +=<span class="st">&quot;&lt;td&gt;&quot;</span>+<span class="dt">str</span>(e) + <span class="st">&quot;&lt;/td&gt;&quot;</span>
                <span class="co">#print(&quot;log=&quot;,int(math.log(d,10)*10000))</span>
            <span class="co">#print(&quot;\n&quot;)</span>
        <span class="kw">return</span> <span class="st">&quot;&lt;table border=1&gt;&lt;tr&gt;&lt;td&gt;x&lt;/td&gt;&lt;td&gt;0&lt;/td&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;2&lt;/td&gt;&lt;td&gt;3&lt;/td&gt;&lt;td&gt;4&lt;/td&gt;&lt;td&gt;5&lt;/td&gt;&lt;td&gt;6&lt;/td&gt;&lt;td&gt;7&lt;/td&gt;&lt;td&gt;8&lt;/td&gt;&lt;td&gt;9&lt;/td&gt;&lt;/tr&gt;&lt;td&gt;&quot;</span>+<span class="st">&quot;10&quot;</span>+<span class="st">&quot;&lt;/td&gt;&quot;</span>+out
 
<span class="co"># 4. 安排啟動設定</span>
<span class="co"># 配合程式檔案所在目錄設定靜態目錄或靜態檔案</span>
application_conf = {<span class="st">&#39;/static&#39;</span>:{
        <span class="st">&#39;tools.staticdir.on&#39;</span>: <span class="ot">True</span>,
        <span class="co">&#39;tools.staticdir.dir&#39;</span>: _curdir+<span class="st">&quot;/static&quot;</span>},
        <span class="co">&#39;/downloads&#39;</span>:{
        <span class="st">&#39;tools.staticdir.on&#39;</span>: <span class="ot">True</span>,
        <span class="co">&#39;tools.staticdir.dir&#39;</span>: data_dir+<span class="st">&quot;/downloads&quot;</span>}
    }
 
<span class="co"># 5. 在近端或遠端啟動程式</span>
<span class="co"># 利用 HelloWorld() class 產生案例物件</span>
root = HelloWorld()
<span class="co"># 假如在 os 環境變數中存在 &#39;OPENSHIFT_REPO_DIR&#39;, 表示程式在 OpenShift 環境中執行</span>
<span class="kw">if</span> <span class="st">&#39;OPENSHIFT_REPO_DIR&#39;</span> in os.environ.keys():
    <span class="co"># 雲端執行啟動</span>
    application = cherrypy.Application(root, config = application_conf)
<span class="kw">else</span>:
    <span class="co"># 近端執行啟動</span>
    <span class="co">&#39;&#39;&#39;</span>
<span class="co">    cherrypy.server.socket_port = 8083</span>
<span class="co">    cherrypy.server.socket_host = &#39;127.0.0.1&#39;</span>
<span class="co">    &#39;&#39;&#39;</span>
    cherrypy.quickstart(root, config = application_conf)</code></pre>
<p>————我是分隔線————</p>
<p>第二題:</p>
<p>9×9乘法表，並且有兩input可以改變9×9乘法表的範圍。例：input:9 and 20 則為9×20乘法表。</p>
<p>openshift: http://9x9-cadp13ag8.rhcloud.com/ (備註:i為前值，j為後值)</p>
<p>bitbucket: https://bitbucket.org/40123153/input9x9</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="ch">import</span> cherrypy
<span class="kw">class</span> HelloWorld(<span class="dt">object</span>):
    <span class="ot">@cherrypy.expose</span>
    <span class="kw">def</span> index(<span class="ot">self</span>, var1=<span class="dv">9</span>, var2=<span class="dv">9</span>):
        <span class="co"># initialize outstring</span>
        outstring = <span class="st">&quot;&quot;</span>
        <span class="co"># initialize count</span>
        count = <span class="dv">0</span>
        d = <span class="dt">int</span>(var1)+<span class="dv">1</span>
        e = <span class="dt">int</span>(var2)+<span class="dv">1</span>
        <span class="kw">for</span> i in <span class="dt">range</span>(<span class="dv">1</span>, d):
            <span class="kw">for</span> j in <span class="dt">range</span>(<span class="dv">1</span>, e):
                count += <span class="dv">1</span>
                <span class="kw">if</span> count%<span class="dt">int</span>(var2) == <span class="dv">0</span>:
                    outstring += <span class="st">&quot;&lt;td&gt;&quot;</span>+<span class="dt">str</span>(i) + <span class="st">&quot;*&quot;</span> + <span class="dt">str</span>(j) + <span class="st">&quot;=&quot;</span> + <span class="dt">str</span>(i*j) +<span class="st">&quot;&lt;/td&gt;&quot;</span>+<span class="st">&quot;&lt;/tr&gt;&quot;</span> + <span class="st">&quot;&lt;br /&gt;&quot;</span>
                <span class="kw">else</span>:
                    outstring += <span class="st">&quot;&lt;td&gt;&quot;</span>+<span class="dt">str</span>(i) + <span class="st">&quot;x&quot;</span> + <span class="dt">str</span>(j) + <span class="st">&quot;=&quot;</span> + <span class="dt">str</span>(i*j) + <span class="st">&quot;&lt;/td&gt;&quot;</span>
        <span class="kw">return</span> <span class="st">&quot;&lt;table border=3&gt;&lt;tr&gt;&lt;td&gt;99乘法表&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&quot;</span>+outstring+<span class="st">&#39;&#39;&#39;&lt;br/&gt;&lt;form method=&quot;POST&quot; action=&quot;index&quot;&gt;</span>
<span class="st">                i 我是前值:&lt;input type=&quot;text&quot; name=&quot;var1&quot;&gt;&lt;br /&gt;</span>
<span class="st">                j 我是後值:&lt;input type=&quot;text&quot; name=&quot;var2&quot;&gt;&lt;br /&gt;</span>
<span class="st">                &lt;input type=&quot;submit&quot; value=&quot;send&quot;&gt;</span>
<span class="st">                &lt;/form&gt;</span>
<span class="st">                &#39;&#39;&#39;</span>
<span class="co">#http://127.0.0.1:8080/index?var1=10&amp;var2=20</span>
 
 
<span class="co">#cherrypy.quickstart(HelloWorld())</span>
application=cherrypy.Application(HelloWorld())</code></pre>
<p>————我是分隔線————</p>
<p>第三題:</p>
<p>新增帳號與密碼都是由 abc001 ~ abc399 字串所組成的 399。</p>
<p>影片解說: https://vimeo.com/92574166</p>
<p>首先，我們必須要先有abc001~abc399的帳號密碼值，故先用程式迴圈跑出。 (因為懶得寫輸出檔，或者是不熟悉所以不冒險去寫。）</p>
<p>將值複製至文件內將空白修掉，利用EXCEL把密碼在複製至B欄位。存成CSV檔</p>
<p>同樣利用文件將逗點修掉(如果沒記錯空白處為一個TAB，為了安全還是複製之前的。)</p>
<p>再利用程式，修改讀取的文件，將密碼處改為數列<a href="數列第一資料行位為[0]，第二資料故為[1]">1</a></p>
<p>跑出user之後利用FZ將檔案覆蓋，則可以在雲端上登錄。(為了確認完全傳入，將abc001改為管理權限，確認帳號輸入)</p>
<p>dokuwiki_openshift: http://dokuwiki-cadp13ag8.rhcloud.com/doku.php</p>
<p>bitbucket: https://bitbucket.org/40123153/dokuwiki_abc</p>
<p>第三題的程式碼實在不知道要打什麼….</p>
<h1 id="第十二週報告2ag10">第十二週報告(2ag10)</h1>
<p>小組網站:http://goo.gl/28PW52</p>
<p>第十二週任務</p>
<p>請各組將第八週與第九週考試的摘要報告放入 Github 協同專案中的分組報告區, 並將內容放入各組控管的同步 OpenShift 網站中. (佔期末成績 5分)</p>
<p>github小組倉儲:https://github.com/2014cdag10</p>
<p>github大分組倉儲:https://github.com/coursemdetw/2014cda</p>
請各組設法利用 CherryPy 與 Pro/Web.Link 技術, 在 Github 協同專案中建立一個能夠透過連結或表單控制 Cube 零件, a, b, 或 c 零件尺寸的網際協同程式, 讓使用者可以藉以利用近端的 Creo 嵌入式瀏覽器控制 Cube 的尺寸後列出該零件的體積大小. (佔期末成績 5分)
<td>
<ol style="list-style-type: decimal">
<li>Creo 必須使用 64 位元版本 (配合 Windows 7 操作系統)
<td></li>
<li>Creo web_enable_javascript 設為 on, regen_failure_handling 設為 resolve_mode
<td></li>
<li>IE→工具→網際網路選項→安全性→信任的網站→自訂等級 允許信任網站執行 ActiveX
<td></li>
<li>cda 專案必須將http://cdag10-40123153.rhcloud.com/設為信任網站
<td></li>
<li>開啟 Creo 2.0, 建立一個 cube, relations: d0 = a, d1 = b, d2 = c (a, b, c 為 local parameters)
<td></li>
<li>然後在嵌入式 IE, 連接到 http://cdag10-40123153.rhcloud.com/cdag10/cube10 (#在parameter中將函式名稱改為cube10)
<td></li>
<li>執行 http://cdag10-40123153.rhcloud.com/cdag10/fourbar10 (#在parameter中將函式名稱改為fourbar10) 之前則需要先下載四連桿零件放在 V:目錄中, 並開啟一個空的組立檔案, 執行時 Pro/Web.Link 程式會自動進行連桿組立.
<td></li>
<li>Pro/Web.Link 應用: http://www.ptc.com/company/news/inprint/taiwan/proe5.htm
<td></li>
<li>參考資料: http://inversionconsulting.blogspot.tw/search/label/WebLink</li>
</ol>
<p>首先必須將creo 2.0 的 config.pro檔做些設定，必須要將regen_failure_handing設為resolv_mode，使他能重繪。</p>
<p>再來必須將web_enable_javascript設為on，這樣才能讓javascript可以動作。</p>
<p>＃很重要！！這將會成為成功與失敗的原因....</p>
<p>並且將IE關於ActiveX都通通啟用，將http://cdag10-40123153.rhcloud.com/設為例外網頁。</p>
<p>再來就是繪圖，將零件的三個尺寸設關係式，d0=a , d1=b , d2=c。</p>
<p>所有前置動作都完成了，再來就是利用creo裡面內建的IE跑囉！</p>
<p>將http://cdag10-40123153.rhcloud.com/cdag10/cube10貼至IE的url中，就會開始跑囉！</p>
<p>(原始尺寸為150x150x150的方塊)</p>
<p>第一次:3375000</p>
<p>第二次:4096000</p>
<p>第三次:4913000</p>
<p>第四次:5832000</p>
<p>第五次:6859000</p>
<p>大致上就這樣吧...不過 c變數 忘記動到...不過只是照a與b同樣的型式...將a或b複製下來改成c就可以三軸同動了。</p>
<h1 id="第十二週評分">第十二週評分</h1>
<p>40123116 : 10分</p>
<p>40123118 : 10分</p>
<p>40123153 : 10分</p>
<h1 id="第十三週考試">第十三週考試</h1>
<p>小組網站:http://goo.gl/til1Nq</p>
<p>https://vimeo.com/95823422 copy.com: https://copy.com/P9fGFaLSlQqx</p>
<p>https://vimeo.com/95823554 copy.com: https://copy.com/1pnPvVduOJ9B</p>
<p>任務一: 請以手動方式, 從下方下載 lego_man.7z 零件, 完成組立後, 以組員為單位, 在各分組報告區詳細說明組立過程的重點與注意事項. (5 分)</p>
<p>任務二: 請利用 Vimeo 及 copy.com 存放任務一中的手動組立流程影片檔案, 以組員為單位, 將連結放入各分組報告區中. (5 分)</p>
<p>任務三: 請仔細觀察協同程式中的 lego_man 自動組立程式, 並且從下方 lego_parts_edu.7z 中下載相同名稱的 lego_man 零件, 請詳細比較兩個壓縮檔案解開的 lego_man 零件檔案, 有哪些差別? 請將詳細比對結果以組為單位將資料放入各分組的報告中. (5 分)</p>
<p>主要任務: 了解各組員對於課程內容的了解 (採每一組員分別完成任務進行測試)</p>
<p>協同環境與架構</p>
<p>實際操作</p>
<p>Creo 零件手動組立</p>
<p>Creo 零件參數手動設定</p>
<p>Creo 零件參數網際變更</p>
<p>Creo 零件自動組立</p>
<p>lego_man.7z</p>
<p>lego_parts_edu.7z</p>
<p>weblink user guide.pdf</p>
<h1 id="第十三週報告">第十三週報告</h1>
<p>小組網站:http://goo.gl/QFJp5F</p>
<p>因為只有說利用creo，但並沒限定使用Parametric或Direct. 所以利用Direct必較人性化...所以用Direct組立(主要是沒有順序問題!)</p>
<p>首先載入身體，放置在任意座標.</p>
<p>在載入左、右手臂，利用同心圓及重合將其組上.(注意面的位子，將要組的面先轉至要組上的面的方向)</p>
<p>之後將手載入兩根，利用同心圓及重合組在手臂前端.</p>
<p>將下盤組在身體上，利用三個平面的重合即可.</p>
<p>完成後將左、右腳利用同心圓及重合組在下盤兩端.(注意面的位子，將要組的面先轉至要組上的面的方向)</p>
<p>載入頭部，同樣利用同心圓及重合組在身體上(注意孔大小)</p>
<p>載入帽子，利用三個重合即可(第一個是曲面的重合，中間平面的重合、下平面的重合)</p>
<p>小組vedio: https://vimeo.com/95822338</p>
<p>小組copy.com: http://goo.gl/K1nh1G</p>
<p>　lego_man 自動組立程式組出來的Feat ID是順序的40 41 42 ...一個一個零件載入裝配. 　而lego_parts_edu.7z 中下載相同名稱的 lego_man 零件卻不是這樣順序的... 　這代表他並不是一次就組起來，可能途中有改變、刪除什麼的.</p>
<p>自動組立的某些限制條件或許沒訂得很好，動作有點好笑！</p>
<h1 id="第十三週評分">第十三週評分</h1>
<p>40123116 : 15分</p>
<p>40123118 : 15分</p>
<p>40123153 : 15分</p>
<h1 id="網際鼓式煞車設計2ag11">網際鼓式煞車設計(2ag11)</h1>
<p>有關鼓式煞車</p>
<h1 id="程式設計架構-6">程式設計架構</h1>
<p>鼓式煞車</p>
<h1 id="結果與討論-6">結果與討論</h1>
<p>這裡是結果與討論</p>
<h1 id="網際鼓式煞車設計2ag12">網際鼓式煞車設計(2ag12)</h1>
<p>有關鼓式煞車</p>
<h1 id="程式設計架構-7">程式設計架構</h1>
<p>鼓式煞車</p>
<h1 id="結果與討論-7">結果與討論</h1>
<p>這裡是結果與討論</p>
<h1 id="協同產品設計實習專案2ag13">協同產品設計實習專案(2ag13)</h1>
<h2 id="組員-1">組員：</h2>
<p>40123155</p>
<p>40123124</p>
<p>40123138</p>
<p>OpenShift 網站: https://python-40123124.rhcloud.com/get_page?heading=%3Cspan%3E%E6%9C%9F%E4%B8%AD%E8%80%83%3C/span%3E</p>
<p>請各組將第八週與第九週考試的摘要報告放入 Github 協同專案中的分組報告區, 並將內容放入各組控管的同步 OpenShift 網站中. (佔期末成績 5分)</p>
<p>考試摘要 http://dokuwiki-40123155.rhcloud.com/doku.php</p>
<ul>
<li><p>bitbucket網站: https://40123155@bitbucket.org/40123155/---.git</p></li>
<li><p>dokuwiki網站: http://dokuwiki-40123155.rhcloud.com</p></li>
<li><p>vimeo網站: https://vimeo.com/user26959367</p></li>
<li><p>CMSimply 網站: https://python-40123124.rhcloud.com</p></li>
<li><p>下載網站: https://copy.com/SjKQ8LHZpVFq</p></li>
<li><p>HTML網站: http://dokuwiki-40123155.rhcloud.com/lib/exe/fetch.php?media=%E6%9C%9F%E4%B8%AD%E5%A0%B1%E5%91%8A.pdf</p></li>
</ul>
<p>http://dokuwiki-40123155.rhcloud.com/lib/exe/fetch.php?media=%E8%AA%B2%E7%A8%8B%E6%95%99%E6%9D%90%E4%B8%80%E7%BF%BB%E8%AD%AF_.pdf</p>
<p>http://dokuwiki-40123155.rhcloud.com/lib/exe/fetch.php?media=%E8%AA%B2%E7%A8%8B%E6%95%99%E6%9D%90%E4%BA%8C%E7%BF%BB%E8%AD%AF.pdf</p>
<p>組員自評:</p>
<pre><code>40123155：80分

40123124：70分

40123138：75分</code></pre>
<p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD 網際鼓式煞車設計(2ag14) ======= 網際鼓式煞車設計(2ag10) &gt;&gt;&gt;&gt;&gt;&gt;&gt; 26a5b9324111e15820203a5b96463a4196def80e ===</p>
<p>有關鼓式煞車</p>
<h1 id="程式設計架構-8">程式設計架構</h1>
<p>鼓式煞車</p>
<h1 id="結果與討論-8">結果與討論</h1>
<p>這裡是結果與討論</p>
<h1 id="網際鼓式煞車設計2ag15">網際鼓式煞車設計(2ag15)</h1>
<p>有關鼓式煞車</p>
<h1 id="程式設計架構-9">程式設計架構</h1>
<p>鼓式煞車</p>
<h1 id="結果與討論-9">結果與討論</h1>
<p>這裡是結果與討論</p>
<h1 id="網際鼓式煞車設計2ag16">網際鼓式煞車設計(2ag16)</h1>
<p>有關鼓式煞車</p>
<h1 id="程式設計架構-10">程式設計架構</h1>
<p>鼓式煞車</p>
<h1 id="結果與討論-10">結果與討論</h1>
<p>這裡是結果與討論</p>
<h1 id="第八週摘要報告">第八週摘要報告</h1>
<p>以協同方式寫Wiki</p>
<p>本文目的在於讓學生利用開發的wiki與應用快速原型的協作式寫作的開發方法。而本文也由定性數據收集和分析方法的來評價。 最後，對於協作方式來寫作的方式，其影響極其討論協議到組別與軟件開發方面的考慮和教學相關的要求問題 研究方法 wiki的協作式寫作，基於設計的研究包括以下四個步驟： 1. 研究的現狀與認識目的並審查與wiki的協作式寫作相關的問題。 2. wiki將用於促進以協同方式寫作來設計，參與和群體互動。 3. 使用多種方法收集其經驗數據。 4. 通過系統的評價分析，並通過各種方法收集資料。分析，設計，實施和評價是相互共存的。而缺點提出於每個週期提出，重新設計，重新實現，並重新評估。 維基應用域教育在協同方式寫作方法而成的Wiki是適用於多種情況，期望得到的wiki應用在學習投資效益與協同方式來寫作。它十分靈活的，足以適應的專業條件。更具體地，它的應用領域包括不同級別的更高教育，從研究生到社會教育。除了協同寫作與學科相關，維基可以為一些應用程序的開發系統來使用，如產生教材，網路上互相評論，並收集數據於一種項目。</p>
<p>結論和未來研究方向 1. 這項結果不能限制於狹小的研究的範圍，即使調查結果反映了那些報導中的一致性研究文獻。 2. 用來判斷以不同方式來呈現協同，尤其是同組評議，這擁有極高的教育價值與分析性思維，並參與交流。可以促進團體間的合作和時間，wiki打開了協同寫作上新的視野，而小組互動絕不是容易的事情，解決了技術，教學和文化各種問題。 未來的工作將更顯的協同的重要性，wiki以此設計為基礎下更加精進。重要的是，它更進一步影響高等教育對於wiki的使用。最後，它也進一步實踐於系統評論的基礎</p>
<h1 id="第九週摘要報告">第九週摘要報告</h1>
<p>題目一 :請寫一個執行時可以列出以十為底對數表的網際 Python 程式, 然後 Push 到個人 bitbucket 空間, 而且同步指到 OpenShift 個人帳號上執行.</p>
<p>資料 : https://bitbucket.org/40123158/test</p>
<p>題目三 : 請在個人的 OpenShift 平台上建立一個能夠列印出與九九乘法表結果完全相同的網際程式, 接著在乘法表上端加上兩個輸入表單, 讓使用者輸入兩個整數, 按下送出鍵後, 程式會列出以此兩個整數為基底的乘法表, 例如: 若兩個欄位都輸入: 9, 則列出九九乘法表, 若輸入 9, 20, 則列出 9×20 的乘法表.</p>
<p>資料 : 第17組dokuwiki , 新增 abc001 ~ abc399 用戶資料 http://wikig17-weis.rhcloud.com/doku.php?id=start</p>
<p>上傳影片- 個人Vimeo https://vimeo.com/92577964</p>
<p>Bitbucket 連結 https://bitbucket.org/40123137/week9 Bitbucket 連結 https://bitbucket.org/40123137/week9</p>
<h1 id="網際鼓式煞車設計2ag18">網際鼓式煞車設計(2ag18)</h1>
<p>有關鼓式煞車g18</p>
<h1 id="程式設計架構-11">程式設計架構</h1>
<p>鼓式煞車</p>
<h1 id="結果與討論-11">結果與討論</h1>
<p>這裡是結果與討論</p>
<h1 id="網際鼓式煞車設計2ag21">網際鼓式煞車設計(2ag21)</h1>
<p>有關鼓式煞車</p>
<h1 id="程式設計架構-12">程式設計架構</h1>
<p>鼓式煞車</p>
<h1 id="結果與討論-12">結果與討論</h1>
<p>這裡是結果與討論00123</p>
<h1 id="網際-openjscad-程式設計coursemdetw">網際 OpenJSCAD 程式設計(coursemdetw)</h1>
<p>將 Spur 改為凸輪零件成型</p>
<h1 id="設計程式架構">設計程式架構</h1>
<p>定義凸輪設計公式</p>
<h1 id="結果與討論-13">結果與討論</h1>
<p>有關凸倫程式設計的結果與討論</p>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>這是註解的用法.<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Inlines notes are easier to write, since you don't have to pick an identifier and move down to type the note.<a href="#fnref2">↩</a></p></li>
</ol>
</div>
</body>
</html>
